{"version":3,"sources":["lib/RelationEngineAPIClient.ts","types/index.ts","types/taxonomy.ts","types/ontology.ts","redux/actions.ts","redux/reducers.ts","redux/store/index.ts","lib/DB.ts","landingPages/taxonomy/lib/TaxonAPIClient.ts","landingPages/taxonomy/lib/model.ts","landingPages/taxonomy/main/TaxonDB.ts","landingPages/taxonomy/SourceInfo.tsx","landingPages/taxonomy/TaxonItem.tsx","landingPages/taxonomy/taxonChildren/TaxonChildrenDB.ts","landingPages/taxonomy/TaxonList.tsx","components/ErrorView.tsx","landingPages/taxonomy/taxonChildren/TaxonChildren.tsx","landingPages/taxonomy/taxonChildren/data.tsx","landingPages/taxonomy/taxonChildren/index.ts","landingPages/taxonomy/lineage/LineageDB.ts","landingPages/taxonomy/lineage/Lineage.tsx","landingPages/taxonomy/lineage/data.tsx","landingPages/taxonomy/lineage/index.ts","landingPages/taxonomy/LineageNavigator.tsx","landingPages/taxonomy/TaxonSummary.tsx","landingPages/taxonomy/taxonInfo/TaxonDetailNCBI.tsx","landingPages/taxonomy/taxonInfo/TaxonDetail.tsx","landingPages/taxonomy/lib/props.ts","components/Wikipedia.tsx","landingPages/taxonomy/lib/Wikipedia.ts","components/Loading.tsx","lib/DB2.ts","landingPages/taxonomy/taxonInfo/TaxonDescription.tsx","landingPages/taxonomy/taxonInfo/linkedData/LinkedDataDB.ts","landingPages/taxonomy/taxonInfo/linkedData/view.tsx","landingPages/taxonomy/taxonInfo/linkedData/data.tsx","landingPages/taxonomy/taxonInfo/linkedData/index.ts","landingPages/taxonomy/taxonInfo/TaxonInfo.tsx","landingPages/taxonomy/main/Taxonomy.tsx","landingPages/taxonomy/main/data.tsx","landingPages/taxonomy/main/index.ts","landingPages/taxonomy/index.ts","landingPages/ontology/lib/OntologyAPIClient.ts","landingPages/ontology/lib/model.ts","landingPages/ontology/Main/OntologyDB.ts","landingPages/ontology/OntologyTerm.tsx","landingPages/ontology/Children/ChildrenDB.ts","landingPages/ontology/Children/view.tsx","landingPages/ontology/Children/data.tsx","landingPages/ontology/Children/index.ts","landingPages/ontology/Parents/ParentsDB.ts","landingPages/ontology/Parents/view.tsx","landingPages/ontology/Parents/data.tsx","landingPages/ontology/Parents/index.ts","landingPages/ontology/Nav/index.tsx","landingPages/ontology/TermLink.tsx","landingPages/ontology/Detail/LinkedObjects/LinkedObjectsDB.ts","landingPages/ontology/Detail/LinkedObjects/view.tsx","landingPages/ontology/Detail/LinkedObjects/data.tsx","landingPages/ontology/Detail/LinkedObjects/index.ts","landingPages/ontology/Detail/index.tsx","landingPages/ontology/Main/SourceInfo.tsx","landingPages/ontology/Main/TermSummary.tsx","landingPages/ontology/Main/view.tsx","landingPages/ontology/Main/data.tsx","landingPages/ontology/Main/index.ts","landingPages/ontology/index.ts","components/dispatcher/Dispatcher.tsx","components/dispatcher/index.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["RelationEngineAPIClient","relationEngineID","classRe","taxonomyRe","ontologyRe","Promise","resolve","reject","m","exec","collection","rest","length","Error","timestamp","namespace","id","timestampString","parseInt","Date","now","created","expired","getTime","DynamicServiceClient","module","ObjectClass","LoadingStatus","RelationEngineCollection","TaxonomyNamespace","OntologyNamespace","OntologySource","OntologyRelation","GOSynonymScope","AppActions","relationEngineCollectionToString","TAXONOMY","ONTOLOGY","taxonomyNamespaceToString","NCBI","GTDB","stringToTaxonomyNamespace","stringToOntologyNamespace","GO","ontologyNamespaceToString","navigateSuccess","navigation","type","NAVIGATE_SUCCESS","navigate","dispatch","getState","a","NAVIGATE_START","userAuthorization","auth","url","app","config","services","ServiceWizard","reClient","token","getNodeInfo","nodeInfo","ViewType","ref","console","error","message","NAVIGATE_ERROR","state","action","trigger","RelationEngineNodeType","ViewStatus","SyncViewStatus","AsyncViewStatus","reducer","baseState","baseReducer","makeInitialStoreState","makeBaseStoreState","NONE","view","DBStatus","DB","props","db","stopped","onUpdate","this","data","initialData","updateFun","forceComponentUpdate","TaxonomyAPIClient","ns","ts","params","callFunc","result","offset","limit","searchTerm","search_text","taxon_ns","taxon_id","TaxonomyModel","taxonomyClient","TaxonAPIClient","taxonRef","getLineage","taxons","results","map","taxonResult","isBiological","scientific_name","name","rank","ncbiID","NCBI_taxon_id","geneticCode","gencode","aliases","category","options","getChildren","taxa","total_count","getTaxon","taxon","getAssociatedWorkspaceObjects","linkedObjects","linkedAt","edge","updated_at","objectID","ws_obj","object_id","workspaceID","workspace_id","version","objectName","createdAt","epoch","workspaceUpdatedAt","module_name","type_name","majorVersion","maj_ver","minorVersion","min_ver","totalCount","TaxonDB","set","status","LOADING","client","LOADED","targetTaxon","selectedTaxon","ERROR","code","source","SourceInfo","className","src","style","height","alt","width","href","target","rel","React","Component","TaxonItem","hovering","selectTaxonRef","hash","String","join","window","parent","location","ev","setState","Fragment","onClick","clickNavigateToTaxon","bind","clickTaxon","isActive","renderActive","renderOver","renderNormal","classNames","push","tooltipTitle","borderBottom","title","placement","key","onMouseEnter","onMouseLeave","renderItem","TaxonChildrenDB","serviceWizardURL","page","pageSize","RELOADING","total","TaxonList","navigateToTaxonRef","index","selectedTaxonRef","selectTaxon","navigateToTaxon","description","image","PRESENTED_IMAGE_SIMPLE","renderNoItems","renderItemsPlain","ErrorView","color","renderMessage","TaxonChildren","fetchChildren","Intl","NumberFormat","useGrouping","format","currentItem","lastItem","size","renderTitleLoaded","renderTitleReLoading","term","disabled","marginBottom","Search","placeholder","onSearch","doSearch","totalItems","maxItems","tip","renderTaxaLoaded","renderTaxaNone","renderTaxaLoading","renderTaxaReLoading","renderTaxaError","showLessItems","hideOnSinglePage","defaultPageSize","current","onChange","changePage","renderPaginationNone","renderPaginationLoading","renderPaginationError","renderPaginationLoaded","renderPaginationReLoading","renderTitle","renderSearch","renderPagination","renderTaxa","renderChildren","Data","forceUpdate","get","renderError","renderSuccess","connect","DataComponent","LineageDB","lineage","Lineage","renderLoading","renderLoaded","LineageNavigator","count","selectedRef","overflowY","renderLineage","renderTargetTaxon","TaxonSummary","nameStyle","fontStyle","geneticCodesMap","geneticCodes","Array","ensureGeneticCodes","reduce","label","Map","TaxonDetailNCBI","stringSorter","b","fixedA","replace","fixedB","localeCompare","dataSource","pagination","scroll","y","rowKey","bordered","Column","dataIndex","defaultSortOrder","sorter","renderAliases","renderTaxonDetail","TaxonDetail","getProp","obj","propPath","defaultValue","split","TypeError","temp","i","undefined","AsyncComponentLoadingState","NotFound","WIKIPEDIA_API_URL","Wikipedia","proposedTerm","chars","validChar","filter","char","lookupTerm","scrubTerm","getWikipediaInfo","then","imageUrl","pageUrl","introText","pageId","matchingTerms","exactMatch","getPage","wikiResponse","all","getImage","parse","pageid","getPageInfo","pageInfo","terms","fetchPage","apiUrl","URL","query","searchParams","fetch","toString","method","headers","accept","json","pop","ex","catch","err","apiURL","Loading","DBCollectionStatus","wikipediaClient","canceled","WikipediaClient","wikipediaInfo","content","marked","overflow","dangerouslySetInnerHTML","__html","fontSize","textAlign","display","flexDirection","flex","renderMatch","alignSelf","marginLeft","renderWikipediaLogoCredit","paddingRight","marginRight","renderArticle","renderImage","findTerm","updateInfo","renderWikipediaInfo","renderNone","TaxonDescription","renderTaxonDescription","notBiological","SortDirection","AsyncTask","taskFun","hasResult","LinkedDataDB","currentTask","cancel","task","getLinkedObjects","linkedObjectsCollection","newTask","run","isCanceled","sort","LinkedData","setPage","filters","column","sortColumn","sortDirection","direction","ASCENDING","DESCENDING","stringToSortDirection","order","updateView","previousProps","isLoading","linkedObject","position","loading","onChangeTable","render","typeID","headerStyle","tooltip","DateTimeFormat","renderLinkedObjects","lastTaxonRef","fetchLinkedObjects","queryLinkedObjects","TaxonInfo","defaultActiveKey","animated","TabPane","tab","forceRender","Taxonomy","setTitle","span","navigateToTaxonREf","renderTaxonInfo","currentlyNavigatedTaxonRef","getSelectedTaxon","margin","getTargetTaxon","sendTitle","ownProps","relationEngineId","OntologyAPIClient","ids","termNodeToTerm","comments","definition","def","val","goID","isObsolete","synonyms","exact","synonym","pred","narrow","broad","related","relatedTermToTerm","relatedTerm","OntologyModel","ontologyClient","getTerms","getParents","item","OntologyDB","termRef","getTerm","targetTerm","selectedTerm","OntologyTerm","selectTerm","clickNavigateToTerm","renderTerm","clickTerm","ParentsDB","OntologyList","navigateToTermRef","selectedTermRef","navigateToTerm","currentlyNavigatedOntologyRef","getChildrenTerms","getParentTerms","Nav","log","Parents","Children","TermLink","newWindow","renderGOLink","LinkedObjectsDB","object","scientificName","feature","LinkedObjects","renderTable","Detail","s","comment","renderComments","renderSynonyms","tabs","component","renderDetail","TermSummary","OntologyView","renderLayout","setSelectedTerm","getTargetTerm","Main","Dispatcher","rootState","RootState","HOSTED","DEVELOP","renderNavigationNone","renderNavigationSome","path","addEventListener","newURL","parseHash","renderRootState","renderNavigation","renderUnauthorized","root","store","createStore","compose","applyMiddleware","thunk","App","storeUnsubscribe","last","subscribe","runtime","Object","keys","some","required","Boolean","hostname","match","ReactDOM","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.2c1c058c.chunk.js","sourcesContent":["import { RelationEngineID } from '../redux/store';\nimport { DynamicServiceClient } from '@kbase/ui-lib';\n\n// A collection is a top level division of the re data model\nexport type Collection = 'taxonomy' | 'ontology';\n\n// export type TaxonSource = 'ncbi' | 'gtdb';\n// export type OntologySource = 'go';\n\nexport interface GetNodeInfoResultBase {\n    collection: Collection;\n    // source: string;\n    created: number;\n    expired: number;\n    timestamp: number;\n}\n\nexport interface GetNodeInfoResultTaxon extends GetNodeInfoResultBase {\n    collection: 'taxonomy';\n    // source: TaxonSource;\n    namespace: string;\n    id: string;\n}\n\nexport interface GetNodeInfoResultOntology extends GetNodeInfoResultBase {\n    collection: 'ontology';\n    // source: OntologySource;\n    namespace: string;\n    id: string;\n}\n\nexport type GetNodeInfoResult = GetNodeInfoResultTaxon | GetNodeInfoResultOntology;\n\n// export interface GetNodeInfoResult<T, S> {\n//     type: NodeType;\n//     created: number;\n//     source: TaxonSource | OntologySource;\n//     version: string;\n// }\n\nexport default class RelationEngineAPIClient extends DynamicServiceClient {\n    static module: string = 'relation_engine_api';\n    async getNodeInfo(relationEngineID: RelationEngineID): Promise<[GetNodeInfoResult]> {\n        const classRe = /^(.*?)\\/(.*)$/;\n        const taxonomyRe = /^([^/]+)\\/([^/]+)(?:\\/([^/]+))?$/;\n        const ontologyRe = /^([^/]+)\\/([^/]+)(?:\\/([^/]+))?$/;\n        return new Promise<[GetNodeInfoResult]>((resolve, reject) => {\n            let m = classRe.exec(relationEngineID);\n            if (!m) {\n                reject(new Error('Invalid relation engine ID ' + relationEngineID));\n                return;\n            }\n            const [, collection, rest] = m;\n            // const [collection] = relationEngineID.split('/');\n            switch (collection) {\n                case 'taxonomy': (() => {\n                    m = taxonomyRe.exec(rest);\n                    if (!m) {\n                        reject(new Error('Taxonomy ref is '));\n                        return;\n                    }\n                    if (m.length !== 4) {\n                        reject(new Error('Invalid relation engine id \"' + relationEngineID + '\"'));\n                    }\n                    const [, namespace, id, timestampString] = m;\n                    let timestamp: number;\n                    if (!timestampString) {\n                        timestamp = Date.now();\n                    } else {\n                        timestamp = parseInt(timestampString, 10);\n                    }\n\n                    switch (namespace) {\n                        case 'ncbi_taxonomy':\n                            resolve([\n                                {\n                                    collection: 'taxonomy',\n                                    namespace: namespace,\n                                    id: id,\n                                    timestamp,\n                                    created: Date.now(),\n                                    expired: new Date(2055, 5, 5).getTime()\n                                }\n                            ]);\n                            return;\n                        default:\n                            reject(new Error('Unrecognized taxonomy namespace \"' + namespace + '\"'));\n                            return;\n                    }\n                })();\n                    break;\n                case 'ontology':\n                    m = ontologyRe.exec(rest);\n                    if (!m) {\n                        reject(new Error('Taxonomy ref is '));\n                        return;\n                    }\n                    const [, namespace, id, timestampString] = m;\n                    let timestamp: number;\n                    if (timestampString) {\n                        timestamp = parseInt(timestampString);\n                    } else {\n                        timestamp = Date.now();\n                    }\n                    switch (namespace) {\n                        case 'go':\n                            resolve([\n                                {\n                                    collection: 'ontology',\n                                    namespace,\n                                    id,\n                                    timestamp,\n                                    created: Date.now(),\n                                    expired: new Date(2055, 5, 5).getTime()\n                                }\n                            ]);\n                            return;\n                        default:\n                            reject(new Error('Ontology namespace not found \"' + namespace + '\"'));\n                            return;\n                    }\n                default:\n                    reject(new Error(`Collection ${collection} does not resolve to a type`));\n            }\n        });\n    }\n}\n","// import { OntologySource } from './ontology';\n// import { TaxonomySource } from './taxonomy';\n\ntype JSONValue = string | number | boolean | null | JSONObject | JSONArray;\n\ninterface JSONArray extends Array<JSONValue> { };\n\ninterface JSONObject {\n    [x: string]: JSONValue\n}\n\nexport interface UIError {\n    code: string;\n    source: string;\n    message: string;\n    data?: JSONValue;\n}\n\nexport class UIException extends Error {\n    code: string;\n    source: string;\n    message: string;\n    data?: JSONValue;\n    constructor({ message, code, source, data }: { message: string, code: string, source: string, data?: JSONValue }) {\n        super(message);\n        this.code = code;\n        this.source = source;\n        this.message = message;\n        this.data = data;\n    }\n}\n\n// export type NodeSource = TaxonomySource | OntologySource;\n\nexport enum ObjectClass {\n    TAXONOMY,\n    ONTOLOGY\n}\n\nexport enum LoadingStatus {\n    NONE,\n    LOADING,\n    LOADED,\n    ERROR\n}\n\nexport interface NoneState {\n    status: LoadingStatus.NONE;\n}\n\nexport interface LoadingState {\n    status: LoadingStatus.LOADING;\n}\n\nexport interface ErrorState {\n    status: LoadingStatus.ERROR;\n    message: string;\n}\n\nexport interface LoadedState {\n    status: LoadingStatus.LOADED;\n}\n\nexport enum RelationEngineCollection {\n    TAXONOMY,\n    ONTOLOGY\n}\n\nexport function relationEngineCollectionToString(collection: RelationEngineCollection): string {\n    switch (collection) {\n        case RelationEngineCollection.TAXONOMY:\n            return 'taxonomy';\n        case RelationEngineCollection.ONTOLOGY:\n            return 'ontology';\n    }\n}\n\nexport function stringToRelationEngineCollection(collection: string): RelationEngineCollection {\n    switch (collection) {\n        case 'taxonomy':\n            return RelationEngineCollection.TAXONOMY;\n        case 'ontology':\n            return RelationEngineCollection.ONTOLOGY;\n        default:\n            throw new Error('Unrecognized relation engine collection name \"' + collection + '\"');\n\n    }\n}\n\n// export enum RelationEngineNamespace {\n// }\n\nexport type RelationEngineNamespace = any;\n\nexport type RelationEngineID = string;\n\nexport type RelationEngineTimestamp = number;\n\n\nexport interface RelationEngineReference {\n    collection: RelationEngineCollection,\n    namespace: RelationEngineNamespace,\n    id: RelationEngineID;\n    timestamp: RelationEngineTimestamp;\n}","import { RelationEngineReference, RelationEngineCollection } from \".\";\n\nexport enum TaxonomyNamespace {\n    NCBI,\n    GTDB\n}\n\nexport function taxonomyNamespaceToString(namespace: TaxonomyNamespace) {\n    switch (namespace) {\n        case TaxonomyNamespace.NCBI:\n            return 'ncbi_taxonomy';\n        case TaxonomyNamespace.GTDB:\n            return 'gtdb';\n    }\n}\n\nexport function stringToTaxonomyNamespace(namespace: string) {\n    switch (namespace) {\n        case 'ncbi_taxonomy':\n            return TaxonomyNamespace.NCBI;\n        case 'gtdb':\n            return TaxonomyNamespace.GTDB;\n        default:\n            throw new Error('Unrecognized namespace \"' + namespace + '\"');\n    }\n}\n\nexport interface TaxonReferenceBase extends RelationEngineReference {\n    collection: RelationEngineCollection.TAXONOMY,\n    namespace: TaxonomyNamespace;\n}\n\nexport interface TaxonReferenceNCBI extends TaxonReferenceBase {\n    namespace: TaxonomyNamespace.NCBI;\n}\n\nexport interface TaxonReferenceGTDB extends TaxonReferenceBase {\n    namespace: TaxonomyNamespace.GTDB;\n}\n\nexport type TaxonReference = TaxonReferenceNCBI | TaxonReferenceGTDB;\n\n\nexport interface TaxonAlias {\n    category: string;\n    name: string;\n}\n\nexport interface TaxonBase {\n    ref: TaxonReference,\n    name: string;\n    rank: string;\n    isBiological: boolean;\n}\n\n\nexport interface NCBITaxon extends TaxonBase {\n    ref: TaxonReferenceNCBI;\n    ncbiID: number;\n    geneticCode: number;\n    aliases: Array<TaxonAlias>;\n}\n\nexport interface GTDBTaxon extends TaxonBase {\n    ref: TaxonReferenceGTDB;\n}\n\nexport type Taxon = NCBITaxon | GTDBTaxon;\n\n\n","import { RelationEngineReference, RelationEngineCollection } from \".\";\n\n// Ontology Term Reference\n\nexport enum OntologyNamespace {\n    GO\n}\n\nexport function stringToOntologyNamespace(namespace: string): OntologyNamespace {\n    switch (namespace) {\n        case 'go':\n            return OntologyNamespace.GO;\n        default:\n            throw new Error('Ontology namespace not supported: ' + namespace);\n    }\n}\n\nexport function ontologyNamespaceToString(namespace: OntologyNamespace): string {\n    switch (namespace) {\n        case OntologyNamespace.GO:\n            return 'go';\n    }\n}\n\n\nexport interface OntologyReferenceBase extends RelationEngineReference {\n    collection: RelationEngineCollection.ONTOLOGY,\n    namespace: OntologyNamespace;\n}\n\nexport interface OntologyReferenceGO extends OntologyReferenceBase {\n    namespace: OntologyNamespace.GO;\n}\n\nexport type OntologyReference = OntologyReferenceGO\n\n\n// export type OntologyID = string;\n\nexport enum OntologySource {\n    GO\n}\nexport enum OntologyRelation {\n    IS_A = 'OntologyRelation$is_a',\n    PART_OF = 'OntologyRelation$part_of'\n}\n\n// Brief term - for list displays\n\nexport interface OntologyTermBriefBase {\n    // type: OntologySource;\n    ref: OntologyReference;\n    // id: OntologyID;\n    name: string;\n    // relation: OntologyRelation\n}\n\nexport interface GOOntologyTermBrief extends OntologyTermBriefBase {\n    // type: OntologySource.GO\n    ref: OntologyReferenceGO\n    goID: string;\n}\n\nexport type OntologyTermBrief = GOOntologyTermBrief;\n\nexport type OntologyRelatedTermBrief = {\n    relation: OntologyRelation,\n    term: OntologyTermBrief\n}\n\nexport interface OntologyTermRelatedBrief extends OntologyTermBrief {\n    relation: OntologyRelation\n}\n\n// Term - the full term info for detail\n\nexport interface OntologyTermBase {\n    ref: OntologyReference;\n    // type: OntologySource;\n    // id: OntologyID;\n    name: string;\n    // relation: OntologyRelation;\n    comments: Array<string>\n    definition: string;\n    isObsolete: boolean;\n}\n\nexport enum GOSynonymScope {\n    EXACT,\n    NARROW,\n    BROAD,\n    RELATED\n}\n\nexport type Synonym = string;\n\n// export interface GOSynonym {\n//     name: string;\n//     scope: GOSynonymScope;\n// }\n\nexport interface GOSynonyms {\n    exact: Array<Synonym>;\n    narrow: Array<Synonym>;\n    broad: Array<Synonym>;\n    related: Array<Synonym>;\n}\n\nexport interface GOOntologyTerm extends OntologyTermBase {\n    type: OntologySource.GO;\n    synonyms: GOSynonyms;\n    goID: string;\n    namespace: string;\n}\n\nexport type OntologyTerm = GOOntologyTerm;\n\nexport interface OntologyTermRelated extends OntologyTerm {\n    related: OntologyRelation\n}\n\nexport interface OntologyRelatedTerm {\n    relation: OntologyRelation,\n    term: OntologyTerm\n}\n\nexport interface OntologyRelatedTerms {\n    term: OntologyTerm,\n    terms: Array<OntologyRelatedTerm>\n}\n\n/* Linked Objects */\n\nexport interface WorkspaceType {\n    module: string;\n    name: string;\n}\nexport type WorkspaceID = number;\nexport type ObjectID = number;\nexport type ObjectVersion = number;\nexport interface WorkspaceObjectReference {\n    workspaceID: WorkspaceID;\n    id: ObjectID;\n    version: ObjectVersion;\n}\n\nexport interface LinkedObject {\n    object: WorkspaceObjectReference;\n    type: WorkspaceType,\n    scientificName: string;\n    feature: string;\n}","import { Action } from 'redux';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { StoreState, RelationEngineID, NavigationSome, ViewType } from './store';\nimport RelationEngineAPIClient from '../lib/RelationEngineAPIClient';\nimport { RelationEngineCollection } from '../types';\nimport { stringToTaxonomyNamespace } from '../types/taxonomy';\nimport { stringToOntologyNamespace } from '../types/ontology';\n// import * as uiLib from '@kbase/ui-lib';\n\nexport enum AppActions {\n    NAVIGATE = 'kbase-ui-plugin-landing-pages/navigate',\n    NAVIGATE_START = 'kbase-ui-plugin-landing-pages/navigate/start',\n    NAVIGATE_SUCCESS = 'kbase-ui-plugin-landing-pages/navigate/success',\n    NAVIGATE_ERROR = 'kbase-ui-plugin-landing-pages/navigate/error'\n}\n\nexport interface Navigate extends Action<AppActions.NAVIGATE> {\n    type: AppActions.NAVIGATE;\n    relationEngineID: RelationEngineID;\n}\n\nexport interface NavigateStart extends Action<AppActions.NAVIGATE_START> {\n    type: AppActions.NAVIGATE_START;\n}\n\nexport interface NavigateSuccess extends Action<AppActions.NAVIGATE_SUCCESS> {\n    type: AppActions.NAVIGATE_SUCCESS;\n    navigation: NavigationSome;\n    // relationEngineID: RelationEngineID;\n    // relationEngineNodeType: RelationEngineNodeType;\n    // viewType: ViewType;\n    // view: LandingPageView;\n}\n\nexport interface NavigateError extends Action<AppActions.NAVIGATE_ERROR> {\n    type: AppActions.NAVIGATE_ERROR;\n    message: string;\n}\n\nexport function navigateStart(): NavigateStart {\n    return {\n        type: AppActions.NAVIGATE_START\n    };\n}\n\nexport function navigateError(message: string): NavigateError {\n    return {\n        type: AppActions.NAVIGATE_ERROR,\n        message\n    }\n}\n\nexport function navigateSuccess(\n    navigation: NavigationSome\n    // viewType: ViewType,\n    // relationEngineID: RelationEngineID\n    // relationEngineNodeType: RelationEngineNodeType,\n\n    // view: LandingPageView\n): NavigateSuccess {\n    return {\n        type: AppActions.NAVIGATE_SUCCESS,\n        navigation\n        // relationEngineID,\n        // relationEngineNodeType,\n        // viewType\n        // view\n    };\n}\n\nexport function navigate(relationEngineID: RelationEngineID) {\n    return async (dispatch: ThunkDispatch<StoreState, void, Action>, getState: () => StoreState) => {\n        dispatch(navigateStart());\n\n        const {\n            auth: { userAuthorization },\n            app: {\n                config: {\n                    services: {\n                        ServiceWizard: { url }\n                    }\n                }\n            }\n        } = getState();\n\n        if (!userAuthorization) {\n            return;\n        }\n\n        const reClient = new RelationEngineAPIClient({\n            url,\n            token: userAuthorization.token\n        });\n\n        try {\n            const [nodeInfo] = await reClient.getNodeInfo(relationEngineID);\n            switch (nodeInfo.collection) {\n                case 'taxonomy':\n                    // TODO: add source info here, or let the taxonomy landing page do\n                    // it by itself? I think it is better to do it after the first dispatch\n                    // here, because then the landing page can fold it into its type system,\n                    // rather than requiring the top level to do that. E.g. source->enum.\n                    dispatch(navigateSuccess({\n                        type: ViewType.TAXONOMY,\n                        ref: {\n                            collection: RelationEngineCollection.TAXONOMY,\n                            namespace: stringToTaxonomyNamespace(nodeInfo.namespace),\n                            id: nodeInfo.id,\n                            timestamp: nodeInfo.timestamp\n                        }\n                    }));\n                    // const x = {\n                    //     type: ViewType.TAXONOMY,\n                    //     ref: {\n                    //         collection: RelationEngineCollection.TAXONOMY,\n                    //         namespace: stringToTaxonomyNamespace(nodeInfo.namespace),\n                    //         id: nodeInfo.id,\n                    //         timestamp: nodeInfo.timestamp\n                    //     }\n                    // };\n                    break;\n                case 'ontology':\n                    dispatch(navigateSuccess({\n                        type: ViewType.ONTOLOGY,\n                        ref: {\n                            collection: RelationEngineCollection.ONTOLOGY,\n                            namespace: stringToOntologyNamespace(nodeInfo.namespace),\n                            id: nodeInfo.id,\n                            timestamp: nodeInfo.timestamp\n                        }\n                    }));\n                    break;\n            }\n        } catch (ex) {\n            console.error('ERROR', ex);\n            dispatch(navigateError(ex.message));\n        }\n\n    };\n}\n","import { Action, Reducer } from 'redux';\nimport { baseReducer, BaseStoreState } from '@kbase/ui-components';\nimport { StoreState } from './store';\nimport { AppActions, NavigateSuccess } from './actions';\n\nfunction navigateSuccess(state: StoreState, action: NavigateSuccess): StoreState {\n    return {\n        ...state,\n        // view: {\n        //     status: ViewStatus.LOADED,\n        //     relationEngineID: action.relationEngineID,\n        //     relationEngineNodeType: action.relationEngineNodeType,\n        //     viewType: action.viewType,\n        //     currentView: action.view\n        // }\n        navigation: action.navigation,\n        trigger: Date.now()\n    };\n}\n\n// function navigateStart(state: StoreState, action: NavigateStart): StoreState {\n//     return {\n//         ...state,\n//         view: {\n//             status: ViewStatus.LOADING\n//         }\n//     };\n// }\n\nconst reducer: Reducer<StoreState | undefined, Action> = (state: StoreState | undefined, action: Action) => {\n    const baseState = baseReducer(state as BaseStoreState, action);\n    if (baseState) {\n        return baseState as StoreState;\n    }\n    if (!state) {\n        return state;\n    }\n    switch (action.type) {\n        // case AppActions.NAVIGATE_START:\n        //     return navigateStart(state, action as NavigateStart);\n        case AppActions.NAVIGATE_SUCCESS:\n            return navigateSuccess(state, action as NavigateSuccess);\n    }\n    return state;\n};\n\nexport default reducer;\n","import { BaseStoreState, makeBaseStoreState } from '@kbase/ui-components';\nimport { createStore, compose, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport reducer from '../reducers';\n\nimport { TaxonomyStoreState } from '../../landingPages/taxonomy/redux/store';\nimport { TaxonReference } from '../../types/taxonomy';\nimport { OntologyReference } from '../../types/ontology';\nimport OntologyView from '../../landingPages/ontology/Main/view';\n\nexport enum ViewType {\n    NONE,\n    TAXONOMY,\n    ONTOLOGY\n}\n\nexport type RelationEngineID = string;\nexport enum RelationEngineNodeType {\n    TAXON,\n    ONTOLOGY_TERM\n}\n\nexport enum ViewStatus {\n    NONE,\n    LOADING,\n    LOADED,\n    ERROR\n}\n\nexport interface RelationEngineViewBase {\n    status: ViewStatus;\n}\n\nexport interface RelationEngineViewNone {\n    status: ViewStatus.NONE;\n}\n\nexport interface RelationEngineViewLoading {\n    status: ViewStatus.LOADING;\n}\n\nexport interface RelationEngineViewLoaded {\n    status: ViewStatus.LOADED;\n    relationEngineID: RelationEngineID;\n    relationEngineNodeType: RelationEngineNodeType;\n    viewType: ViewType;\n    currentView: LandingPageView;\n}\n\nexport interface RelationEngineViewError {\n    status: ViewStatus.ERROR;\n    message: string;\n}\n\nexport type RelationEngineView =\n    | RelationEngineViewNone\n    | RelationEngineViewLoading\n    | RelationEngineViewLoaded\n    | RelationEngineViewError;\n\nexport interface LandingPageStoreState { }\n\n// VIEW STATES\n/*\n Sync view state\n Primarily for top level views which don't have an async load operation.\n*/\n\nexport enum SyncViewStatus {\n    NONE,\n    LOADED,\n    ERROR\n}\n\nexport interface SyncViewStateNone<T> {\n    status: SyncViewStatus.NONE;\n}\n\nexport interface SyncViewStateError<T> {\n    status: SyncViewStatus.ERROR;\n    error: string;\n    type: T;\n}\n\nexport interface SyncViewStateLoaded<T, S> {\n    status: SyncViewStatus.LOADED;\n    type: T;\n    state: S;\n}\nexport type SyncViewState<T, S> = SyncViewStateNone<T> | SyncViewStateLoaded<T, S> | SyncViewStateError<T>;\n\n/*\nAsync view state\nFor any component which requires loading.\n*/\n\nexport enum AsyncViewStatus {\n    NONE,\n    LOADING,\n    LOADED,\n    ERROR\n}\n\nexport interface AsyncViewStateNone<T> {\n    status: AsyncViewStatus.NONE;\n    type: T;\n}\n\nexport interface AsyncViewStateLoading<T> {\n    status: AsyncViewStatus.LOADING;\n    type: T;\n}\n\nexport interface AsyncViewStateError<T> {\n    status: AsyncViewStatus.ERROR;\n    error: string;\n    type: T;\n}\n\nexport interface AsyncViewStateLoaded<T, S> {\n    status: AsyncViewStatus.LOADED;\n    type: T;\n    state: S;\n}\nexport type AsyncViewState<T, S> = AsyncViewStateNone<T> | AsyncViewStateLoading<T> | AsyncViewStateLoaded<T, S> | AsyncViewStateError<T>;\n\n\n// And the specific landing page views\n\nexport type TaxonomyView = SyncViewState<ViewType.TAXONOMY, TaxonomyStoreState>;\n\nexport interface NavigationBase {\n    type: ViewType;\n    relationEngineID: RelationEngineID;\n}\n\nexport interface NavigationNone {\n    type: ViewType.NONE;\n}\n\nexport interface NavigationTaxonomy {\n    type: ViewType.TAXONOMY;\n    ref: TaxonReference\n    // namespace: string;\n    // id: string;\n    // timestamp?: number\n    // relationEngineID: RelationEngineID;\n}\n\nexport interface NavigationOntology {\n    type: ViewType.ONTOLOGY;\n    ref: OntologyReference\n    // namespace: string;\n    // id: string;\n    // timestamp?: number\n    // relationEngineID: RelationEngineID;\n}\n\nexport type NavigationSome = NavigationTaxonomy | NavigationOntology;\nexport type Navigation = NavigationNone | NavigationSome;\n\n// export interface ViewState<T, S> {\n//     type: T;\n//     state: S;\n// }\n\nexport type LandingPageView = TaxonomyView;\n\n// OKAY, back to REDUX\n\n// export interface TaxonomyView {\n\n// }\n\n// export interface OntologyView {\n\n// }\n\nexport type View = TaxonomyView | OntologyView | null;\n\n\n// STORE STATE type definition\nexport interface StoreState extends BaseStoreState {\n    // viewer: TaxonView | null;\n    // view: RelationEngineView;\n    navigation: Navigation;\n    trigger: number;\n    view: View\n}\n\n// Store Construction\nexport function makeInitialStoreState(): StoreState {\n    const baseStoreState = makeBaseStoreState();\n    return {\n        ...baseStoreState,\n        // viewer: null,\n        navigation: {\n            type: ViewType.NONE\n        },\n        trigger: 0,\n        view: null\n    };\n}\n\nexport function createReduxStore() {\n    return createStore(reducer, makeInitialStoreState(), compose(applyMiddleware(thunk)));\n}\n","import { UIError } from \"../types\";\n\nexport interface DBProps<T> {\n    onUpdate: () => void;\n    initialData: T;\n}\n\nexport interface TheDB<T> {\n    data: T;\n}\n\nexport enum DBStatus {\n    NONE,\n    LOADING,\n    LOADED,\n    RELOADING,\n    ERROR\n}\n\nexport interface DBStateNone {\n    status: DBStatus.NONE;\n}\n\nexport interface DBStateLoading {\n    status: DBStatus.LOADING;\n}\n\nexport interface DBStateReLoading {\n    status: DBStatus.RELOADING;\n}\n\nexport interface DBStateLoaded {\n    status: DBStatus.LOADED;\n}\n\nexport interface DBStateError {\n    status: DBStatus.ERROR;\n    error: UIError;\n}\n\nexport default class DB<T> {\n    db: TheDB<T>;\n    stopped: boolean;\n    onUpdate: () => void;\n    constructor(props: DBProps<T>) {\n        this.onUpdate = props.onUpdate;\n        this.db = {\n            data: props.initialData\n        };\n        this.stopped = false;\n    }\n\n    forceComponentUpdate() {\n        if (this.stopped) {\n            return;\n        }\n        this.onUpdate();\n    }\n\n    set(updateFun: (state: T) => T) {\n        this.db.data = updateFun(this.db.data);\n        this.forceComponentUpdate();\n    }\n\n    get(): T {\n        return this.db.data;\n    }\n\n    stop() {\n        this.stopped = true;\n    }\n}\n","import { DynamicServiceClient, DynamicServiceClientParams } from '@kbase/ui-lib';\n\ninterface TaxonomyAPIParams extends DynamicServiceClientParams { }\n\ntype TaxonID = string;\n\ninterface GetAncestorsParams {\n    id: TaxonID;\n}\n\ninterface GetDescendentsParams {\n    id: TaxonID;\n}\n\n// interface GetTaxonResultSuccess {\n//     count: true;\n//     taxon: Taxon;\n// }\n\n// interface GetTaxonResultNotFound {\n//     found: false;\n// }\n\n// type GetTaxonResult = GetTaxonResultSuccess | GetTaxonResultNotFound;\n\ninterface TaxonAlias {\n    canonical: Array<string>;\n    category: string;\n    name: string;\n}\n\ninterface TaxonResult {\n    NCBI_taxon_id: number;\n    _id: string;\n    _key: string;\n    _rev: string;\n    id: string;\n    ns: string;\n    ts: number;\n    aliases: Array<TaxonAlias>;\n    canonical_scientific_name: Array<string>;\n    gencode: string;\n    rank: string;\n    scientific_name: string;\n}\n\nexport interface GetTaxonParams {\n    ns: string;\n    id: TaxonID;\n    ts: number\n}\n\ninterface GetTaxonResult {\n    count: number;\n    cursor_id: number | null;\n    has_more: false;\n    stats: {\n        executionTime: number;\n        filtered: number;\n        httpRequests: number;\n        scannedFull: number;\n        scannedIndex: number;\n        writesExecuted: number;\n        writesIgnored: number;\n    };\n    results: Array<TaxonResult>;\n    ts: number;\n}\n\ninterface GetLineageResult {\n    stats: {\n        executionTime: number;\n        filtered: number;\n        httpRequests: number;\n        scannedFull: number;\n        scannedIndex: number;\n        writesExecuted: number;\n        writesIgnored: number;\n    };\n    results: Array<TaxonResult>;\n    ts: number;\n}\n\ninterface GetChildrenResult {\n    stats: {\n        executionTime: number;\n        filtered: number;\n        httpRequests: number;\n        scannedFull: number;\n        scannedIndex: number;\n        writesExecuted: number;\n        writesIgnored: number;\n    };\n    results: Array<TaxonResult>;\n    total_count: number;\n    ts: number;\n}\nexport interface Stats {\n    executionTime: number;\n    filtered: number;\n    httpRequests: number;\n    scannedFull: number;\n    scannedIndex: number;\n    writesExecuted: number;\n    writesIgnored: number;\n}\nexport interface GetAssociatedWorkspaceObjectsResultResult {\n    edge: {\n        _id: string;\n        assigned_by: string;\n        updated_at: number;\n    };\n    ws_obj: {\n        _id: string;\n        deleted: boolean;\n        epoch: number;\n        hash: string;\n        is_public: boolean;\n        name: string;\n        object_id: number;\n        size: number;\n        updated_at: number;\n        version: number;\n        workspace_id: number;\n        type: {\n            module_name: string;\n            type_name: string;\n            maj_ver: number;\n            min_ver: number;\n        }\n    };\n}\n\nexport interface GetAssociatedWorkspaceObjectsResult {\n    results: Array<GetAssociatedWorkspaceObjectsResultResult>;\n    total_count: number;\n    stats: Stats;\n    ts: number;\n}\n\nexport interface GetLineageParams {\n    ns: string;\n    id: TaxonID;\n    ts: number;\n}\n\nexport interface GetChildrenParams {\n    ns: string;\n    id: TaxonID;\n    ts: number;\n    offset: number;\n    limit: number;\n    search_text: string;\n}\n\nexport interface GetAssociatedWorkspaceObjectsParams {\n    taxon_ns: string;\n    taxon_id: TaxonID;\n    ts: number;\n    limit: number;\n    offset: number;\n}\n\nexport default class TaxonomyAPIClient extends DynamicServiceClient {\n    static module: string = 'taxonomy_re_api';\n\n    async getLineage({ ns, id, ts }: { ns: string, id: TaxonID, ts: number }): Promise<GetLineageResult> {\n        const params: GetLineageParams = {\n            ns, id, ts\n        };\n        const [result] = await this.callFunc<[GetLineageParams], [GetLineageResult]>('get_lineage', [\n            params\n        ]);\n        return result;\n    }\n\n    async getChildren({\n        ns,\n        id,\n        ts,\n        offset,\n        limit,\n        searchTerm\n    }: {\n        ns: string,\n        id: TaxonID,\n        ts: number,\n        offset: number,\n        limit: number,\n        searchTerm: string\n    }): Promise<GetChildrenResult> {\n        const [result] = await this.callFunc<[GetChildrenParams], [GetChildrenResult]>('get_children', [\n            {\n                ns, id, ts,\n                offset,\n                limit,\n                search_text: searchTerm\n            }\n        ]);\n        return result;\n    }\n\n    async getTaxon({ ns, id, ts }: { ns: string, id: TaxonID, ts: number }): Promise<GetTaxonResult> {\n        const params: GetTaxonParams = {\n            ns, id, ts\n        }\n        const [result] = await this.callFunc<[GetTaxonParams], [GetTaxonResult]>('get_taxon', [\n            params\n        ]);\n        return result;\n    }\n\n    async getAssociatedWorkspaceObjects({\n        taxon_ns,\n        taxon_id,\n        ts,\n        offset,\n        limit\n    }: {\n        taxon_ns: string,\n        taxon_id: TaxonID,\n        ts: number,\n        offset: number,\n        limit: number\n    }): Promise<GetAssociatedWorkspaceObjectsResult> {\n        const params: GetAssociatedWorkspaceObjectsParams = {\n            taxon_ns, taxon_id, ts, limit, offset\n        }\n        const [result] = await this.callFunc<[GetAssociatedWorkspaceObjectsParams], [GetAssociatedWorkspaceObjectsResult]>('get_associated_ws_objects', [\n            params\n        ]);\n        return result;\n    }\n}\n","import { TaxonReference, Taxon, TaxonomyNamespace, NCBITaxon, taxonomyNamespaceToString } from '../../../types/taxonomy';\nimport TaxonAPIClient from './TaxonAPIClient';\nimport { RelationEngineCollection } from '../../../types';\nimport { WorkspaceType } from '../../../types/ontology';\n\n// const INITIAL_BATCH_SIZE = 100;\n// const BATCH_SIZE = 1000;\n// const TOTAL_LIMIT = 10000;\n// const PARALLELISM = 2;\n\nexport interface GetChildrenOptions {\n    offset: number;\n    limit: number;\n    searchTerm: string;\n}\n\nexport interface WorkspaceType {\n    module: string;\n    name: string;\n    majorVersion: number;\n    minorVersion: number;\n}\n\nexport interface LinkedObject {\n    linkedAt: number;\n    workspaceID: number;\n    objectID: number;\n    version: number;\n    objectName: string;\n    workspaceUpdatedAt: number;\n    createdAt: number;\n    type: WorkspaceType;\n}\n\nexport interface GetLinkedObjectsOptions {\n    offset: number;\n    limit: number;\n}\n\nexport interface GetLinkedObjectsResult {\n    linkedObjects: Array<LinkedObject>;\n    totalCount: number;\n}\n\nexport class TaxonomyModel {\n    taxonomyClient: TaxonAPIClient;\n    constructor({ token, url }: { token: string; url: string }) {\n        this.taxonomyClient = new TaxonAPIClient({ token, url });\n    }\n\n    async getLineage(taxonRef: TaxonReference): Promise<Array<Taxon>> {\n        const {\n            namespace, id, timestamp\n        } = taxonRef;\n        const result = await this.taxonomyClient.getLineage({\n            ns: taxonomyNamespaceToString(namespace),\n            id,\n            ts: timestamp\n        });\n        // TODO: should be conditional based on the source of the taxonomy??\n        const taxons: Array<NCBITaxon> = result.results.map((taxonResult) => {\n            let isBiological: boolean;\n            if (taxonResult.scientific_name === 'root' || taxonResult.scientific_name === 'cellular organisms') {\n                isBiological = false;\n            } else {\n                isBiological = true;\n            }\n            return {\n                ref: {\n                    collection: RelationEngineCollection.TAXONOMY,\n                    namespace: TaxonomyNamespace.NCBI,\n                    id: taxonResult.id,\n                    timestamp: result.ts\n                },\n                name: taxonResult.scientific_name,\n                rank: taxonResult.rank,\n                ncbiID: taxonResult.NCBI_taxon_id,\n                geneticCode: parseInt(taxonResult.gencode),\n                aliases: taxonResult.aliases.map(({ name, category }) => {\n                    return {\n                        name,\n                        category\n                    };\n                }),\n                isBiological\n            };\n        });\n        return taxons;\n    }\n\n    async getChildren(taxonRef: TaxonReference, options: GetChildrenOptions): Promise<[Array<Taxon>, number]> {\n        const {\n            namespace, id, timestamp\n        } = taxonRef;\n\n        const result = await this.taxonomyClient.getChildren({\n            ns: taxonomyNamespaceToString(namespace),\n            id,\n            ts: timestamp,\n            offset: options.offset,\n            limit: options.limit,\n            searchTerm: options.searchTerm\n        });\n\n        const taxa: Array<NCBITaxon> = result.results.map((taxonResult) => {\n            let isBiological: boolean;\n            if (taxonResult.scientific_name === 'root' || taxonResult.scientific_name === 'cellular organisms') {\n                isBiological = false;\n            } else {\n                isBiological = true;\n            }\n            return {\n                ref: {\n                    collection: RelationEngineCollection.TAXONOMY,\n                    namespace: TaxonomyNamespace.NCBI,\n                    id: taxonResult.id,\n                    timestamp: result.ts\n                },\n                name: taxonResult.scientific_name,\n                rank: taxonResult.rank,\n                ncbiID: taxonResult.NCBI_taxon_id,\n                geneticCode: parseInt(taxonResult.gencode),\n                aliases: taxonResult.aliases.map(({ name, category }) => {\n                    return {\n                        name,\n                        category\n                    };\n                }),\n                isBiological\n            };\n        });\n        return [taxa, result.total_count];\n    }\n\n    // async getChildrenx(taxonID: TaxonID, options: GetChildrenOptions): Promise<[Array<Taxon>, number, number]> {\n    //     // Loop over results until done!\n    //     // Get the first batch. In the majority of cases, this will be it.\n\n    //     const getBatch = async (batch: number, batchSize: number): Promise<[Array<Taxon>, number]> => {\n    //         const offset = batch * batchSize;\n    //         const result = await this.taxonomyClient.getChildren({\n    //             taxonID,\n    //             offset,\n    //             limit: batchSize\n    //         });\n\n    //         const taxa = result.results.map((taxonResult) => {\n    //             let isBiological: boolean;\n    //             if (taxonResult.scientific_name === 'root' || taxonResult.scientific_name === 'cellular organisms') {\n    //                 isBiological = false;\n    //             } else {\n    //                 isBiological = true;\n    //             }\n    //             return {\n    //                 type: TaxonomySource.NCBI,\n    //                 id: taxonResult._id,\n    //                 name: taxonResult.scientific_name,\n    //                 rank: taxonResult.rank,\n    //                 ncbiID: taxonResult.NCBI_taxon_id,\n    //                 geneticCode: parseInt(taxonResult.gencode),\n    //                 aliases: taxonResult.aliases.map(({ name, category }) => {\n    //                     return {\n    //                         name,\n    //                         category\n    //                     };\n    //                 }),\n    //                 isBiological\n    //             };\n    //         });\n    //         return [taxa, result.total_count];\n    //     };\n\n    //     const [taxa, totalCount] = await getBatch(0, INITIAL_BATCH_SIZE);\n\n    //     if (totalCount <= taxa.length) {\n    //         return [taxa, totalCount, totalCount];\n    //     }\n\n    //     // Here we cap the total results requested to TOTAL_LIMIT\n    //     let totalLimit = Math.min(totalCount, TOTAL_LIMIT);\n\n    //     // How many batches do we need to fetch?\n    //     const totalBatchCount = Math.ceil((totalLimit - INITIAL_BATCH_SIZE) / BATCH_SIZE);\n\n    //     // In order to avoid overwhelming the service, we need to limit the\n    //     // # of concurrent requests.\n    //     const iterations = Math.ceil(totalBatchCount / PARALLELISM);\n\n    //     console.log('BATCHES', totalBatchCount, iterations);\n\n    //     let result = taxa;\n\n    //     console.log('taxa', taxa);\n\n    //     for (let iter = 0; iter < iterations; iter += 1) {\n    //         const pendingBatches: Array<Promise<[Array<Taxon>, number]>> = [];\n\n    //         const batchCount = Math.min(PARALLELISM, totalBatchCount - iter * PARALLELISM);\n\n    //         console.log(`iter ${iter}`);\n\n    //         for (let batch = 0; batch < batchCount; batch += 1) {\n    //             const offset = iter * PARALLELISM + batch;\n    //             const batchSize = Math.min(BATCH_SIZE, totalLimit - offset * BATCH_SIZE);\n    //             console.log('BATCH SIZE', batchSize, iter, batch, totalLimit - offset * BATCH_SIZE);\n    //             pendingBatches.push(getBatch(offset, batchSize));\n    //             // const [nextResult] = await getBatch(i);\n    //             // console.log('adding another batch', nextResult);\n    //             // result = result.concat(nextResult);\n    //         }\n\n    //         const batches = await Promise.all(pendingBatches);\n\n    //         result = result.concat.apply(\n    //             result,\n    //             batches.map(([taxa, count]) => {\n    //                 return taxa;\n    //             })\n    //         );\n    //     }\n\n    //     return [result, totalCount, totalLimit];\n    // }\n\n    async getTaxon(taxonRef: TaxonReference): Promise<Taxon> {\n        const {\n            namespace, id, timestamp\n        } = taxonRef;\n\n        const result = await this.taxonomyClient.getTaxon({\n            ns: taxonomyNamespaceToString(namespace),\n            id,\n            ts: timestamp\n        });\n\n        // if (!result.count) {\n        //     throw new Error(`Taxon not found`);\n        // }\n        const taxonResult = result.results[0];\n        let isBiological: boolean;\n        if (taxonResult.scientific_name === 'root' || taxonResult.scientific_name === 'cellular organisms') {\n            isBiological = false;\n        } else {\n            isBiological = true;\n        }\n\n        // TODO: here and above, we need to determine the namespace enum value by \n        // comparing the string coming in...\n        const taxon: Taxon = {\n            ref: {\n                collection: RelationEngineCollection.TAXONOMY,\n                namespace: TaxonomyNamespace.NCBI,\n                id: taxonResult.id,\n                timestamp: result.ts\n            },\n            name: taxonResult.scientific_name,\n            rank: taxonResult.rank,\n            ncbiID: taxonResult.NCBI_taxon_id,\n            geneticCode: parseInt(taxonResult.gencode),\n            aliases: taxonResult.aliases.map(({ name, category }) => {\n                return {\n                    name,\n                    category\n                };\n            }),\n            isBiological\n        };\n        return taxon;\n    }\n\n    async getLinkedObjects(taxonRef: TaxonReference, options: GetLinkedObjectsOptions): Promise<GetLinkedObjectsResult> {\n        const params = {\n            taxon_ns: taxonomyNamespaceToString(taxonRef.namespace),\n            taxon_id: taxonRef.id,\n            ts: taxonRef.timestamp,\n            offset: options.offset,\n            limit: options.limit\n        };\n        const result = await this.taxonomyClient.getAssociatedWorkspaceObjects(params);\n\n        const linkedObjects = result.results.map((result) => {\n            return {\n                linkedAt: result.edge.updated_at,\n                objectID: result.ws_obj.object_id,\n                workspaceID: result.ws_obj.workspace_id,\n                version: result.ws_obj.version,\n                objectName: result.ws_obj.name,\n                createdAt: result.ws_obj.epoch,\n                workspaceUpdatedAt: result.ws_obj.updated_at,\n                type: {\n                    module: result.ws_obj.type.module_name,\n                    name: result.ws_obj.type.type_name,\n                    majorVersion: result.ws_obj.type.maj_ver,\n                    minorVersion: result.ws_obj.type.min_ver\n                }\n            };\n        });\n        return {\n            linkedObjects,\n            totalCount: result.total_count\n        };\n    }\n}\n","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport { Taxon, TaxonReference } from '../../../types/taxonomy';\nimport { TaxonomyModel } from '../lib/model';\n\nexport type TaxonDBStateNone = DBStateNone;\nexport type TaxonDBStateLoading = DBStateLoading;\nexport type TaxonDBStateError = DBStateError;\n\nexport interface TaxonDBStateLoaded extends DBStateLoaded {\n    targetTaxon: Taxon;\n    selectedTaxon: Taxon;\n}\n\nexport type TaxonDBState = TaxonDBStateNone | TaxonDBStateLoading | TaxonDBStateLoaded | TaxonDBStateError;\n\nexport interface TaxonDBProps extends DBProps<TaxonDBState> {\n    token: string;\n    config: AppConfig;\n}\n\n// TODO: make props part of generic\nexport default class TaxonDB extends DB<TaxonDBState> {\n    props: TaxonDBProps;\n    constructor(props: TaxonDBProps) {\n        super(props);\n        this.props = props;\n    }\n    async getTargetTaxon(taxonRef: TaxonReference) {\n        try {\n            this.set((state: TaxonDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADING\n                };\n            });\n\n            const client = new TaxonomyModel({\n                token: this.props.token,\n                url: this.props.config.services.ServiceWizard.url\n            });\n\n            const taxon = await client.getTaxon(taxonRef);\n            this.set((state: TaxonDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    targetTaxon: taxon,\n                    selectedTaxon: taxon\n                };\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: TaxonDBState) => {\n                return {\n                    status: DBStatus.ERROR,\n                    error: {\n                        code: 'not-found',\n                        source: 'TaxonDB.getTargetTaxon',\n                        message: ex.message,\n                    }\n                };\n            });\n        }\n    }\n\n    async getSelectedTaxon(taxonRef: TaxonReference) {\n        try {\n            // this.set((state: TaxonDBState) => {\n            //     return {\n            //         ...state,\n            //         status: DBStatus.LOADING\n            //     };\n            // });\n\n            const client = new TaxonomyModel({\n                token: this.props.token,\n                url: this.props.config.services.ServiceWizard.url\n            });\n\n            const taxon = await client.getTaxon(taxonRef);\n            this.set((state: TaxonDBState) => {\n                return {\n                    ...state,\n                    selectedTaxon: taxon\n                };\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: TaxonDBState) => {\n                return {\n                    status: DBStatus.ERROR,\n                    error: {\n                        code: 'not-found',\n                        source: 'TaxonDB.getSelectedTaxon',\n                        message: ex.message,\n                    }\n                };\n            });\n        }\n    }\n}\n","import React from 'react';\nimport './SourceInfo.css';\n\nexport interface SourceInfoProps {}\n\ninterface SourceInfoState {}\n\nexport class SourceInfo extends React.Component<SourceInfoProps, SourceInfoState> {\n    render() {\n        return (\n            <div className=\"Row\">\n                <div className=\"Col-auto\">\n                    <img src=\"images/ncbi-logo.jpg\" style={{ height: '64px' }} alt=\"NCBI Logo\" />\n                </div>\n                <div className=\"Col\">\n                    <div className=\"InfoTable\">\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                                Source\n                            </div>\n                            <div className=\"InfoTable-dataCol\">\n                                <a\n                                    href=\"https://www.ncbi.nlm.nih.gov/guide/taxonomy/\"\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                >\n                                    NCBI\n                                </a>\n                            </div>\n                        </div>\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                                Version\n                            </div>\n                            <div className=\"InfoTable-dataCol\">SOME VERSION</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import React from 'react';\nimport { Taxon, TaxonReference, taxonomyNamespaceToString } from '../../types/taxonomy';\nimport { Tooltip, Icon } from 'antd';\nimport './TaxonItem.css';\nimport { relationEngineCollectionToString } from '../../types';\n\nexport interface Props {\n    taxon: Taxon;\n    isActive: boolean;\n    selectTaxonRef: (ref: TaxonReference) => void;\n    navigateToTaxonRef: (ref: TaxonReference) => void;\n}\n\ninterface State {\n    hovering: boolean;\n}\n\nexport default class TaxonItem extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            hovering: false\n        };\n    }\n    clickTaxon() {\n        this.props.selectTaxonRef(this.props.taxon.ref);\n    }\n    clickNavigateToTaxon() {\n        // const fixedID = this.props.taxon.id.replace('/', ':');\n        const hash = [\n            'review',\n            relationEngineCollectionToString(this.props.taxon.ref.collection),\n            taxonomyNamespaceToString(this.props.taxon.ref.namespace),\n            this.props.taxon.ref.id,\n            String(this.props.taxon.ref.timestamp)\n        ].join('/');\n        // const hash = `review/${fixedID}`;\n        // TODO: use the integration api?\n        if (window.parent) {\n            window.parent.location.hash = hash;\n        } else {\n            window.location.hash = hash;\n        }\n        // window.history.pushState({}, 'my title', `/#review/${this.props.taxon.id}`);\n        // this.props.navigateToTaxonID(this.props.taxon.id);\n    }\n\n    onMouseEnter(ev: React.MouseEvent<HTMLDivElement>) {\n        this.setState({ hovering: true });\n    }\n\n    onMouseLeave(ev: React.MouseEvent<HTMLDivElement>) {\n        this.setState({ hovering: false });\n    }\n\n    renderOver() {\n        return (\n            <React.Fragment>\n                <div className=\"TaxonItem-name\" onClick={this.clickNavigateToTaxon.bind(this)}>\n                    {this.props.taxon.name}\n                </div>\n                <div className=\"TaxonItem-inspector\" onClick={this.clickTaxon.bind(this)}>\n                    <Icon type=\"arrow-right\" />\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    renderActive() {\n        return (\n            <React.Fragment>\n                <div className=\"TaxonItem-name\" onClick={this.clickNavigateToTaxon.bind(this)}>\n                    {this.props.taxon.name}\n                </div>\n                <div className=\"TaxonItem-inspector\">\n                    <Icon type=\"arrow-right\" />\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    renderNormal() {\n        return (\n            <React.Fragment>\n                <div className=\"TaxonItem-name\">{this.props.taxon.name}</div>\n            </React.Fragment>\n        );\n    }\n\n    renderItem() {\n        if (this.props.isActive) {\n            return this.renderActive();\n        }\n        if (this.state.hovering) {\n            return this.renderOver();\n        } else {\n            return this.renderNormal();\n        }\n    }\n\n    render() {\n        const taxon = this.props.taxon;\n        const classNames = ['TaxonItem'];\n        if (this.props.isActive) {\n            classNames.push('TaxonItem-active');\n        }\n\n        const tooltipTitle = (\n            <div>\n                <div style={{ borderBottom: '1px solid silver' }}>{taxon.name}</div>\n                <div>{taxon.rank}</div>\n            </div>\n        );\n\n        return (\n            <Tooltip title={tooltipTitle} placement=\"right\">\n                <div\n                    className={classNames.join(' ')}\n                    key={this.props.taxon.ref.id}\n                    onMouseEnter={this.onMouseEnter.bind(this)}\n                    onMouseLeave={this.onMouseLeave.bind(this)}\n                >\n                    {this.renderItem()}\n                </div>\n            </Tooltip>\n        );\n    }\n}\n","import DB, {\n    DBProps,\n    DBStatus,\n    DBStateNone,\n    DBStateLoading,\n    DBStateLoaded,\n    DBStateError,\n    DBStateReLoading\n} from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport { Taxon, TaxonReference } from '../../../types/taxonomy';\nimport { TaxonomyModel } from '../lib/model';\n\nexport type TaxonDBStateNone = DBStateNone;\nexport type TaxonDBStateLoading = DBStateLoading;\nexport type TaxonDBStateError = DBStateError;\n\nexport interface TaxonDBStateLoaded extends DBStateLoaded {\n    taxa: Array<Taxon>;\n    total: number;\n    page: number;\n    pageSize: number;\n}\n\nexport interface TaxonDBStateReLoading extends DBStateReLoading {\n    taxa: Array<Taxon>;\n    total: number;\n    page: number;\n    pageSize: number;\n}\n\nexport type TaxonDBState =\n    | TaxonDBStateNone\n    | TaxonDBStateLoading\n    | TaxonDBStateLoaded\n    | TaxonDBStateReLoading\n    | TaxonDBStateError;\n\nexport interface TaxonDBProps extends DBProps<TaxonDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport default class TaxonChildrenDB extends DB<TaxonDBState> {\n    token: string;\n    serviceWizardURL: string;\n    constructor(props: TaxonDBProps) {\n        super(props);\n        this.token = props.token;\n        this.serviceWizardURL = props.config.services.ServiceWizard.url;\n    }\n    // Remember, pages are 1 based; offset is 0 based.\n    // async fetchTaxa(taxonID: TaxonID, page: number, pageSize: number) {\n    //     try {\n    //         this.set((state: TaxonDBState) => {\n    //             return {\n    //                 ...state,\n    //                 status: DBStatus.LOADING\n    //             };\n    //         });\n\n    //         const client = new TaxonomyModel({\n    //             token: this.token,\n    //             url: this.serviceWizardURL\n    //         });\n\n    //         const offset = (page - 1) * pageSize;\n    //         const limit = pageSize;\n\n    //         const [taxa, totalCount] = await client.getChildren(taxonID, {\n    //             offset,\n    //             limit\n    //         });\n    //         this.set((state: TaxonDBState) => {\n    //             return {\n    //                 ...state,\n    //                 status: DBStatus.LOADED,\n    //                 taxa,\n    //                 total: totalCount,\n    //                 page,\n    //                 pageSize\n    //             };\n    //         });\n    //     } catch (ex) {\n    //         console.error('ERROR', ex);\n    //         this.set((state: TaxonDBState) => {\n    //             return {\n    //                 status: DBStatus.ERROR,\n    //                 message: ex.message\n    //             };\n    //         });\n    //     }\n    // }\n\n    async fetchChildren({\n        taxonRef,\n        page,\n        pageSize,\n        searchTerm\n    }: {\n        taxonRef: TaxonReference;\n        page: number;\n        pageSize: number;\n        searchTerm: string;\n    }) {\n        try {\n            this.set((state: TaxonDBState) => {\n                if (state.status === DBStatus.LOADED) {\n                    return {\n                        ...state,\n                        status: DBStatus.RELOADING\n                    };\n                } else {\n                    return {\n                        ...state,\n                        status: DBStatus.LOADING\n                    };\n                }\n            });\n\n            const client = new TaxonomyModel({\n                token: this.token,\n                url: this.serviceWizardURL\n            });\n\n            const offset = (page - 1) * pageSize;\n            const limit = pageSize;\n\n            const [taxa, totalCount] = await client.getChildren(taxonRef, {\n                offset,\n                limit,\n                searchTerm\n            });\n            this.set((state: TaxonDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    taxa,\n                    total: totalCount,\n                    page,\n                    pageSize\n                };\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: TaxonDBState) => {\n                return {\n                    status: DBStatus.ERROR,\n                    error: {\n                        code: 'not-found',\n                        source: 'TaxonChildrenDB.fetchChildren',\n                        message: ex.message,\n                    }\n                };\n            });\n        }\n    }\n}\n","import React from 'react';\nimport { Taxon, TaxonReference } from '../../types/taxonomy';\nimport './TaxonList.css';\nimport TaxonItem from './TaxonItem';\nimport { Empty } from 'antd';\n\nexport interface Props {\n    taxa: Array<Taxon>;\n    maxItems: number;\n    totalItems: number;\n    selectedTaxonRef: TaxonReference | null;\n    selectTaxonRef: (ref: TaxonReference) => void;\n    navigateToTaxonRef: (ref: TaxonReference) => void;\n}\n\ninterface State { }\n\nexport default class TaxonList extends React.Component<Props, State> {\n    selectTaxon(ref: TaxonReference) {\n        this.props.selectTaxonRef(ref);\n    }\n    navigateToTaxon(ref: TaxonReference) {\n        this.props.navigateToTaxonRef(ref);\n    }\n    renderItemsPlain() {\n        return this.props.taxa.map((taxon, index) => {\n            const isActive = this.props.selectedTaxonRef !== null &&\n                this.props.selectedTaxonRef.id === taxon.ref.id;\n            return (\n                <TaxonItem\n                    taxon={taxon}\n                    isActive={isActive}\n                    selectTaxonRef={this.selectTaxon.bind(this)}\n                    key={String(index)}\n                    navigateToTaxonRef={this.navigateToTaxon.bind(this)}\n                />\n            );\n        });\n    }\n    renderNoItems() {\n        return <Empty description=\"No Children\" image={Empty.PRESENTED_IMAGE_SIMPLE} />;\n    }\n    render() {\n        if (this.props.taxa.length === 0) {\n            return this.renderNoItems();\n        }\n        return this.renderItemsPlain();\n    }\n}\n","import React from 'react';\nimport { UIError } from \"../types\";\nimport { Alert, Icon } from 'antd';\n\nexport interface ErrorViewProps {\n    error: UIError\n}\n\ninterface ErrorViewState {\n\n}\n\nexport default class ErrorView extends React.Component<ErrorViewProps, ErrorViewState> {\n    renderMessage() {\n        return (\n            // <Icon type=\"exclamation-circle\" />\n            <span>\n                <Icon type=\"exclamation-circle\" style={{ color: 'red' }} />\n                {' '}\n                {this.props.error.message}\n            </span>\n        )\n    }\n    render() {\n        return (\n            <Alert type=\"error\" message={this.renderMessage()}></Alert>\n        )\n    }\n}","import React from 'react';\nimport { Pagination, Icon, Input, Spin } from 'antd';\nimport TaxonList from '../TaxonList';\nimport { TaxonReference } from '../../../types/taxonomy';\nimport { TaxonDBState, TaxonDBStateError, TaxonDBStateLoaded, TaxonDBStateReLoading } from './TaxonChildrenDB';\nimport { DBStatus } from '../../../lib/DB';\nimport './index.css';\nimport ErrorView from '../../../components/ErrorView';\n\nconst DEFAULT_PAGE_SIZE = 10;\n\nexport interface Props {\n    db: TaxonDBState;\n    taxonRef: TaxonReference;\n    selectedTaxonRef: TaxonReference | null;\n    // taxa: Array<Taxon>;\n    // total: number;\n    selectTaxonRef: (taxonRef: TaxonReference) => void;\n    navigateToTaxonRef: (taxonRef: TaxonReference) => void;\n    fetchChildren: (taxonRef: TaxonReference, page: number, pageSize: number, searchTerm: string) => void;\n}\n\nexport interface State { }\n\nexport default class TaxonChildren extends React.Component<Props, State> {\n    searchTerm: string;\n    page: number;\n    pageSize: number | null;\n    constructor(props: Props) {\n        super(props);\n        this.searchTerm = '';\n        this.page = 1;\n        this.pageSize = null;\n    }\n    componentDidMount() {\n        this.props.fetchChildren(this.props.taxonRef, 1, DEFAULT_PAGE_SIZE, '');\n    }\n    renderTaxaNone() {\n        return <div>None</div>;\n    }\n    renderTaxaLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderTitleLoaded(db: TaxonDBStateLoaded | TaxonDBStateReLoading) {\n        if (db.total === 0) {\n            return <div className=\"Col-auto TaxonChildren-box-title\">No Children</div>;\n        }\n\n        const totalCount = Intl.NumberFormat('en-US', {\n            useGrouping: true\n        }).format(db.total);\n        const currentItem = (db.page - 1) * db.pageSize + 1;\n        const lastItem = currentItem + db.taxa.length - 1;\n\n        return (\n            <div className=\"Col-auto TaxonChildren-box-title\">\n                Children ({currentItem}-{lastItem} of {totalCount})\n            </div>\n        );\n    }\n\n    renderTitleReLoading(db: TaxonDBStateReLoading) {\n        return <Spin size=\"small\">{this.renderTitleLoaded(db)}</Spin>;\n    }\n\n    renderTitle() {\n        const db = this.props.db;\n        switch (db.status) {\n            case DBStatus.NONE:\n            case DBStatus.LOADING:\n                return <div>Loading...</div>;\n            case DBStatus.ERROR:\n                return <ErrorView error={db.error} />\n            case DBStatus.LOADED:\n                return this.renderTitleLoaded(db);\n            case DBStatus.RELOADING:\n                return this.renderTitleReLoading(db);\n        }\n    }\n    doSearch(term: string) {\n        this.searchTerm = term;\n        this.props.fetchChildren(this.props.taxonRef, 1, this.pageSize || DEFAULT_PAGE_SIZE, term);\n    }\n    renderSearch() {\n        const disabled =\n            this.props.db.status !== DBStatus.LOADED ||\n            (this.props.db.total <= this.props.db.pageSize && !this.searchTerm);\n        return (\n            <div style={{ marginBottom: '4px' }}>\n                <Input.Search placeholder=\"Search Children\" onSearch={this.doSearch.bind(this)} disabled={disabled} />\n            </div>\n        );\n    }\n    renderTaxaLoaded(db: TaxonDBStateLoaded | TaxonDBStateReLoading) {\n        return (\n            <React.Fragment>\n                <TaxonList\n                    taxa={db.taxa}\n                    selectedTaxonRef={this.props.selectedTaxonRef}\n                    selectTaxonRef={this.props.selectTaxonRef}\n                    navigateToTaxonRef={this.props.navigateToTaxonRef}\n                    totalItems={db.total}\n                    maxItems={DEFAULT_PAGE_SIZE}\n                />\n            </React.Fragment>\n        );\n    }\n    renderTaxaReLoading(db: TaxonDBStateReLoading) {\n        return <Spin tip=\"Loading\">{this.renderTaxaLoaded(db)}</Spin>;\n    }\n    renderTaxaError(db: TaxonDBStateError) {\n        return <ErrorView error={db.error} />\n    }\n    renderTaxa() {\n        switch (this.props.db.status) {\n            case DBStatus.NONE:\n                return this.renderTaxaNone();\n            case DBStatus.LOADING:\n                return this.renderTaxaLoading();\n            case DBStatus.LOADED:\n                return this.renderTaxaLoaded(this.props.db);\n            case DBStatus.RELOADING:\n                return this.renderTaxaReLoading(this.props.db);\n            case DBStatus.ERROR:\n                return this.renderTaxaError(this.props.db);\n        }\n    }\n    changePage(page: number, pageSize: number | undefined) {\n        this.page = page;\n        this.pageSize = pageSize || DEFAULT_PAGE_SIZE;\n        this.props.fetchChildren(this.props.taxonRef, this.page, this.pageSize, this.searchTerm);\n    }\n    renderPaginationNone() {\n        return <Pagination size=\"small\" showLessItems={true} hideOnSinglePage={false} />;\n    }\n    renderPaginationLoading() {\n        return <Pagination size=\"small\" showLessItems={true} hideOnSinglePage={false} />;\n    }\n    renderPaginationError() {\n        return <Pagination size=\"small\" showLessItems={true} hideOnSinglePage={false} />;\n    }\n    renderPaginationLoaded(db: TaxonDBStateLoaded) {\n        return (\n            <Pagination\n                size=\"small\"\n                defaultPageSize={db.pageSize}\n                // defaultCurrent={1}\n                showLessItems={true}\n                current={db.page}\n                hideOnSinglePage={false}\n                total={db.total}\n                onChange={this.changePage.bind(this)}\n            />\n        );\n    }\n    renderPaginationReLoading(db: TaxonDBStateReLoading) {\n        return (\n            <Pagination\n                size=\"small\"\n                defaultPageSize={db.pageSize}\n                // defaultCurrent={1}\n                showLessItems={true}\n                current={db.page}\n                hideOnSinglePage={false}\n                total={db.total}\n                disabled={true}\n            />\n        );\n    }\n    renderPagination() {\n        const db = this.props.db;\n        switch (db.status) {\n            case DBStatus.NONE:\n                return this.renderPaginationNone();\n            case DBStatus.LOADING:\n                return this.renderPaginationLoading();\n            case DBStatus.ERROR:\n                return this.renderPaginationError();\n            case DBStatus.LOADED:\n                return this.renderPaginationLoaded(db);\n            case DBStatus.RELOADING:\n                return this.renderPaginationReLoading(db);\n        }\n    }\n    renderChildren() {\n        return (\n            <div>\n                {this.renderTitle()}\n                {this.renderSearch()}\n                {this.renderPagination()}\n                {this.renderTaxa()}\n            </div>\n        );\n    }\n\n    render() {\n        return this.renderChildren();\n    }\n}\n","import React from 'react';\nimport TaxonDB, { TaxonDBState, TaxonDBStateError } from './TaxonChildrenDB';\nimport { DBStatus } from '../../../lib/DB';\n\nimport { AppConfig } from '@kbase/ui-components';\nimport TaxonChildren from './TaxonChildren';\nimport { TaxonReference } from '../../../types/taxonomy';\nimport { Alert } from 'antd';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    taxonRef: TaxonReference;\n    selectedTaxonRef: TaxonReference | null;\n    selectTaxonRef: (taxonRef: TaxonReference) => void;\n    navigateToTaxonRef: (taxonRef: TaxonReference) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: TaxonDB;\n    constructor(props: Props) {\n        super(props);\n        this.db = new TaxonDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n    }\n\n    componentDidMount() {\n        // this.db.stop();\n    }\n\n    fetchChildren(taxonRef: TaxonReference, page: number, pageSize: number, searchTerm: string) {\n        return this.db.fetchChildren({ taxonRef, page, pageSize, searchTerm });\n    }\n\n    renderSuccess(db: TaxonDBState) {\n        return <TaxonChildren\n            db={db}\n            taxonRef={this.props.taxonRef}\n            selectedTaxonRef={this.props.selectedTaxonRef}\n            selectTaxonRef={this.props.selectTaxonRef}\n            navigateToTaxonRef={this.props.navigateToTaxonRef}\n            fetchChildren={this.fetchChildren.bind(this)}\n        />\n    }\n\n    renderError(db: TaxonDBStateError) {\n        return <Alert type=\"error\" message={db.error.message} />\n    }\n\n    renderTest() {\n        return \"test\";\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case (DBStatus.ERROR):\n                return this.renderError(db);\n            default:\n                // return this.renderTest()\n                return this.renderSuccess(db);\n        }\n    }\n}\n","import { AppConfig } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps { }\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {};\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport { Taxon, TaxonReference } from '../../../types/taxonomy';\nimport { TaxonomyModel } from '../lib/model';\n\nexport type LineageDBStateNone = DBStateNone;\nexport type LineageDBStateLoading = DBStateLoading;\nexport type LineageDBStateError = DBStateError;\n\nexport interface LineageDBStateLoaded extends DBStateLoaded {\n    lineage: Array<Taxon>;\n}\n\nexport type LineageDBState = LineageDBStateNone | LineageDBStateLoading | LineageDBStateLoaded | LineageDBStateError;\n\nexport interface LineageDBProps extends DBProps<LineageDBState> {\n    token: string;\n    config: AppConfig;\n}\n\n// TODO: make props part of generic\nexport default class LineageDB extends DB<LineageDBState> {\n    props: LineageDBProps;\n    constructor(props: LineageDBProps) {\n        super(props);\n        this.props = props;\n    }\n    async getLineage(taxonRef: TaxonReference) {\n        try {\n            this.set((state: LineageDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADING\n                };\n            });\n\n            const client = new TaxonomyModel({\n                token: this.props.token,\n                url: this.props.config.services.ServiceWizard.url\n            });\n            const lineage = await client.getLineage(taxonRef);\n            this.set((state: LineageDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    lineage\n                };\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: LineageDBState) => {\n                return {\n                    status: DBStatus.ERROR,\n                    error: {\n                        code: 'not-found',\n                        source: 'LineageDB.getLineage',\n                        message: ex.message,\n                    }\n                };\n            });\n        }\n    }\n}\n","import React from 'react';\nimport { Taxon, TaxonReference } from '../../../types/taxonomy';\nimport TaxonList from '../TaxonList';\n\nexport interface Props {\n    lineage: Array<Taxon>;\n    selectedTaxonRef: TaxonReference;\n    selectTaxonRef: (ref: TaxonReference) => void;\n    navigateToTaxonRef: (ref: TaxonReference) => void;\n}\n\ninterface State { }\n\nexport default class Lineage extends React.Component<Props, State> {\n    render() {\n        return (\n            <TaxonList\n                taxa={this.props.lineage}\n                selectedTaxonRef={this.props.selectedTaxonRef}\n                selectTaxonRef={this.props.selectTaxonRef}\n                navigateToTaxonRef={this.props.navigateToTaxonRef}\n                totalItems={this.props.lineage.length}\n                maxItems={10}\n            />\n        );\n    }\n}\n","import React from 'react';\nimport LineageDB, { LineageDBStateLoaded } from './LineageDB';\nimport { DBStatus, DBStateError } from '../../../lib/DB';\n\nimport { AppConfig } from '@kbase/ui-components';\nimport Lineage from './Lineage';\nimport { TaxonReference } from '../../../types/taxonomy';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../components/ErrorView';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    taxonRef: TaxonReference;\n    selectedTaxonRef: TaxonReference;\n    selectTaxonRef: (taxonRef: TaxonReference) => void;\n    navigateToTaxonRef: (taxonRef: TaxonReference) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: LineageDB;\n    constructor(props: Props) {\n        super(props);\n        this.db = new LineageDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n    }\n\n    componentDidMount() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                this.db.getLineage(this.props.taxonRef);\n        }\n    }\n\n    componentWillUnmount() {\n        // this.db.stop();\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        return <ErrorView error={db.error} />\n    }\n\n    renderLoaded(db: LineageDBStateLoaded) {\n        return (\n            <Lineage\n                lineage={db.lineage}\n                selectedTaxonRef={this.props.selectedTaxonRef}\n                selectTaxonRef={this.props.selectTaxonRef}\n                navigateToTaxonRef={this.props.navigateToTaxonRef}\n            />\n        );\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                // this.db.getLineage(this.props.taxonRef);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n        }\n    }\n}\n","import { AppConfig } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps { }\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {};\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import React from 'react';\nimport { Taxon, TaxonReference } from '../../types/taxonomy';\nimport './LineageNavigator.css';\nimport TaxonItem from './TaxonItem';\nimport TaxonChildren from './taxonChildren';\nimport Lineage from './lineage';\n\nexport interface LineageProps {\n    selectedTaxon: Taxon;\n    targetTaxon: Taxon;\n    selectTaxonRef: (ref: TaxonReference) => void;\n    navigateToTaxonRef: (ref: TaxonReference) => void;\n}\n\ninterface LineageState { }\n\nexport default class LineageNavigator extends React.Component<LineageProps, LineageState> {\n    onClick(ref: TaxonReference) {\n        this.props.selectTaxonRef(ref);\n        // alert('navigate to ' + taxonId);\n    }\n\n    // menuSelected(param: SelectParam) {\n    //     this.props.selectTaxonRef(param.key);\n    //     // alert('navigate to ' + param.key);\n    // }\n\n    clickTaxon(taxon: Taxon) {\n        this.props.selectTaxonRef(taxon.ref);\n    }\n\n    renderLineage() {\n        return (\n            <Lineage\n                taxonRef={this.props.targetTaxon.ref}\n                selectedTaxonRef={this.props.selectedTaxon.ref}\n                selectTaxonRef={this.props.selectTaxonRef}\n                navigateToTaxonRef={this.props.navigateToTaxonRef}\n            />\n        );\n        // return 'disabled';\n    }\n\n    renderChildrenCount(count: number) {\n        if (count === 0) {\n            return <div className=\"\">No children</div>;\n        }\n        if (count === 1) {\n            return <div>One child</div>;\n        }\n        return (\n            <div>\n                {Intl.NumberFormat('en-US', {\n                    useGrouping: true\n                }).format(count)}{' '}\n                children\n            </div>\n        );\n    }\n\n    renderChildren() {\n        let selectedRef: TaxonReference | null;\n        if (this.props.selectedTaxon) {\n            selectedRef = this.props.selectedTaxon.ref;\n        } else {\n            selectedRef = null;\n        }\n\n        return (\n            <TaxonChildren\n                taxonRef={this.props.targetTaxon.ref}\n                selectedTaxonRef={selectedRef}\n                selectTaxonRef={this.props.selectTaxonRef}\n                navigateToTaxonRef={this.props.navigateToTaxonRef}\n            />\n        );\n    }\n\n    // renderChildrenxscrolling() {\n    //     let selectedId;\n    //     if (this.props.selectedTaxon) {\n    //         selectedId = this.props.selectedTaxon.id;\n    //     } else {\n    //         selectedId = null;\n    //     }\n\n    //     return (\n    //         <div className=\"scrolling\">\n    //             <TaxonList\n    //                 taxa={this.props.offspring}\n    //                 selectedTaxonID={selectedId}\n    //                 selectTaxonID={this.props.selectTaxonID}\n    //                 navigateToTaxonID={this.props.navigateToTaxonID}\n    //                 totalItems={this.props.totalOffspring}\n    //                 maxItems={10}\n    //             />\n    //         </div>\n    //     );\n    // }\n\n    renderTargetTaxon() {\n        const isActive =\n            this.props.selectedTaxon &&\n            this.props.selectedTaxon.ref.id === this.props.targetTaxon.ref.id &&\n            this.props.selectedTaxon.ref.timestamp === this.props.targetTaxon.ref.timestamp;\n\n        return (\n            <TaxonItem\n                taxon={this.props.targetTaxon}\n                isActive={isActive}\n                selectTaxonRef={this.props.selectTaxonRef}\n                navigateToTaxonRef={this.props.navigateToTaxonRef}\n            />\n        );\n    }\n\n    render() {\n        return (\n            <div className=\"Col scrollable\" style={{ overflowY: 'auto' }}>\n                <div className=\"Col-auto Nav-box\">\n                    <div className=\"Nav-box-title\">Lineage</div>\n                    {this.renderLineage()}\n                </div>\n                <div className=\"Col-auto Nav-box Lineage-target-taxon\">{this.renderTargetTaxon()}</div>\n                <div className=\"Col-auto scrollable Nav-box\">{this.renderChildren()}</div>\n            </div>\n        );\n    }\n}\n","import React, { CSSProperties } from 'react';\nimport { Taxon } from '../../types/taxonomy';\n\nexport interface Props {\n    taxon: Taxon;\n}\n\nexport interface State { }\n\nexport default class TaxonSummary extends React.Component<Props, State> {\n    render() {\n        let nameStyle: CSSProperties = {};\n        if (this.props.taxon.rank === 'species') {\n            nameStyle = { fontStyle: 'italic' };\n        }\n        return (\n            <div className=\"InfoTable\">\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                        Name\n                    </div>\n                    <div className=\"InfoTable-dataCol\" style={nameStyle}>\n                        {this.props.taxon.name}\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                        Rank\n                    </div>\n                    <div className=\"InfoTable-dataCol\">{this.props.taxon.rank}</div>\n                </div>\n            </div>\n        );\n    }\n}\n","import React from 'react';\nimport { NCBITaxon, TaxonAlias } from '../../../types/taxonomy';\nimport { Table } from 'antd';\nimport geneticCodes from '../data/geneticCodes.json';\n\n// as Array<[number, string]>\n\ntype GeneticCodes = Array<[number, string]>;\n\nfunction ensureGeneticCodes(geneticCodes: any): GeneticCodes {\n    if (!(geneticCodes instanceof Array)) {\n        throw new Error('Invalid genetic codes file!');\n    }\n\n    return geneticCodes.map(([id, name]) => {\n        if (typeof id !== 'number') {\n            throw new Error('Invalid genetic code id in file');\n        }\n        if (typeof name !== 'string') {\n            throw new Error('Invalid genetic code label in file');\n        }\n        return [id, name];\n    });\n}\n\nconst gc = ensureGeneticCodes(geneticCodes);\n\nconst geneticCodesMap: Map<number, string> = gc.reduce((geneticCodesMap, [id, label]) => {\n    geneticCodesMap.set(id, label);\n    return geneticCodesMap;\n}, new Map<number, string>());\n\nexport interface TaxonDetailProps {\n    taxon: NCBITaxon;\n}\n\ninterface TaxonDetailState { }\n\nexport default class TaxonDetailNCBI extends React.Component<TaxonDetailProps, TaxonDetailState> {\n    renderAliases() {\n        const aliasNameSorter = (a: TaxonAlias, b: TaxonAlias) => {\n            return stringSorter(a.name, b.name);\n        };\n\n        const aliasCategorySorter = (a: TaxonAlias, b: TaxonAlias) => {\n            return stringSorter(a.category, b.category);\n        };\n\n        const stringSorter = (a: string, b: string) => {\n            const fixedA = a.replace(/^[\"']/, '');\n            const fixedB = b.replace(/^[\"']/, '');\n            return fixedA.localeCompare(fixedB);\n        };\n        return (\n            <Table\n                dataSource={this.props.taxon.aliases}\n                className=\"KBaseAntdOverride-remove-table-border\"\n                size=\"small\"\n                // pagination={{ position: 'top' }}\n                pagination={false}\n                scroll={{ y: '25em' }}\n                rowKey=\"name\"\n                bordered={false}\n            >\n                <Table.Column\n                    title=\"Name\"\n                    dataIndex=\"name\"\n                    key=\"name\"\n                    defaultSortOrder=\"ascend\"\n                    sorter={aliasNameSorter}\n                />\n                <Table.Column\n                    title=\"Category\"\n                    dataIndex=\"category\"\n                    key=\"category\"\n                    width=\"20em\"\n                    sorter={aliasCategorySorter}\n                />\n            </Table>\n        );\n    }\n\n    renderTaxonDetail() {\n        const width = '8em';\n        let nameStyle: React.CSSProperties = {};\n        if (this.props.taxon.rank === 'species') {\n            nameStyle.fontStyle = 'italic';\n        }\n        return (\n            <div className=\"InfoTable\">\n                <div className=\"InfoTable-row\" key=\"name\">\n                    <div className=\"InfoTable-labelCol\" style={{ width }}>\n                        Name\n                    </div>\n                    <div className=\"InfoTable-dataCol\" style={nameStyle}>\n                        {this.props.taxon.name}\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\" key=\"rank\">\n                    <div className=\"InfoTable-labelCol\" style={{ width }}>\n                        Rank\n                    </div>\n                    <div className=\"InfoTable-dataCol\">{this.props.taxon.rank}</div>\n                </div>\n                <div className=\"InfoTable-row\" key=\"ncbiid\">\n                    <div className=\"InfoTable-labelCol\" style={{ width }}>\n                        NCBI ID\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        <a\n                            href={`https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=${\n                                this.props.taxon.ncbiID\n                                }`}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            {this.props.taxon.ncbiID}\n                        </a>\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\" key=\"genetic-code\">\n                    <div className=\"InfoTable-labelCol\" style={{ width }}>\n                        Genetic Code\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        {this.props.taxon.geneticCode} -{' '}\n                        {geneticCodesMap.get(this.props.taxon.geneticCode) || 'Unknown'}\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\" key=\"aliases\">\n                    <div className=\"InfoTable-labelCol\" style={{ width }}>\n                        Aliases\n                    </div>\n                    <div className=\"InfoTable-dataCol\">{this.renderAliases()}</div>\n                </div>\n            </div>\n        );\n    }\n\n    render() {\n        return <div>{this.renderTaxonDetail()}</div>;\n    }\n}\n","import React from 'react';\nimport { Taxon, TaxonomyNamespace, NCBITaxon } from '../../../types/taxonomy';\nimport TaxonDetailNCBI from './TaxonDetailNCBI';\nimport { Alert } from 'antd';\n\nexport interface TaxonDetailProps {\n    taxon: Taxon;\n}\n\ninterface TaxonDetailState { }\n\nexport default class TaxonDetail extends React.Component<TaxonDetailProps, TaxonDetailState> {\n    render() {\n        const taxon = this.props.taxon;\n        switch (taxon.ref.namespace) {\n            case TaxonomyNamespace.NCBI:\n                // TODO: why does this not prove to TS that we have a NCBITaxon?\n                return <TaxonDetailNCBI taxon={taxon as NCBITaxon} />;\n            default:\n                return <Alert type=\"error\" message=\"This taxon type is not supported\" />;\n        }\n    }\n}\n","export function getProp<T>(obj: object, propPath: string | Array<string>, defaultValue: any): T {\n    if (typeof propPath === 'string') {\n        propPath = propPath.split('.');\n    } else if (!(propPath instanceof Array)) {\n        throw new TypeError('Invalid type for key: ' + typeof propPath);\n    }\n    let temp: any = obj;\n    for (let i = 0; i < propPath.length; i += 1) {\n        if (temp === undefined || typeof temp !== 'object' || temp === null) {\n            return defaultValue;\n        }\n        temp = temp[propPath[i]];\n    }\n    if (temp === undefined) {\n        return defaultValue;\n    }\n    return temp;\n}\n\nexport function hasProp(obj: object, propPath: string | Array<string>): boolean {\n    if (typeof propPath === 'string') {\n        propPath = propPath.split('.');\n    } else if (!(propPath instanceof Array)) {\n        throw new TypeError('Invalid type for key: ' + typeof propPath);\n    }\n    let temp: any = obj;\n    for (let i = 0; i < propPath.length; i += 1) {\n        if (temp === undefined || typeof temp !== 'object' || temp === null) {\n            return false;\n        }\n        temp = temp[propPath[i]];\n    }\n    if (temp === undefined) {\n        return false;\n    }\n    return true;\n}\n\nexport function setProp(obj: object, propPath: string | Array<string>, value: any) {\n    if (typeof propPath === 'string') {\n        propPath = propPath.split('.');\n    } else if (!(propPath instanceof Array)) {\n        throw new TypeError('Invalid type for key: ' + typeof propPath);\n    }\n    if (propPath.length === 0) {\n        return;\n    }\n    // pop off the last property for setting at the end.\n    const propKey = propPath[propPath.length - 1];\n    let key;\n    // Walk the path, creating empty objects if need be.\n    let temp: any = obj;\n    for (let i = 0; i < propPath.length - 1; i += 1) {\n        key = propPath[i];\n        if (temp[key] === undefined) {\n            temp[key] = {};\n        }\n        obj = temp[key];\n    }\n    // Finally set the property.\n    temp[propKey] = value;\n    return value;\n}\n\nexport function incrProp(obj: object, propPath: string | Array<string>, increment: number): number | undefined {\n    if (typeof propPath === 'string') {\n        propPath = propPath.split('.');\n    } else if (!(propPath instanceof Array)) {\n        throw new TypeError('Invalid type for key: ' + typeof propPath);\n    }\n    if (propPath.length === 0) {\n        return;\n    }\n    increment = increment === undefined ? 1 : increment;\n    const propKey = propPath[propPath.length - 1];\n    let temp: any = obj;\n    for (let i = 0; i < propPath.length - 1; i += 1) {\n        const key = propPath[i];\n        if (temp[key] === undefined) {\n            temp[key] = {};\n        }\n        temp = temp[key];\n    }\n    if (temp[propKey] === undefined) {\n        temp[propKey] = increment;\n    } else {\n        if (typeof temp[propKey] === 'number') {\n            temp[propKey] += increment;\n        } else {\n            throw new Error('Can only increment a number');\n        }\n    }\n    return temp[propKey];\n}\n\nexport function deleteProp(obj: object, propPath: string | Array<string>) {\n    if (typeof propPath === 'string') {\n        propPath = propPath.split('.');\n    } else if (!(propPath instanceof Array)) {\n        throw new TypeError('Invalid type for key: ' + typeof propPath);\n    }\n    if (propPath.length === 0) {\n        return false;\n    }\n    const propKey = propPath[propPath.length - 1];\n    let temp: any = obj;\n    for (let i = 0; i < propPath.length - 1; i += 1) {\n        const key = propPath[i];\n        if (temp[key] === undefined) {\n            // for idempotency, and utility, do not throw error if\n            // the key doesn't exist.\n            return false;\n        }\n        obj = temp[key];\n    }\n    if (temp[propKey] === undefined) {\n        return false;\n    }\n    delete temp[propKey];\n    return true;\n}\n\n// class Props {\n//     constructor(config = {}) {\n//         this.obj = config.data || {};\n//     }\n\n//     getItem(props, defaultValue) {\n//         return getProp(this.obj, props, defaultValue);\n//     }\n\n//     hasItem(propPath) {\n//         return hasProp(this.obj, propPath);\n\n//     }\n\n//     setItem(path, value) {\n//         return setProp(this.obj, path, value);\n//     }\n\n//     incrItem(path, increment) {\n//         return incrProp(this.obj, path, increment);\n//     }\n\n//     deleteItem(path) {\n//         return deleteProp(this.obj, path);\n//     }\n\n//     getRaw() {\n//         return this.obj;\n//     }\n// }\n\n// return Object.freeze({ Props, getProp, hasProp, setProp, incrProp, deleteProp });\n","import React from 'react';\n\nimport WikipediaClient, { WikipediaInfo } from '../landingPages/taxonomy/lib/Wikipedia';\nimport marked from 'marked';\nimport { Icon, Alert, Tooltip } from 'antd';\nimport Loading from './Loading';\nimport './Wikipedia.css';\n\nexport interface WikipediaProps {\n    term: string;\n}\n\nenum AsyncComponentLoadingState {\n    NONE,\n    LOADING,\n    LOADED,\n    ERROR\n}\n\ninterface StateNone {\n    state: AsyncComponentLoadingState.NONE;\n}\n\ninterface StateLoading {\n    state: AsyncComponentLoadingState.LOADING;\n}\n\ninterface StateLoaded {\n    state: AsyncComponentLoadingState.LOADED;\n    wikipediaInfo: WikipediaInfo;\n}\n\ninterface StateError {\n    state: AsyncComponentLoadingState.ERROR;\n    error: string;\n}\n\ntype WikipediaState = StateNone | StateLoading | StateLoaded | StateError;\n\nexport default class Wikipedia extends React.Component<WikipediaProps, WikipediaState> {\n    wikipediaClient: WikipediaClient;\n    canceled: boolean;\n    constructor(props: WikipediaProps) {\n        super(props);\n        this.wikipediaClient = new WikipediaClient();\n        this.canceled = false;\n        this.state = {\n            state: AsyncComponentLoadingState.NONE\n        };\n    }\n\n    componentWillUnmount() {\n        this.canceled = true;\n        // this.state = {\n        //     state: AsyncComponentLoadingState.CANCELED\n        // };\n    }\n\n    renderArticle(wikipediaInfo: WikipediaInfo) {\n        const content = marked(wikipediaInfo.introText);\n        return <div style={{ overflow: 'auto' }} dangerouslySetInnerHTML={{ __html: content }} />;\n    }\n\n    renderImage(wikipediaInfo: WikipediaInfo) {\n        if (!wikipediaInfo.imageUrl) {\n            return (\n                <div className=\"Wikipedia-empty-image\">\n                    <div className=\"-content\">Image not found</div>\n                </div>\n            );\n        }\n        return (\n            <div>\n                <img src={wikipediaInfo.imageUrl} style={{ width: '100%' }} alt={`${this.props.term}`} />\n            </div>\n        );\n    }\n\n    renderMatch(wikipediaInfo: WikipediaInfo) {\n        if (wikipediaInfo.exactMatch) {\n            const message = (\n                <React.Fragment>\n                    <Icon type=\"check\" style={{ color: 'green' }} /> Exact match on \"\n                    {wikipediaInfo.matchingTerms.join(' ')}\"\n                </React.Fragment>\n            );\n            return <Alert type=\"success\" message={message} />;\n        } else {\n            const message = (\n                <React.Fragment>\n                    <Icon type=\"warning\" style={{ color: 'orange' }} /> Inexact match on: \"\n                    {wikipediaInfo.matchingTerms.join(' ')}\"\n                </React.Fragment>\n            );\n            return <Alert type=\"warning\" message={message} />;\n        }\n    }\n\n    renderWikipediaLogoCredit() {\n        return (\n            <div>\n                <div style={{ borderBottom: '1px solid gray' }}>Link to the original Wikipedia entry</div>\n                <div style={{ fontSize: '80%' }}>\n                    <p style={{ textAlign: 'center' }}>\n                        credit:\n                        <a\n                            href=\"https://creativecommons.org/licenses/by-sa/3.0/\"\n                            title=\"Creative Commons Attribution-ShareAlike 3.0\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            CC BY-SA 3.0\n                        </a>\n                        <a\n                            href=\"https://en.wikipedia.org/w/index.php?curid=33285413\"\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                        >\n                            Link\n                        </a>\n                    </p>\n                </div>\n            </div>\n        );\n    }\n\n    renderWikipediaInfo(wikipediaInfo: WikipediaInfo) {\n        return (\n            <div className=\"Row scrollable\">\n                <div className=\"Col Col-grow-2 scrollable\">\n                    <div style={{ display: 'flex', flexDirection: 'row', marginBottom: '10px' }}>\n                        <div style={{ flex: '1 1 0px' }}>{this.renderMatch(wikipediaInfo)}</div>\n                        <div style={{ flex: '0 0 auto', alignSelf: 'center', marginLeft: '10px' }}>\n                            <div style={{ height: '32px', textAlign: 'center' }}>\n                                <Tooltip title={this.renderWikipediaLogoCredit()}>\n                                    <a href={wikipediaInfo.pageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                                        <img\n                                            src=\"images/wikipedia-logo.svg\"\n                                            style={{ height: '100%' }}\n                                            alt=\"Wikipedia Logo\"\n                                        />\n                                    </a>\n                                </Tooltip>\n                            </div>\n                            <div />\n                        </div>\n                    </div>\n                    <div\n                        className=\"scrollable\"\n                        style={{ flex: '2 1 0px', paddingRight: '4px', marginRight: '4px', overflowY: 'auto' }}\n                    >\n                        {this.renderArticle(wikipediaInfo)}\n                    </div>\n                </div>\n\n                <div className=\"Col Col-grow-1\" style={{ flex: '1 1 0px', marginLeft: '10px' }}>\n                    {this.renderImage(wikipediaInfo)}\n                </div>\n            </div>\n        );\n    }\n\n    updateInfo() {\n        const wikipediaClient = new WikipediaClient();\n        const { term } = this.props;\n        this.setState({\n            state: AsyncComponentLoadingState.LOADING\n        });\n        wikipediaClient\n            .findTerm(term)\n            .then((wikipediaInfo) => {\n                if (this.canceled) {\n                    return;\n                }\n                this.setState({\n                    state: AsyncComponentLoadingState.LOADED,\n                    wikipediaInfo\n                });\n            })\n            .catch((err) => {\n                if (this.canceled) {\n                    return;\n                }\n                return this.setState({\n                    state: AsyncComponentLoadingState.ERROR,\n                    error: err.message\n                });\n            });\n    }\n\n    componentDidMount() {\n        this.updateInfo();\n    }\n\n    componentDidUpdate(props: WikipediaProps, state: WikipediaState) {\n        if (props.term !== this.props.term) {\n            this.updateInfo();\n        }\n    }\n\n    renderNone() {\n        return <div />;\n    }\n\n    renderLoading() {\n        return <Loading message=\"Searching Wikipedia...\" />;\n    }\n\n    renderLoaded(state: StateLoaded) {\n        return this.renderWikipediaInfo(state.wikipediaInfo);\n    }\n\n    renderError(state: StateError) {\n        return <Alert type=\"error\" message={state.error} />;\n    }\n\n    render() {\n        if (this.canceled) {\n            return;\n        }\n        switch (this.state.state) {\n            case AsyncComponentLoadingState.NONE:\n                return this.renderNone();\n            case AsyncComponentLoadingState.LOADING:\n                return this.renderLoading();\n            case AsyncComponentLoadingState.LOADED:\n                return this.renderLoaded(this.state);\n            case AsyncComponentLoadingState.ERROR:\n                return this.renderError(this.state);\n        }\n    }\n}\n","import * as props from './props';\n\nexport interface WikipediaInfo {\n    imageUrl: string;\n    pageUrl: string;\n    introText: string;\n    title: string;\n    pageId: number;\n    exactMatch: boolean;\n    matchingTerms: Array<string>;\n}\n\ninterface WikipediaParse {\n    headhtml: Map<string, string>;\n    pageid: number;\n    redirects: Array<string>;\n    text: Map<string, string>;\n    title: string;\n}\n\nclass NotFound extends Error {\n    constructor(message: string) {\n        super(message);\n\n        this.name = 'NotFound';\n    }\n}\n\nconst WIKIPEDIA_API_URL = 'https://en.wikipedia.org/w/api.php';\nconst IMAGE_SIZE = 500;\n\nexport default class Wikipedia {\n    scrubTerm(proposedTerm: string): string {\n        // convervatively, remove all non-alpha characters\n        const chars = proposedTerm.split('');\n        const validChar = /[\\w \\s]/;\n        const newChars = chars.filter((char) => {\n            if (validChar.exec(char)) {\n                return true;\n            }\n            return false;\n        });\n        return newChars.join('');\n    }\n\n    async findTerm(term: string): Promise<WikipediaInfo> {\n        if (!term) {\n            throw new Error('Empty term passed');\n        }\n        const lookupTerm = this.scrubTerm(term);\n        return this.getWikipediaInfo(lookupTerm).then(\n            ({ imageUrl, pageUrl, introText, title, pageId, matchingTerms, exactMatch }) => {\n                // this.imageUrl(imageUrl);\n                // this.pageUrl(url);\n                const fixedIntroText = introText\n                    .replace(/====/g, '####')\n                    .replace(/===/g, '###')\n                    .replace(/==/g, '##')\n                    .replace(/\\n/g, '  \\n');\n\n                return { imageUrl, pageUrl, introText: fixedIntroText, title, pageId, matchingTerms, exactMatch };\n            }\n        );\n    }\n\n    async getWikipediaInfo(term: string): Promise<WikipediaInfo> {\n        return this.getPage(term).then(\n            ({\n                wikiResponse,\n                matchingTerms,\n                exactMatch\n            }: {\n                wikiResponse: any;\n                matchingTerms: Array<string>;\n                exactMatch: boolean;\n            }) => {\n                // this.imageCaption(wikiResponse.parse.title);\n                return Promise.all([\n                    this.getImage({ size: IMAGE_SIZE, pageId: wikiResponse.parse.pageid }),\n                    this.getPageInfo({ pageId: wikiResponse.parse.pageid })\n                ]).then(([imageUrl, pageInfo]) => {\n                    return {\n                        imageUrl: imageUrl,\n                        pageUrl: pageInfo.url,\n                        introText: pageInfo.introText,\n                        title: wikiResponse.parse.title,\n                        pageId: wikiResponse.parse.pageid,\n                        matchingTerms,\n                        exactMatch\n                    };\n                });\n            }\n        );\n    }\n\n    // see: https://www.mediawiki.org/wiki/API:Main_page\n    // https://en.wikipedia.org/w/api.php?action=help&modules=parse\n    async getPage(term: string): Promise<{ wikiResponse: any; matchingTerms: Array<string>; exactMatch: boolean }> {\n        const terms = term.split(/\\s+/);\n        let matchingTerms: Array<string>;\n        let exactMatch = true;\n        return new Promise((resolve, reject) => {\n            const fetchPage = (terms: Array<string>) => {\n                if (terms.length === 0) {\n                    reject(new NotFound('No Wikipedia page found matching \"' + term + '\"'));\n                    // resolve(null);\n                }\n                // const http = new HttpClient.HttpClient();\n                // const header = new HttpClient.HttpHeader({\n                //     accept: 'application/json'\n                // });\n                const apiUrl = new URL(WIKIPEDIA_API_URL);\n                const query = apiUrl.searchParams;\n                query.set('action', 'parse');\n                query.set('format', 'json');\n                query.set('prop', 'text|headhtml');\n                query.set('section', '0');\n                query.set('redirects', '');\n                query.set('page', terms.join(' '));\n                const headers = {\n                    accept: 'application/json'\n                };\n                // must set this to enable cors\n                query.set('origin', '*');\n                fetch(apiUrl.toString(), {\n                    method: 'GET',\n                    headers\n                })\n                    .then((result) => {\n                        switch (result.status) {\n                            case 200:\n                                try {\n                                    return result.json().then((wikiResponse) => {\n                                        if (wikiResponse.error) {\n                                            if (wikiResponse.error.code === 'missingtitle') {\n                                                terms.pop();\n                                                exactMatch = false;\n                                                fetchPage(terms);\n                                                return null;\n                                            } else {\n                                                console.error('wikipedia api error', wikiResponse);\n                                                reject(new Error('Wikipedia api error: ' + wikiResponse.error.code));\n                                            }\n                                        } else {\n                                            matchingTerms = terms;\n                                            resolve({\n                                                wikiResponse,\n                                                matchingTerms,\n                                                exactMatch\n                                            });\n                                        }\n                                    });\n                                } catch (ex) {\n                                    reject(new Error('Error parsing wikipedia response: ' + ex.message));\n                                }\n                                break;\n                            default:\n                                const message = 'Unexpected response from wikipedia api: ' + result.status;\n                                console.error(message, result);\n                                reject(new Error(message));\n                        }\n                    })\n                    .catch((err) => {\n                        reject(err);\n                    });\n            };\n            fetchPage(terms);\n        });\n    }\n\n    async getPageInfo({ pageId }: { pageId: string }): Promise<any> {\n        const apiURL = new URL(WIKIPEDIA_API_URL);\n        const query = apiURL.searchParams;\n        query.set('action', 'query');\n        query.set('pageids', pageId);\n        query.set('prop', 'info|extracts');\n        query.set('explaintext', 'true');\n        query.set('inprop', 'url');\n        query.set('origin', '*');\n        query.set('format', 'json');\n\n        // const http = new HttpClient.HttpClient();\n        return fetch(apiURL.toString(), {\n            method: 'GET'\n        }).then((result) => {\n            switch (result.status) {\n                case 200:\n                    try {\n                        return result.json().then((wikiResponse) => {\n                            return {\n                                url: props.getProp<string>(\n                                    wikiResponse,\n                                    ['query', 'pages', String(pageId), 'fullurl'],\n                                    null\n                                ),\n                                introText: props.getProp<string>(\n                                    wikiResponse,\n                                    ['query', 'pages', String(pageId), 'extract'],\n                                    null\n                                )\n                            };\n                        });\n                    } catch (ex) {\n                        console.error('error getting page info', ex.message);\n                        throw ex;\n                    }\n                default:\n                    var message = 'Unexpected response from wikipedia api: ' + result.status;\n                    console.error(message, result);\n                    throw new Error(message);\n            }\n        });\n    }\n\n    async getImage({ size, pageId }: { size: number; pageId: number }): Promise<string> {\n        const apiURL = new URL(WIKIPEDIA_API_URL);\n        const query = apiURL.searchParams;\n        query.set('action', 'query');\n        query.set('format', 'json');\n        query.set('prop', 'pageimages');\n        query.set('pithumbsize', String(size));\n        query.set('pageids', String(pageId));\n        query.set('origin', '*');\n        const headers = {\n            accept: 'application/json'\n        };\n\n        return fetch(apiURL.toString(), {\n            method: 'GET',\n            headers\n        })\n            .then((result) => {\n                switch (result.status) {\n                    case 200:\n                        try {\n                            return result.json().then((wikiResponse) => {\n                                return props.getProp<string>(\n                                    wikiResponse,\n                                    ['query', 'pages', String(pageId), 'thumbnail', 'source'],\n                                    null\n                                );\n                            });\n                        } catch (ex) {\n                            throw new Error('Error parsing wikipedia response: ' + ex.message);\n                        }\n                    default:\n                        var message = 'Unexpected response from wikipedia api: ' + result.status;\n                        console.error(message, result);\n                        throw new Error(message);\n                }\n            })\n            .catch((err) => {\n                const message = 'Error getting image from wikipedia: ' + err.message;\n                console.error(message, err);\n                throw new Error('Error getting image from wikipedia: ' + err.message);\n            });\n    }\n}\n","import React from 'react';\nimport { Spin } from 'antd';\nimport './Loading.css';\n\nexport interface Props {\n    message: string;\n}\n\ninterface State {}\n\nexport default class Loading extends React.Component<Props, State> {\n    render() {\n        return (\n            <div className=\"Loading-box\">\n                <Spin size=\"large\" />\n                <br />\n                {this.props.message}\n            </div>\n        );\n    }\n}\n","// import { UIError } from \"../types\";\n\nexport interface DBProps<T> {\n    onUpdate: () => void;\n    initialData: T;\n}\n\nexport interface TheDB<T> {\n    data: T;\n}\n\nexport enum DBCollectionStatus {\n    NONE,\n    LOADING,\n    LOADED,\n    ERROR,\n    RELOADING\n}\n\nexport interface DBCollectionBase {\n    status: DBCollectionStatus\n}\n\nexport interface DBCollectionNone extends DBCollectionBase {\n    status: DBCollectionStatus.NONE\n}\n\nexport interface DBCollectionLoading<T> extends DBCollectionBase {\n    status: DBCollectionStatus.LOADING,\n    data: T\n}\n\nexport interface DBCollectionLoaded<T> extends DBCollectionBase {\n    status: DBCollectionStatus.LOADED,\n    data: T\n}\n\nexport interface DBCollectionReloading<T> extends DBCollectionBase {\n    status: DBCollectionStatus.RELOADING,\n    data: T\n}\n\nexport interface DBCollectionError<T> extends DBCollectionBase {\n    status: DBCollectionStatus.ERROR,\n    error: T\n}\n\nexport default class DB<T> {\n    db: TheDB<T>;\n    stopped: boolean;\n    onUpdate: () => void;\n    constructor(props: DBProps<T>) {\n        this.onUpdate = props.onUpdate;\n        this.db = {\n            data: props.initialData\n        };\n        this.stopped = false;\n    }\n\n    forceComponentUpdate() {\n        if (this.stopped) {\n            return;\n        }\n        this.onUpdate();\n    }\n\n    set(updateFun: (state: T) => T) {\n        this.db.data = updateFun(this.db.data);\n        this.forceComponentUpdate();\n    }\n\n    get(): T {\n        return this.db.data;\n    }\n\n    stop() {\n        this.stopped = true;\n    }\n}\n","import React from 'react';\nimport { Taxon } from '../../../types/taxonomy';\nimport Wikipedia from '../../../components/Wikipedia';\n\nexport interface TaxonDescriptionProps {\n    taxon: Taxon;\n}\n\ninterface TaxonDescriptionState { }\n\nexport default class TaxonDescription extends React.Component<TaxonDescriptionProps, TaxonDescriptionState> {\n    renderTaxonDescription() {\n        return <Wikipedia term={this.props.taxon.name} />;\n    }\n\n    /**\n     * Intercept nodes which don't have a widely known biological association with\n     * the node name (\"scientific name\"), and for which a wikipedia lookup would not\n     * be very useful.\n     */\n    notBiological() {\n        switch (this.props.taxon.name) {\n            case 'root':\n                return (\n                    <div>\n                        <p>This taxon is the topmost node in the NCBI Taxonomy tree.</p>\n                    </div>\n                );\n            case 'cellular organisms':\n                return (\n                    <div>\n                        <p>This taxon represents all cellular organisms.</p>\n                    </div>\n                );\n            default:\n                return (\n                    <div>\n                        <p>Unknown non-biological taxon.</p>\n                    </div>\n                );\n        }\n    }\n\n    render() {\n        if (this.props.taxon.isBiological) {\n            return <div className=\"Col scrollable\">{this.renderTaxonDescription()}</div>;\n        }\n        return this.notBiological();\n    }\n}\n","import DB, { DBProps, DBCollectionNone, DBCollectionLoading, DBCollectionLoaded, DBCollectionReloading, DBCollectionError, DBCollectionStatus } from '../../../../lib/DB2';\nimport { AppConfig } from '@kbase/ui-components';\nimport { TaxonomyModel, LinkedObject, GetLinkedObjectsResult } from '../../lib/model';\nimport { TaxonReference } from '../../../../types/taxonomy';\nimport { UIError } from '../../../../types';\n\nexport interface LinkedObjectsData {\n    linkedObjects: Array<LinkedObject>;\n    totalCount: number;\n    page: number;\n    pageSize: number;\n}\n\nexport type LinkedObjectsStateNone = DBCollectionNone;\nexport type LinkedObjectsStateLoading = DBCollectionLoading<LinkedObjectsData>;\nexport type LinkedObjectsStateLoaded = DBCollectionLoaded<LinkedObjectsData>;\nexport type LinkedObjectsStateReloading = DBCollectionReloading<LinkedObjectsData>;\nexport type LinkedObjectsStateError = DBCollectionError<UIError>;\n\nexport type LinkedObjectsCollection =\n    LinkedObjectsStateNone |\n    LinkedObjectsStateLoading |\n    LinkedObjectsStateLoaded |\n    LinkedObjectsStateReloading |\n    LinkedObjectsStateError;\n\n// export type LinkedDataDBStateNone = DBStateNone;\n// export type LinkedDataDBStateLoading = DBStateLoading;\n// export type LinkedDataDBStateError = DBStateError;\n\n// export interface LinkedDataDBStateLoaded extends DBStateLoaded {\n//     linkedObjects: Array<LinkedObject>;\n\n// }\n\n// export type LinkedDataDBState =\n//     | LinkedDataDBStateNone\n//     | LinkedDataDBStateLoading\n//     | LinkedDataDBStateLoaded\n//     | LinkedDataDBStateError;\n\n\nexport enum SortDirection {\n    ASCENDING,\n    DESCENDING\n}\n\nexport function stringToSortDirection(direction: string) {\n    switch (direction) {\n        case 'ascending':\n            return SortDirection.ASCENDING;\n        case 'descending':\n            return SortDirection.DESCENDING;\n        default:\n            throw new Error('Unknown sort direction: ' + direction);\n    }\n}\n\nexport interface SortSpec {\n    sortColumn: string;\n    sortDirection: SortDirection;\n}\n\nexport interface LinkedObjectsDBState {\n    linkedObjectsCollection: LinkedObjectsCollection\n}\n\nexport interface LinkedDataDBProps extends DBProps<LinkedObjectsDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport class AsyncTask<T> {\n    taskFun: () => Promise<T>;\n    hasResult: boolean;\n    result: T | null;\n    canceled: boolean;\n    constructor(taskFun: () => Promise<T>) {\n        this.taskFun = taskFun;\n        this.result = null;\n        this.hasResult = false;\n        this.canceled = false;\n    }\n\n    async run() {\n        try {\n            this.result = await this.taskFun();\n            return this.result;\n        } catch (ex) {\n            throw (ex);\n        }\n    }\n\n    cancel() {\n        this.canceled = true;\n    }\n\n    get(): T {\n        if (this.result === null) {\n            throw new Error('Attempt to fetch value when not set');\n        }\n        return this.result;\n    }\n\n    isCanceled(): boolean {\n        return this.canceled;\n    }\n}\n\nexport default class LinkedDataDB extends DB<LinkedObjectsDBState> {\n    token: string;\n    serviceWizardURL: string;\n    currentTask: AsyncTask<GetLinkedObjectsResult> | null;\n    constructor(props: LinkedDataDBProps) {\n        super(props);\n        this.token = props.token;\n        this.serviceWizardURL = props.config.services.ServiceWizard.url;\n        this.currentTask = null;\n    }\n\n    async fetchLinkedObjects({ taxonRef, page, pageSize }: { taxonRef: TaxonReference; page: number; pageSize: number }) {\n        if (this.currentTask) {\n            this.currentTask.cancel();\n        }\n        const task = async (): Promise<GetLinkedObjectsResult> => {\n            const client = new TaxonomyModel({\n                token: this.token,\n                url: this.serviceWizardURL\n            });\n\n            const offset = (page - 1) * pageSize;\n            const limit = pageSize;\n\n            const result = await client.getLinkedObjects(taxonRef, {\n                offset,\n                limit\n            });\n\n            return result;\n        };\n\n        // Set up loading based on the current state.\n\n        this.set((state: LinkedObjectsDBState) => {\n            switch (state.linkedObjectsCollection.status) {\n                case DBCollectionStatus.LOADING:\n                case DBCollectionStatus.LOADED:\n                case DBCollectionStatus.RELOADING:\n                    return {\n                        ...state,\n                        linkedObjectsCollection: {\n                            ...state.linkedObjectsCollection,\n                            status: DBCollectionStatus.LOADING\n                        }\n                    };\n                case DBCollectionStatus.NONE:\n                case DBCollectionStatus.ERROR:\n                default:\n                    return {\n                        ...state,\n                        linkedObjectsCollection: {\n                            status: DBCollectionStatus.LOADING,\n                            data: {\n                                linkedObjects: [],\n                                page, pageSize,\n                                totalCount: 0\n                            }\n                        }\n                    };\n            }\n        });\n\n        const newTask = new AsyncTask<GetLinkedObjectsResult>(task);\n        this.currentTask = newTask;\n\n        try {\n            const result = await newTask.run();\n            if (newTask.isCanceled()) {\n                return;\n            }\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    linkedObjectsCollection: {\n                        status: DBCollectionStatus.LOADED,\n                        data: {\n                            ...result,\n                            page,\n                            pageSize\n                        }\n                    }\n                };\n            });\n            this.currentTask = null;\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    linkedObjectsCollection: {\n                        status: DBCollectionStatus.ERROR,\n                        error: {\n                            code: 'not-found',\n                            message: ex.message,\n                            source: 'LinkedDataDB.fetchLinkedObjects'\n                        }\n                    }\n                };\n            });\n        }\n    }\n\n    async queryLinkedObjects({ taxonRef, page, pageSize, sort }: { taxonRef: TaxonReference; page: number; pageSize: number, sort: SortSpec | null }) {\n        if (this.currentTask) {\n            this.currentTask.cancel();\n        }\n        const task = async (): Promise<GetLinkedObjectsResult> => {\n            const client = new TaxonomyModel({\n                token: this.token,\n                url: this.serviceWizardURL\n            });\n\n            const offset = (page - 1) * pageSize;\n            const limit = pageSize;\n\n            const result = await client.getLinkedObjects(taxonRef, {\n                offset,\n                limit\n            });\n\n            return result;\n        };\n\n        // Set up loading based on the current state.\n\n        this.set((state: LinkedObjectsDBState) => {\n            switch (state.linkedObjectsCollection.status) {\n                case DBCollectionStatus.LOADING:\n                case DBCollectionStatus.LOADED:\n                case DBCollectionStatus.RELOADING:\n                    return {\n                        ...state,\n                        linkedObjectsCollection: {\n                            ...state.linkedObjectsCollection,\n                            status: DBCollectionStatus.LOADING\n                        }\n                    };\n                case DBCollectionStatus.NONE:\n                case DBCollectionStatus.ERROR:\n                default:\n                    return {\n                        ...state,\n                        linkedObjectsCollection: {\n                            status: DBCollectionStatus.LOADING,\n                            data: {\n                                linkedObjects: [],\n                                page, pageSize,\n                                totalCount: 0\n                            }\n                        }\n                    };\n            }\n        });\n\n        const newTask = new AsyncTask<GetLinkedObjectsResult>(task);\n        this.currentTask = newTask;\n\n        try {\n            const result = await newTask.run();\n            if (newTask.isCanceled()) {\n                return;\n            }\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    linkedObjectsCollection: {\n                        status: DBCollectionStatus.LOADED,\n                        data: {\n                            ...result,\n                            page,\n                            pageSize\n                        }\n                    }\n                };\n            });\n            this.currentTask = null;\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    linkedObjectsCollection: {\n                        status: DBCollectionStatus.ERROR,\n                        error: {\n                            code: 'not-found',\n                            message: ex.message,\n                            source: 'LinkedDataDB.fetchLinkedObjects'\n                        }\n                    }\n                };\n            });\n        }\n    }\n}\n","import React from 'react';\nimport { LinkedObject, WorkspaceType } from '../../lib/model';\nimport { Table, Tooltip, Spin, Alert } from 'antd';\nimport Column from 'antd/lib/table/Column';\nimport { LinkedObjectsCollection, LinkedObjectsData } from './LinkedDataDB';\nimport { DBCollectionStatus } from '../../../../lib/DB2';\nimport { UIError } from '../../../../types';\nimport { SorterResult, PaginationConfig } from 'antd/lib/table';\nimport { SortSpec, stringToSortDirection } from './LinkedDataDB';\n\nconst DEFAULT_PAGE_SIZE = 12;\n\nexport interface Props {\n    linkedObjectsCollection: LinkedObjectsCollection\n    setPage: (page: number, pageSize: number) => void\n    updateView: (page: number, pageSize: number, sort: SortSpec | null) => void\n}\n\ninterface State { }\n\nexport default class LinkedData extends React.Component<Props, State> {\n    onChangePage(page: number, pageSize?: number) {\n        this.props.setPage(page, pageSize || DEFAULT_PAGE_SIZE);\n    }\n\n    onChangeTable(pagination: PaginationConfig, filters: Record<string, string[]>, sorter: SorterResult<LinkedObject>) {\n        let sort: SortSpec | null;\n        if (sorter.column && sorter.column.dataIndex) {\n            const sortColumn = sorter.column.dataIndex;\n            const sortDirection = stringToSortDirection(sorter.order === 'descend' ? 'descending' : 'ascending');\n            sort = {\n                sortColumn, sortDirection\n            };\n        } else {\n            sort = null;\n        }\n\n        this.props.updateView(pagination.current || 1, pagination.pageSize || DEFAULT_PAGE_SIZE, sort);\n    }\n\n    componentDidMount() {\n        this.props.setPage(1, DEFAULT_PAGE_SIZE);\n    }\n\n    componentDidUpdate(previousProps: Props) {\n        switch (previousProps.linkedObjectsCollection.status) {\n            case DBCollectionStatus.NONE:\n            case DBCollectionStatus.LOADING:\n            case DBCollectionStatus.LOADED:\n            case DBCollectionStatus.ERROR:\n            case DBCollectionStatus.RELOADING:\n        }\n    }\n\n    renderLinkedObjects(data: LinkedObjectsData, isLoading: boolean) {\n        return <Table<LinkedObject>\n            dataSource={data.linkedObjects}\n            size=\"small\"\n            className=\"KBaseAntdOverride-remove-table-border ScrollingFlexTable\"\n            // pagination={false}\n            // scroll={{ y: '100%' }}\n            bordered={false}\n            rowKey={(linkedObject: LinkedObject) => {\n                return [linkedObject.workspaceID, linkedObject.objectID, linkedObject.version].join('/');\n            }}\n            pagination={{\n                position: 'top',\n                // onChange: this.onChangePage.bind(this),\n                defaultPageSize: DEFAULT_PAGE_SIZE,\n                total: data.totalCount\n            }}\n            loading={isLoading}\n            onChange={this.onChangeTable.bind(this)}\n        >\n            <Column\n                title=\"Type\"\n                dataIndex=\"type\"\n                width=\"10%\"\n                render={(type: WorkspaceType) => {\n                    const typeID = [[type.module, type.name].join('.'), [type.majorVersion, type.minorVersion].join('.')].join('-');\n                    return <a href={`/#spec/type/${typeID}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                        {type.name}\n                    </a>\n                }}\n            />\n            <Column\n                title=\"Object\"\n                dataIndex=\"objectName\"\n                width=\"35%\"\n                // sorter={(a: LinkedObject, b: LinkedObject) => {\n                //     return a.objectName.localeCompare(b.objectName);\n                // }}\n                sorter={true}\n                render={(objectName: string, linkedObject: LinkedObject) => {\n                    const url = [\n                        '',\n                        '#dataview',\n                        linkedObject.workspaceID,\n                        linkedObject.objectID,\n                        linkedObject.version\n                    ].join('/');\n                    const headerStyle = {\n                        fontStyle: 'italic',\n                        marginRight: '3px'\n                    }\n                    const tooltip = (\n                        <div>\n                            <div>\n                                <span style={headerStyle}>\n                                    Ref\n                                </span>\n                                <span>\n                                    {linkedObject.workspaceID}/{linkedObject.objectID}/{linkedObject.version}\n                                </span>\n                            </div>\n                            <div>\n                                <span style={headerStyle}>\n                                    Workspace ID\n                                </span>\n                                <span>\n                                    {linkedObject.workspaceID}\n                                </span>\n                            </div>\n                            <div>\n                                <span style={headerStyle}>\n                                    Object ID\n                                </span>\n                                <span>\n                                    {linkedObject.objectID}\n                                </span>\n                            </div>\n                            <div>\n                                <span style={headerStyle}>\n                                    Version\n                                </span>\n                                <span>\n                                    {linkedObject.version}\n                                </span>\n                            </div>\n                        </div>\n                    )\n                    return (\n                        <Tooltip title={tooltip}>\n                            <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n                                {objectName}\n                            </a>\n                        </Tooltip>\n                    )\n                }}\n            />\n            <Column\n                title=\"Narrative\"\n                width=\"35%\"\n                dataIndex=\"workspaceID\"\n                render={(workspaceID: number) => {\n                    return <a href={`/narrative/${workspaceID}`} target=\"_blank\" rel=\"noopener noreferrer\">\n                        Narrative or refdata ws title\n                    </a>\n                }}\n            />\n            <Column\n                title=\"Object Created\"\n                dataIndex=\"createdAt\"\n                width=\"10%\"\n                // sorter={(a: LinkedObject, b: LinkedObject) => {\n                //     return a.createdAt - b.createdAt;\n                // }}\n                sorter={true}\n                render={(createdAt: number) => {\n                    return Intl.DateTimeFormat('en-US').format(createdAt);\n                }}\n            />\n            <Column\n                title=\"Linked At\"\n                dataIndex=\"linkedAt\"\n                width=\"10%\"\n                // sorter={(a: LinkedObject, b: LinkedObject) => {\n                //     return a.linkedAt - b.linkedAt;\n                // }}\n                sorter={true}\n                defaultSortOrder='descend'\n                render={(linkedAt: number) => {\n                    return Intl.DateTimeFormat('en-US').format(linkedAt);\n                }}\n            />\n        </Table>\n    }\n    renderLoading() {\n        return (\n            <Spin />\n        )\n    }\n    renderError(error: UIError) {\n        return (\n            <Alert type=\"error\" message={error.message} />\n        )\n    }\n    render() {\n        const collection = this.props.linkedObjectsCollection;\n        switch (collection.status) {\n            case DBCollectionStatus.NONE:\n                return this.renderLoading();\n            case DBCollectionStatus.ERROR:\n                return this.renderError(collection.error);\n            case DBCollectionStatus.LOADING:\n                return this.renderLinkedObjects(collection.data, true);\n            case DBCollectionStatus.LOADED:\n                return this.renderLinkedObjects(collection.data, false);\n            case DBCollectionStatus.RELOADING:\n                return this.renderLinkedObjects(collection.data, true)\n        }\n    }\n}\n","import React from 'react';\nimport { DBCollectionStatus } from '../../../../lib/DB2';\n\nimport { AppConfig } from '@kbase/ui-components';\nimport LinkedData from './view';\nimport { TaxonReference } from '../../../../types/taxonomy';\nimport LinkedDataDB, { SortSpec } from './LinkedDataDB';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    taxonRef: TaxonReference;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: LinkedDataDB;\n    lastTaxonRef: TaxonReference;\n    constructor(props: Props) {\n        super(props);\n        this.db = new LinkedDataDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                linkedObjectsCollection: {\n                    status: DBCollectionStatus.NONE\n                }\n            },\n            token: props.token,\n            config: props.config\n        });\n        this.lastTaxonRef = props.taxonRef;\n    }\n\n    componentDidUpdate() {\n        if (this.lastTaxonRef !== this.props.taxonRef) {\n            this.lastTaxonRef = this.props.taxonRef;\n            this.db.fetchLinkedObjects({ taxonRef: this.props.taxonRef, page: 1, pageSize: 12 })\n        }\n    }\n\n    fetchLinkedObjects(page: number, pageSize: number) {\n        return this.db.fetchLinkedObjects({ taxonRef: this.props.taxonRef, page, pageSize });\n    }\n\n    queryLinkedObjects(page: number, pageSize: number, sort: SortSpec | null) {\n        return this.db.queryLinkedObjects({ taxonRef: this.props.taxonRef, page, pageSize, sort });\n    }\n\n    // renderNone() {\n    //     return <Icon type=\"loading\" />;\n    // }\n\n    // renderLoading() {\n    //     return <Icon type=\"loading\" />;\n    // }\n\n    // renderError(db: LinkedDataDBStateError) {\n    //     return (\n    //         <ErrorView error={db.error} />\n    //     )\n    // }\n\n    // renderLoaded(db: LinkedDataDBStateLoaded) {\n    //     return <LinkedData linkedObjects={db.linkedObjects} fetchLinkedObjects={this.fetchLinkedObjects.bind(this)} />;\n    // }\n\n    // componentDidMount() {\n    //     const db = this.db.get();\n    //     switch (db.status) {\n    //         case DBStatus.NONE:\n    //             this.db.fetchLinkedObjects({ taxonRef: this.props.taxonRef, page: 1, pageSize: 1000 });\n    //     }\n    // }\n\n    // componentDidUpdate(prevProps: Props) {\n    //     if (prevProps.taxonRef.id !== this.props.taxonRef.id ||\n    //         prevProps.taxonRef.namespace !== this.props.taxonRef.namespace ||\n    //         prevProps.taxonRef.timestamp !== this.props.taxonRef.timestamp) {\n\n    //         this.db.fetchLinkedObjects({ taxonRef: this.props.taxonRef, page: 1, pageSize: 1000 });\n    //     }\n    // }\n\n    render() {\n        const db = this.db.get();\n        return <LinkedData\n            linkedObjectsCollection={db.linkedObjectsCollection}\n            updateView={this.queryLinkedObjects.bind(this)}\n            setPage={this.fetchLinkedObjects.bind(this)} />;\n        // this.renderLoaded(db);\n        // switch (db.status) {\n        //     case DBStatus.NONE:\n        //         // this.db.fetchLinkedObjects({ taxonRef: this.props.taxonRef, page: 1, pageSize: 1000 });\n        //         return this.renderNone();\n        //     case DBStatus.LOADING:\n        //         return this.renderLoading();\n        //     case DBStatus.ERROR:\n        //         return this.renderError(db);\n        //     case DBStatus.LOADED:\n        //         return this.renderLoaded(db);\n        // }\n    }\n}\n","import { AppConfig } from '@kbase/ui-components';\nimport { StoreState } from '../../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps { }\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {};\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import React from 'react';\nimport { Tabs } from 'antd';\nimport TaxonDetail from './TaxonDetail';\nimport TaxonDescription from './TaxonDescription';\nimport LinkedData from './linkedData';\nimport { Taxon } from '../../../types/taxonomy';\n\nexport interface TaxonInfoProps {\n    taxon: Taxon;\n}\n\ninterface TaxonInfoState { }\n\nexport default class TaxonInfo extends React.Component<TaxonInfoProps, TaxonInfoState> {\n    render() {\n        return (\n            <Tabs defaultActiveKey=\"detail\" animated={false} className=\"FullHeight-tabs\">\n                <Tabs.TabPane tab=\"Detail\" key=\"detail\" forceRender={false}>\n                    <div className=\"Col\" style={{ overflowY: 'auto' }}>\n                        <TaxonDetail taxon={this.props.taxon} />\n                    </div>\n                </Tabs.TabPane>\n                <Tabs.TabPane tab=\"Description\" key=\"description\" forceRender={false}>\n                    <TaxonDescription taxon={this.props.taxon} />\n                </Tabs.TabPane>\n                <Tabs.TabPane tab=\"Linked Data\" key=\"linkedData\" forceRender={false}>\n                    <div className=\"Col\" style={{ overflowY: 'auto' }}>\n                        <LinkedData taxonRef={this.props.taxon.ref} />\n                    </div>\n                </Tabs.TabPane>\n            </Tabs>\n        );\n    }\n}\n","import React from 'react';\n\nimport { SourceInfo } from '../SourceInfo';\nimport LineageNavigator from '../LineageNavigator';\nimport TaxonSummary from '../TaxonSummary';\nimport { Taxon, TaxonReference } from '../../../types/taxonomy';\nimport { Row, Col } from 'antd';\nimport TaxonInfo from '../taxonInfo/TaxonInfo';\nimport './Taxonomy.css';\n\nexport interface TaxonomyProps {\n    // lineage: Array<Taxon>;\n    selectedTaxon: Taxon;\n    targetTaxon: Taxon;\n    selectTaxonRef: (taxonRef: TaxonReference) => void;\n    navigateToTaxonREf: (taxonRef: TaxonReference) => void;\n    setTitle: (title: string) => void;\n}\n\ninterface TaxonomyState { }\n\nexport default class Taxonomy extends React.Component<TaxonomyProps, TaxonomyState> {\n    renderTaxonInfo() {\n        if (!this.props.selectedTaxon) {\n            return <div>No taxon selected</div>;\n        }\n        return <TaxonInfo taxon={this.props.selectedTaxon} />;\n        // return 'disabled';\n    }\n\n    componentDidMount() {\n        this.props.setTitle('Taxonomy Landing Page for \"' + this.props.targetTaxon.name + '\"');\n    }\n\n    render() {\n        return (\n            <div className=\"Col scrollable Taxonomy\">\n                <div className=\"Col-auto Taxonomy-summary-section\">\n                    <Row>\n                        <Col span={12}>\n                            <TaxonSummary taxon={this.props.targetTaxon} />\n                        </Col>\n                        <Col span={12}>\n                            <SourceInfo />\n                        </Col>\n                    </Row>\n                </div>\n                <div className=\"Row scrollable\">\n                    <div className=\"Col scrollable\" style={{ flex: '0 0 20em' }}>\n                        <LineageNavigator\n                            selectedTaxon={this.props.selectedTaxon}\n                            // lineage={this.props.lineage}\n                            selectTaxonRef={this.props.selectTaxonRef}\n                            targetTaxon={this.props.targetTaxon}\n                            navigateToTaxonRef={this.props.navigateToTaxonREf}\n                        />\n                    </div>\n\n                    <div className=\"Col scrollable\" style={{ marginLeft: '10px' }}>\n                        {this.renderTaxonInfo()}\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n","import React from 'react';\nimport TaxonDB, { TaxonDBStateLoaded } from './TaxonDB';\nimport { DBStatus, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport Taxonomy from './Taxonomy';\nimport { TaxonReference } from '../../../types/taxonomy';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../components/ErrorView';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    taxonRef: TaxonReference;\n    // taxonID: TaxonID;\n    navigate: (taxonRef: TaxonReference) => void;\n    setTitle: (title: string) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: TaxonDB;\n    currentlyNavigatedTaxonRef: TaxonReference | null;\n    constructor(props: Props) {\n        super(props);\n        this.db = new TaxonDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n        this.currentlyNavigatedTaxonRef = null;\n    }\n\n    selectTaxon(taxonRef: TaxonReference) {\n        return this.db.getSelectedTaxon(taxonRef);\n    }\n\n    navigateToTaxon(taxonRef: TaxonReference) {\n        return this.props.navigate(taxonRef);\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        // NB this is rendered raw in the container, which is a flex row.\n        return (\n            <div className=\"Col\">\n                <div style={{ width: '50%', margin: '20px auto 0 auto' }}>\n                    <ErrorView error={db.error} />\n                </div>\n            </div>\n        );\n    }\n\n    renderLoaded(db: TaxonDBStateLoaded) {\n        return (\n            <Taxonomy\n                targetTaxon={db.targetTaxon}\n                selectedTaxon={db.selectedTaxon}\n                selectTaxonRef={this.selectTaxon.bind(this)}\n                navigateToTaxonREf={this.navigateToTaxon.bind(this)}\n                setTitle={this.props.setTitle}\n            />\n        );\n    }\n\n    componentDidMount() {\n        this.db.getTargetTaxon(this.props.taxonRef);\n    }\n\n    componentDidUpdate(previousProps: Props) {\n        if (previousProps.taxonRef.id !== this.props.taxonRef.id ||\n            previousProps.taxonRef.timestamp !== this.props.taxonRef.timestamp) {\n            this.db.getTargetTaxon(this.props.taxonRef);\n        }\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                // this.db.getTargetTaxon(this.props.taxonID);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n            // if (this.props.taxonID !== db.targetTaxon.id) {\n            //     this.db.getTargetTaxon(this.props.taxonID);\n            //     return this.renderLoaded(db);\n            // } else {\n            //     return this.renderLoaded(db);\n            // }\n        }\n    }\n}\n","import { AppConfig, sendTitle } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../../redux/actions';\nimport { TaxonReference, taxonomyNamespaceToString } from '../../../types/taxonomy';\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps {\n    navigate: (ref: TaxonReference) => void;\n    setTitle: (title: string) => void;\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, props: OwnProps): DispatchProps {\n    return {\n        navigate: (ref: TaxonReference) => {\n            const relationEngineID = [\n                'taxonomy',\n                taxonomyNamespaceToString(ref.namespace),\n                ref.id,\n                String(ref.timestamp)\n            ].join('/');\n            dispatch(navigate(relationEngineID) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import { RelationEngineID, StoreState } from '../../redux/store';\n// import { TaxonID } from './redux/store';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../redux/actions';\nimport { connect } from 'react-redux';\nimport Taxonomy from './main';\nimport { sendTitle } from '@kbase/ui-components';\n\nexport interface OwnProps {\n    // taxonID: TaxonID;\n}\n\nexport interface StateProps {\n    // taxonID: TaxonID;\n}\n\nexport interface DispatchProps {\n    navigate: (relationEngineID: RelationEngineID) => void;\n    setTitle: (title: string) => void;\n    // load: (taxonID: TaxonID) => void;\n}\n\nfunction mapStateToProps(state: StoreState, ownProps: OwnProps): StateProps {\n    return {};\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, ownProps: OwnProps): DispatchProps {\n    return {\n        navigate: (relationEngineId: RelationEngineID) => {\n            dispatch(navigate(relationEngineId) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n        // load: (taxonID: TaxonID) => {\n        //     dispatch(load(taxonID) as any);\n        // }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(Taxonomy);\n","import { DynamicServiceClient } from \"@kbase/ui-lib\";\n\nexport interface GetParentsParams {\n    ns: Namespace;\n    id: string;\n    ts: number;\n}\n\nexport type Namespace = 'go';\n\nexport interface GetParentsResult {\n    results: Array<RelatedTerm>;\n    ns: Namespace;\n    ts: number;\n}\n\nexport interface GetChildrenParams {\n    ns: Namespace;\n    id: string;\n    ts: number;\n}\n\nexport interface GetChildrenResult {\n    results: Array<RelatedTerm>;\n    ns: Namespace;\n    ts: number;\n}\n\nexport interface Synonym {\n    pred: string;\n    val: string;\n    xrefs: Array<XRef>\n}\n\nexport interface XRef {\n    val: string;\n}\n\n// export interface Termx {\n//     ns: string;\n//     id: string;\n//     ts: number;\n//     name: string;\n//     scientific_name: string;\n//     relation: string;\n//     synonyms: Array<Synonym>;\n//     goID?: string;\n//     commnent: string;\n//     definition: string;\n// }\n\n// doesn't include the underscore fields\n// TODO: the api should not return any underscore\n// fields.\nexport interface TermNode {\n    namespace: string;\n    id: string;\n    alt_ids: Array<string>;\n    name: string;\n    comments: Array<string>;\n    def: {\n        val: string;\n        xrefs: Array<string>;\n    };\n    created: number;\n    expired: number;\n    subsets: Array<string>;\n    synonyms: Array<Synonym>;\n    type: string;\n    xrefs: Array<XRef>;\n\n    first_version: string;\n    last_version: string;\n    release_created: number;\n    release_expired: number;\n}\n\nexport interface TermEdge {\n    id: string;\n    type: string;\n    created: number;\n    expired: number;\n    first_version: string;\n    last_version: string;\n    from: string;\n    to: string;\n    release_created: number;\n    release_expired: number;\n}\n\n\nexport interface RelatedTerm {\n    term: TermNode;\n    edge: TermEdge;\n}\n\n// export interface TermBrief {\n//     ns: Namespace;\n//     id: string;\n//     ts: number;\n//     name: string;\n//     scientific_name: string;\n//     relation: string;\n// }\n\nexport type TermBrief = TermNode;\n\nexport interface GetTermsParams {\n    ids: Array<string>;\n    ts: number;\n    ns: Namespace;\n}\n\nexport interface GetTermsResult {\n    results: Array<TermNode>,\n    ts: number\n    // ignore the stats\n}\n\nexport interface GetRelatedObjectsParams {\n    ns: Namespace;\n    id: string;\n    ts: number;\n}\n\nexport interface GetRelatedObjectsResult {\n\n}\n\nexport default class OntologyAPIClient extends DynamicServiceClient {\n    static module: string = 'OntologyAPI';\n\n    async getParents({ ns, id, ts }: { ns: Namespace, id: string, ts: number }): Promise<GetParentsResult> {\n        const params: GetParentsParams = {\n            ns, id, ts\n        };\n        const [result] = await this.callFunc<[GetParentsParams], [GetParentsResult]>('get_parents', [\n            params\n        ]);\n        return result;\n    }\n\n    async getTerms({ ns, ids, ts }: GetTermsParams): Promise<GetTermsResult> {\n        const params: GetTermsParams = {\n            ns, ids, ts\n        }\n        const [result] = await this.callFunc<[GetTermsParams], [GetTermsResult]>('get_terms', [\n            params\n        ]);\n        return result;\n    }\n\n    async getChildren({ ns, id, ts }: { ns: Namespace, id: string, ts: number }): Promise<GetChildrenResult> {\n        const params: GetChildrenParams = {\n            ns, id, ts\n        };\n        const [result] = await this.callFunc<[GetChildrenParams], [GetChildrenResult]>('get_children', [\n            params\n        ]);\n        return result;\n    }\n\n    async getRelatedObjects({ ns, id, ts }: { ns: Namespace, id: string, ts: number }): Promise<GetRelatedObjectsResult> {\n        const params: GetRelatedObjectsParams = {\n            ns, id, ts\n        };\n        const [result] = await this.callFunc<[GetRelatedObjectsParams], [GetRelatedObjectsResult]>('get_children', [\n            params\n        ]);\n        return result;\n    }\n}","import OntologyAPIClient, { Namespace, TermNode, RelatedTerm } from './OntologyAPIClient';\nimport { OntologyReference, OntologyNamespace, OntologyTerm, OntologySource, GOOntologyTerm } from '../../../types/ontology';\nimport { RelationEngineCollection } from '../../../types';\n\nexport interface GetTermParams {\n    ref: OntologyReference\n}\n\nexport interface GetTermResult {\n    term: OntologyTerm;\n}\n\nexport interface GetTermsParams {\n    refs: Array<OntologyReference>\n}\n\nexport interface GetTermsResult {\n    terms: Array<OntologyTerm>;\n}\n\nexport interface GetParentsParams {\n    ref: OntologyReference;\n}\n\n// TODO: this should be a \"related term\", although maybe the relation \n// collapses out with ontology - are they all is_a at least for parents, children?\nexport interface GetParentsResult {\n    terms: Array<OntologyTerm>\n}\n\nexport interface GetChildrenParams {\n    ref: OntologyReference;\n}\n\n// TODO: this should be a \"related term\", although maybe the relation \n// collapses out with ontology - are they all is_a at least for parents, children?\nexport interface GetChildrenResult {\n    terms: Array<OntologyTerm>\n}\n\nexport function ontologyNamespaceToString(namespace: OntologyNamespace): Namespace {\n    switch (namespace) {\n        case OntologyNamespace.GO:\n            return 'go';\n    }\n}\n\nexport function stringToOntologyNamespace(ns: Namespace): OntologyNamespace {\n    switch (ns) {\n        case 'go':\n            return OntologyNamespace.GO\n        default:\n            throw new Error('Unknown ontology namespace: ' + ns);\n    }\n}\n\nexport function termNodeToTerm(term: TermNode, ts: number): OntologyTerm {\n    const namespace = stringToOntologyNamespace('go');\n    switch (namespace) {\n        case OntologyNamespace.GO:\n            const temp: GOOntologyTerm = {\n                type: OntologySource.GO,\n                ref: {\n                    collection: RelationEngineCollection.ONTOLOGY,\n                    namespace: OntologyNamespace.GO, // TODO: stringToOntologyNamespace(term.ns),\n                    id: term.id,\n                    timestamp: ts\n                },\n                namespace: term.namespace,\n                comments: term.comments,\n                definition: term.def.val,\n                goID: term.id,\n                isObsolete: false, // ignored for now, \n                name: term.name,\n                synonyms: {\n                    exact: term.synonyms.filter((synonym) => {\n                        return synonym.pred === 'hasExactSynonym'\n                    }).map((synonym) => {\n                        return synonym.val;\n                    }),\n                    narrow: term.synonyms.filter((synonym) => {\n                        return synonym.pred === 'hasNarrowSynonym'\n                    }).map((synonym) => {\n                        return synonym.val;\n                    }),\n                    broad: term.synonyms.filter((synonym) => {\n                        return synonym.pred === 'hasBroadSynonym'\n                    }).map((synonym) => {\n                        return synonym.val;\n                    }),\n                    related: term.synonyms.filter((synonym) => {\n                        return synonym.pred === 'hasRelatedSynonym'\n                    }).map((synonym) => {\n                        return synonym.val;\n                    }),\n                }, // TODO:\n            };\n            return temp;\n    }\n}\n\nexport function relatedTermToTerm(relatedTerm: RelatedTerm, ts: number): OntologyTerm {\n    return termNodeToTerm(relatedTerm.term, ts);\n}\n\nexport default class OntologyModel {\n    ontologyClient: OntologyAPIClient;\n    token: string;\n    url: string;\n    constructor({ token, url }: { token: string; url: string }) {\n        this.token = token;\n        this.url = url;\n        this.ontologyClient = new OntologyAPIClient({ token, url });\n    }\n\n    // async getTerms({ refs }: GetTermsParams): Promise<GetTermsResult> {\n    //     const client = new OntologyAPIClient({\n    //         token: this.token,\n    //         url: this.url\n    //     });\n\n    //     if (refs.length === 0) {\n    //         return { terms: [] };\n    //     }\n\n    //     const ns = ontologyNamespaceToString(refs[0].namespace);\n    //     const ids = refs.map(({ id }))\n\n    //     const result = await client.getTerms({\n    //         ns,\n    //         ids: [ref.id],\n    //         ts: ref.timestamp\n    //     })\n\n    //     return {\n    //         term: rawTermToTerm(result.term, result.ts)\n    //     };\n\n    // }\n\n    async getTerm({ ref }: GetTermParams): Promise<GetTermResult> {\n        const client = new OntologyAPIClient({\n            token: this.token,\n            url: this.url\n        });\n\n        const result = await client.getTerms({\n            ns: ontologyNamespaceToString(ref.namespace),\n            ids: [ref.id],\n            ts: ref.timestamp || Date.now()\n        });\n\n        return {\n            term: termNodeToTerm(result.results[0], result.ts)\n        };\n    }\n\n    async getParents({ ref }: GetParentsParams): Promise<GetParentsResult> {\n        const client = new OntologyAPIClient({\n            token: this.token,\n            url: this.url\n        });\n\n        const result = await client.getParents({\n            ns: ontologyNamespaceToString(ref.namespace),\n            id: ref.id,\n            ts: ref.timestamp || Date.now()\n        });\n\n        return {\n            terms: result.results.map((item) => {\n                return relatedTermToTerm(item, result.ts);\n            })\n        };\n    }\n\n    async getChildren({ ref }: GetChildrenParams): Promise<GetChildrenResult> {\n        const client = new OntologyAPIClient({\n            token: this.token,\n            url: this.url\n        });\n\n        const result = await client.getChildren({\n            ns: ontologyNamespaceToString(ref.namespace),\n            id: ref.id,\n            ts: ref.timestamp || Date.now()\n        });\n\n        return {\n            terms: result.results.map((item) => {\n                return relatedTermToTerm(item, result.ts);\n            })\n        };\n    }\n}","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../lib/DB';\nimport { OntologyTerm, OntologyReference } from '../../../types/ontology';\nimport { AppConfig } from '@kbase/ui-components';\nimport OntologyModel from '../lib/model';\n\nexport type OntologyDBStateNone = DBStateNone;\nexport type OntologyDBStateLoading = DBStateLoading;\nexport type OntologyDBStateError = DBStateError;\nexport interface OntologyDBStateLoaded extends DBStateLoaded {\n    targetTerm: OntologyTerm;\n    selectedTerm: OntologyTerm;\n}\n\nexport type OntologyDBState = OntologyDBStateNone | OntologyDBStateLoading | OntologyDBStateLoaded | OntologyDBStateError;\n\nexport interface OntologyDBProps extends DBProps<OntologyDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport default class OntologyDB extends DB<OntologyDBState> {\n    props: OntologyDBProps;\n    constructor(props: OntologyDBProps) {\n        super(props);\n        this.props = props;\n    }\n\n    async getTargetTerm(termRef: OntologyReference) {\n        this.set((state: OntologyDBState) => {\n            return {\n                ...state,\n                status: DBStatus.LOADING\n            };\n        });\n\n        const client = new OntologyModel({\n            token: this.props.token,\n            url: this.props.config.services.ServiceWizard.url\n        });\n\n        try {\n\n            const { term } = await client.getTerm({\n                ref: termRef\n            });\n\n            this.set((state: OntologyDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    targetTerm: term,\n                    selectedTerm: term\n                }\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: OntologyDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.ERROR,\n                    error: ex.message\n                };\n            });\n        }\n    }\n\n    async setSelectedTerm(termRef: OntologyReference) {\n        const state = this.get();\n\n        if (state.status !== DBStatus.LOADED) {\n            return;\n        }\n\n        const client = new OntologyModel({\n            token: this.props.token,\n            url: this.props.config.services.ServiceWizard.url\n        });\n\n        const { term } = await client.getTerm({ ref: termRef })\n\n        this.set((state: OntologyDBState) => {\n            return {\n                ...state,\n                selectedTerm: term\n            };\n        });\n    }\n}","import React from 'react';\nimport { OntologyReference, OntologyTermBrief, ontologyNamespaceToString } from '../../types/ontology';\nimport { Tooltip, Icon } from 'antd';\nimport './OntologyTerm.css';\n\nexport interface Props {\n    term: OntologyTermBrief;\n    isActive: boolean;\n    selectTerm: (termRef: OntologyReference) => void;\n    navigateToTermRef: (ref: OntologyReference) => void;\n}\n\ninterface State {\n    hovering: boolean;\n}\n\nexport default class OntologyTerm extends React.Component<Props, State> {\n    constructor(props: Props) {\n        super(props);\n        this.state = {\n            hovering: false\n        };\n    }\n    clickTerm() {\n        this.props.selectTerm(this.props.term.ref);\n    }\n    clickNavigateToTerm() {\n        const hash = [\n            'review',\n            'ontology',\n            ontologyNamespaceToString(this.props.term.ref.namespace),\n            this.props.term.ref.id,\n            String(this.props.term.ref.timestamp)\n        ].join('/');\n        // const hash = `review/${this.props.term.}`;\n        // TODO: use the integration api?\n        if (window.parent) {\n            window.parent.location.hash = hash;\n        } else {\n            window.location.hash = hash;\n        }\n        // window.history.pushState({}, 'my title', `/#review/${this.props.taxon.id}`);\n        // this.props.navigateToTaxonID(this.props.taxon.id);\n    }\n\n    onMouseEnter(ev: React.MouseEvent<HTMLDivElement>) {\n        this.setState({ hovering: true });\n    }\n\n    onMouseLeave(ev: React.MouseEvent<HTMLDivElement>) {\n        this.setState({ hovering: false });\n    }\n\n    renderTerm() {\n        return <div className=\"OntologyTerm-term\" onClick={this.clickNavigateToTerm.bind(this)}>\n            <div className=\"OntologyTerm-name\">\n                {this.props.term.name}\n            </div>\n        </div>;\n        // <div className=\"OntologyTerm-id\">\n        //         {this.props.term.ref.id}\n        //     </div>\n    }\n\n    renderOver() {\n        return (\n            <React.Fragment>\n                {this.renderTerm()}\n                <div className=\"OntologyTerm-inspector\" onClick={this.clickTerm.bind(this)}>\n                    <Icon type=\"arrow-right\" />\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    renderActive() {\n        return (\n            <React.Fragment>\n                {this.renderTerm()}\n                <div className=\"OntologyTerm-inspector\">\n                    <Icon type=\"arrow-right\" />\n                </div>\n            </React.Fragment>\n        );\n    }\n\n    renderNormal() {\n        return this.renderTerm();\n    }\n\n    renderItem() {\n        if (this.props.isActive) {\n            return this.renderActive();\n        }\n        if (this.state.hovering) {\n            return this.renderOver();\n        } else {\n            return this.renderNormal();\n        }\n    }\n\n    render() {\n        const term = this.props.term;\n        const classNames = ['OntologyTerm'];\n        if (this.props.isActive) {\n            classNames.push('OntologyTerm-active');\n        }\n\n        const tooltipTitle = (\n            <div>\n                <div style={{ borderBottom: '1px solid silver' }}>{term.name}</div>\n                {term.ref.id}\n            </div>\n        );\n\n        return (\n            <Tooltip title={tooltipTitle} placement=\"right\" key={this.props.term.ref.id}>\n                <div\n                    className={classNames.join(' ')}\n                    key={this.props.term.ref.id}\n                    onMouseEnter={this.onMouseEnter.bind(this)}\n                    onMouseLeave={this.onMouseLeave.bind(this)}\n                >\n                    {this.renderItem()}\n                </div>\n            </Tooltip>\n        );\n    }\n}\n","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../lib/DB';\nimport { OntologyTerm, OntologyReference, GOOntologyTerm } from '../../../types/ontology';\nimport { AppConfig } from '@kbase/ui-components';\nimport OntologyModel from '../lib/model';\n\nexport type ParentsDBStateNone = DBStateNone;\nexport type ParentsDBStateLoading = DBStateLoading;\nexport type ParentsDBStateError = DBStateError;\nexport interface ParentsDBStateLoaded extends DBStateLoaded {\n    terms: Array<OntologyTerm>;\n}\n\nexport type ParentsDBState = ParentsDBStateNone | ParentsDBStateLoading | ParentsDBStateLoaded | ParentsDBStateError;\n\nexport interface ParentsDBProps extends DBProps<ParentsDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport default class ParentsDB extends DB<ParentsDBState> {\n    props: ParentsDBProps;\n    constructor(props: ParentsDBProps) {\n        super(props);\n        this.props = props;\n    }\n\n    async getChildrenTerms(termRef: OntologyReference) {\n        this.set((state: ParentsDBState) => {\n            return {\n                ...state,\n                status: DBStatus.LOADING\n            };\n        });\n\n        const client = new OntologyModel({\n            token: this.props.token,\n            url: this.props.config.services.ServiceWizard.url\n        });\n\n        try {\n\n            const { terms } = await client.getChildren({\n                ref: termRef\n            });\n\n            terms.sort((a: GOOntologyTerm, b: GOOntologyTerm) => {\n                return a.name.localeCompare(b.name);\n            });\n\n            this.set((state: ParentsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    terms: terms\n                }\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: ParentsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.ERROR,\n                    error: ex.message\n                };\n            });\n        }\n    }\n\n}","import React from 'react';\nimport { OntologyReference, OntologyTermBrief } from '../../../types/ontology';\nimport './style.css';\nimport Term from '../OntologyTerm';\nimport { Empty } from 'antd';\n\nexport interface Props {\n    terms: Array<OntologyTermBrief>;\n    // maxItems: number;\n    // totalItems: number;\n    selectedTermRef: OntologyReference | null;\n    selectTerm: (termRef: OntologyReference) => void;\n    navigateToTermRef: (termRef: OntologyReference) => void;\n}\n\ninterface State { }\n\nexport default class OntologyList extends React.Component<Props, State> {\n\n    navigateToTerm(termRef: OntologyReference) {\n        this.props.navigateToTermRef(termRef);\n    }\n    renderItemsPlain() {\n        return this.props.terms.map((term) => {\n            const isActive = this.props.selectedTermRef !== null &&\n                this.props.selectedTermRef.collection === term.ref.collection &&\n                this.props.selectedTermRef.namespace === term.ref.namespace &&\n                this.props.selectedTermRef.id === term.ref.id;\n\n            return (\n                <Term\n                    term={term}\n                    isActive={isActive}\n                    selectTerm={this.props.selectTerm.bind(this)}\n                    key={term.ref.id}\n                    navigateToTermRef={this.navigateToTerm.bind(this)}\n                />\n            );\n        });\n    }\n    renderNoItems() {\n        return <Empty description=\"No Children\" image={Empty.PRESENTED_IMAGE_SIMPLE} />;\n    }\n    render() {\n        if (this.props.terms.length === 0) {\n            return this.renderNoItems();\n        }\n        return this.renderItemsPlain();\n    }\n}\n","import React from 'react';\nimport ParentsDB, { ParentsDBStateLoaded } from './ChildrenDB';\nimport { DBStatus, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport View from './view';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../components/ErrorView';\nimport { OntologyReference } from '../../../types/ontology';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    termRef: OntologyReference;\n    selectedTermRef: OntologyReference | null;\n    selectTerm: (termRef: OntologyReference) => void;\n    // taxonID: TaxonID;\n    navigateToTermRef: (termRef: OntologyReference) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: ParentsDB;\n    currentlyNavigatedOntologyRef: OntologyReference | null;\n    constructor(props: Props) {\n        super(props);\n        this.db = new ParentsDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n        this.currentlyNavigatedOntologyRef = null;\n    }\n\n    // selectTerm(termRef: OntologyReference) {\n    //     return this.db.getSelectedTerm(termRef);\n    // }\n\n    navigateToTerm(termRef: OntologyReference) {\n        return this.props.navigateToTermRef(termRef);\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        // NB this is rendered raw in the container, which is a flex row.\n        return (\n            <div className=\"Col\">\n                <div style={{ width: '50%', margin: '20px auto 0 auto' }}>\n                    <ErrorView error={db.error} />\n                </div>\n            </div>\n        );\n    }\n\n    renderLoaded(db: ParentsDBStateLoaded) {\n        return (\n            <View\n                terms={db.terms}\n                selectedTermRef={this.props.selectedTermRef}\n                selectTerm={this.props.selectTerm.bind(this)}\n                navigateToTermRef={this.props.navigateToTermRef.bind(this)}\n            />\n        );\n    }\n\n    componentDidMount() {\n        this.db.getChildrenTerms(this.props.termRef);\n    }\n\n    componentDidUpdate(previousProps: Props) {\n        // if (previousProps.termRef.id !== this.props.termRef.id ||\n        //     previousProps.termRef.timestamp !== this.props.termRef.timestamp) {\n        //     this.db.getTargetTerm(this.props.termRef);\n        // }\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                // this.db.getTargetTaxon(this.props.taxonID);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n            // if (this.props.taxonID !== db.targetTaxon.id) {\n            //     this.db.getTargetTaxon(this.props.taxonID);\n            //     return this.renderLoaded(db);\n            // } else {\n            //     return this.renderLoaded(db);\n            // }\n        }\n    }\n}\n","import { AppConfig, sendTitle } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../../redux/actions';\nimport { OntologyReference } from '../../../types/ontology';\nimport { ontologyNamespaceToString } from '../lib/model';\n\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps {\n    navigate: (ref: OntologyReference) => void;\n    setTitle: (title: string) => void;\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, props: OwnProps): DispatchProps {\n    return {\n        navigate: (ref: OntologyReference) => {\n            const relationEngineID = [\n                'ontology',\n                ontologyNamespaceToString(ref.namespace),\n                ref.id,\n                String(ref.timestamp)\n            ].join('/');\n            dispatch(navigate(relationEngineID) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../lib/DB';\nimport { OntologyTerm, OntologyReference } from '../../../types/ontology';\nimport { AppConfig } from '@kbase/ui-components';\nimport OntologyModel from '../lib/model';\n\nexport type ParentsDBStateNone = DBStateNone;\nexport type ParentsDBStateLoading = DBStateLoading;\nexport type ParentsDBStateError = DBStateError;\nexport interface ParentsDBStateLoaded extends DBStateLoaded {\n    terms: Array<OntologyTerm>;\n}\n\nexport type ParentsDBState = ParentsDBStateNone | ParentsDBStateLoading | ParentsDBStateLoaded | ParentsDBStateError;\n\nexport interface ParentsDBProps extends DBProps<ParentsDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport default class ParentsDB extends DB<ParentsDBState> {\n    props: ParentsDBProps;\n    constructor(props: ParentsDBProps) {\n        super(props);\n        this.props = props;\n    }\n\n    async getParentTerms(termRef: OntologyReference) {\n        this.set((state: ParentsDBState) => {\n            return {\n                ...state,\n                status: DBStatus.LOADING\n            };\n        });\n\n        const client = new OntologyModel({\n            token: this.props.token,\n            url: this.props.config.services.ServiceWizard.url\n        });\n\n        try {\n\n            const { terms } = await client.getParents({\n                ref: termRef\n            });\n\n            this.set((state: ParentsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    terms: terms\n                }\n            });\n        } catch (ex) {\n            console.error('ERROR', ex);\n            this.set((state: ParentsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.ERROR,\n                    error: ex.message\n                };\n            });\n        }\n    }\n\n}","import React from 'react';\nimport { OntologyReference, OntologyTermBrief } from '../../../types/ontology';\nimport './style.css';\nimport Term from '../OntologyTerm';\nimport { Empty } from 'antd';\n\nexport interface Props {\n    terms: Array<OntologyTermBrief>;\n    // maxItems: number;\n    // totalItems: number;\n    selectedTermRef: OntologyReference | null;\n    selectTerm: (termRef: OntologyReference) => void;\n    navigateToTermRef: (termRef: OntologyReference) => void;\n}\n\ninterface State { }\n\nexport default class OntologyList extends React.Component<Props, State> {\n\n    navigateToTerm(termRef: OntologyReference) {\n        this.props.navigateToTermRef(termRef);\n    }\n    renderItemsPlain() {\n        return this.props.terms.map((term) => {\n            const isActive = this.props.selectedTermRef !== null &&\n                this.props.selectedTermRef.collection === term.ref.collection &&\n                this.props.selectedTermRef.namespace === term.ref.namespace &&\n                this.props.selectedTermRef.id === term.ref.id;\n            return (\n                <Term\n                    term={term}\n                    isActive={isActive}\n                    selectTerm={this.props.selectTerm.bind(this)}\n                    key={term.ref.id}\n                    navigateToTermRef={this.navigateToTerm.bind(this)}\n                />\n            );\n        });\n    }\n    renderNoItems() {\n        return <Empty description=\"No Children\" image={Empty.PRESENTED_IMAGE_SIMPLE} />;\n    }\n    render() {\n        if (this.props.terms.length === 0) {\n            return this.renderNoItems();\n        }\n        return this.renderItemsPlain();\n    }\n}\n","import React from 'react';\nimport ParentsDB, { ParentsDBStateLoaded } from './ParentsDB';\nimport { DBStatus, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport View from './view';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../components/ErrorView';\nimport { OntologyReference } from '../../../types/ontology';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    termRef: OntologyReference;\n    selectedTermRef: OntologyReference | null;\n    selectTerm: (termRef: OntologyReference) => void;\n    // taxonID: TaxonID;\n    navigateToTermRef: (termRef: OntologyReference) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: ParentsDB;\n    currentlyNavigatedOntologyRef: OntologyReference | null;\n    constructor(props: Props) {\n        super(props);\n        this.db = new ParentsDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n        this.currentlyNavigatedOntologyRef = null;\n    }\n\n    navigateToTerm(termRef: OntologyReference) {\n        return this.props.navigateToTermRef(termRef);\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        // NB this is rendered raw in the container, which is a flex row.\n        return (\n            <div className=\"Col\">\n                <div style={{ width: '50%', margin: '20px auto 0 auto' }}>\n                    <ErrorView error={db.error} />\n                </div>\n            </div>\n        );\n    }\n\n    renderLoaded(db: ParentsDBStateLoaded) {\n        return (\n            <View\n                terms={db.terms}\n                selectedTermRef={this.props.selectedTermRef}\n                selectTerm={this.props.selectTerm.bind(this)}\n                navigateToTermRef={this.props.navigateToTermRef.bind(this)}\n            />\n        );\n    }\n\n    componentDidMount() {\n        this.db.getParentTerms(this.props.termRef);\n    }\n\n    componentDidUpdate(previousProps: Props) {\n        // if (previousProps.termRef.id !== this.props.termRef.id ||\n        //     previousProps.termRef.timestamp !== this.props.termRef.timestamp) {\n        //     this.db.getTargetTerm(this.props.termRef);\n        // }\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                // this.db.getTargetTaxon(this.props.taxonID);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n            // if (this.props.taxonID !== db.targetTaxon.id) {\n            //     this.db.getTargetTaxon(this.props.taxonID);\n            //     return this.renderLoaded(db);\n            // } else {\n            //     return this.renderLoaded(db);\n            // }\n        }\n    }\n}\n","import { AppConfig, sendTitle } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../../redux/actions';\nimport { OntologyReference } from '../../../types/ontology';\nimport { ontologyNamespaceToString } from '../lib/model';\n\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps {\n    navigate: (ref: OntologyReference) => void;\n    setTitle: (title: string) => void;\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, props: OwnProps): DispatchProps {\n    return {\n        navigate: (ref: OntologyReference) => {\n            const relationEngineID = [\n                'ontology',\n                ontologyNamespaceToString(ref.namespace),\n                ref.id,\n                String(ref.timestamp)\n            ].join('/');\n            dispatch(navigate(relationEngineID) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import React from 'react';\nimport './style.css';\nimport OntologyItem from '../OntologyTerm';\nimport { OntologyTerm, OntologyReference } from '../../../types/ontology';\nimport Children from '../Children';\nimport Parents from '../Parents';\n\nexport interface NavProps {\n    targetTerm: OntologyTerm;\n    selectedTerm: OntologyTerm;\n    selectTerm: (termRef: OntologyReference) => void;\n}\n\ninterface NavState {\n}\n\nexport default class Nav extends React.Component<NavProps, NavState> {\n    // selectTermRef(termRef: OntologyReference) {\n    //     console.log('selecting', termRef);\n    // }\n    navigateToTermRef(termRef: OntologyReference) {\n        console.log('navigating to ', termRef);\n    }\n\n    render() {\n        const isActive = this.props.selectedTerm !== null &&\n            this.props.selectedTerm.ref.collection === this.props.targetTerm.ref.collection &&\n            this.props.selectedTerm.ref.namespace === this.props.targetTerm.ref.namespace &&\n            this.props.selectedTerm.ref.id === this.props.targetTerm.ref.id;\n\n        return <div className=\"Col scrollable OntologyNav\">\n            <div className=\"Nav-box Col-auto\">\n                <div className=\"Col Nav-box-title\">\n                    Parents\n                </div>\n                <div className=\"Col Nav-box-content\">\n                    <Parents\n                        termRef={this.props.selectedTerm.ref}\n                        selectedTermRef={this.props.selectedTerm.ref}\n                        selectTerm={this.props.selectTerm.bind(this)}\n                        navigateToTermRef={this.navigateToTermRef.bind(this)}\n                    />\n                </div>\n            </div>\n            <div className=\"Nav-box Col-auto\">\n                <div className=\"Col-auto Nav-box-title\">\n                    Selected Term\n                </div>\n                <div className=\"Col Nav-box-content\">\n                    <OntologyItem\n                        term={this.props.targetTerm}\n                        isActive={isActive}\n                        selectTerm={this.props.selectTerm.bind(this)}\n                        navigateToTermRef={this.navigateToTermRef.bind(this)} />\n                </div>\n            </div>\n            <div className=\"Nav-box Col scrollable\">\n                <div className=\"Col-auto Nav-box-title\">\n                    Children\n                </div>\n                <div className=\"Col Nav-box-content\" style={{ overflowY: 'auto' }}>\n                    <Children\n                        termRef={this.props.selectedTerm.ref}\n                        selectedTermRef={this.props.selectedTerm.ref}\n                        selectTerm={this.props.selectTerm.bind(this)}\n                        navigateToTermRef={this.navigateToTermRef.bind(this)}\n                    />\n                </div>\n            </div>\n        </div >\n    }\n}","import React from 'react';\nimport { OntologySource, GOOntologyTerm, OntologyTerm } from '../../types/ontology';\n\nexport interface Props {\n    term: OntologyTerm;\n    newWindow: boolean;\n}\n\ninterface State {\n}\n\nexport default class TermLink extends React.Component<Props, State> {\n    renderGOLink(term: GOOntologyTerm) {\n        const href = `http://amigo.geneontology.org/amigo/term/${term.goID}`;\n        const target = this.props.newWindow ? '_blank' : '_parent';\n        return (\n            <a href={href} target={target}>\n                {term.ref.id}\n            </a>\n        )\n    }\n\n    render() {\n        const term = this.props.term;\n        switch (term.type) {\n            case (OntologySource.GO):\n                return this.renderGOLink(term);\n        }\n    }\n}","import DB, { DBProps, DBStatus, DBStateNone, DBStateLoading, DBStateLoaded, DBStateError } from '../../../../lib/DB';\nimport { LinkedObject, OntologyReference } from '../../../../types/ontology';\nimport { AppConfig } from '@kbase/ui-components';\n\nexport type LinkedObjectsDBStateNone = DBStateNone;\nexport type LinkedObjectsDBStateLoading = DBStateLoading;\nexport type LinkedObjectsDBStateError = DBStateError;\n\nexport interface LinkedObjectsDBStateLoaded extends DBStateLoaded {\n    linkedObjects: Array<LinkedObject>\n}\n\nexport type LinkedObjectsDBState = LinkedObjectsDBStateNone | LinkedObjectsDBStateLoading | LinkedObjectsDBStateError | LinkedObjectsDBStateLoaded;\n\nexport interface LinkedObjectsProps extends DBProps<LinkedObjectsDBState> {\n    token: string;\n    config: AppConfig;\n}\n\nexport default class LinkedObjectsDB extends DB<LinkedObjectsDBState> {\n    props: LinkedObjectsProps;\n    constructor(props: LinkedObjectsProps) {\n        super(props);\n        this.props = props;\n    }\n    async getLinkedObjects(termRef: OntologyReference) {\n        try {\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADING\n                }\n            });\n\n            // do the call here when it is available\n\n            const linkedObjects: Array<LinkedObject> = [\n                {\n                    object: {\n                        workspaceID: 43747,\n                        id: 4,\n                        version: 1\n                    },\n                    type: {\n                        module: 'KBaseGenomes',\n                        name: 'Genome'\n                    },\n                    scientificName: 'Escherichia coli',\n                    feature: 'CF61_RS00005'\n                },\n                {\n                    object: {\n                        workspaceID: 43747,\n                        id: 4,\n                        version: 1\n                    },\n                    type: {\n                        module: 'KBaseGenomes',\n                        name: 'Genome'\n                    },\n                    scientificName: 'Escherichia coli',\n                    feature: 'CF61_RS00005'\n                },\n                {\n                    object: {\n                        workspaceID: 43747,\n                        id: 4,\n                        version: 1\n                    },\n                    type: {\n                        module: 'KBaseGenomes',\n                        name: 'Genome'\n                    },\n                    scientificName: 'Escherichia coli',\n                    feature: 'CF61_RS00005'\n                },\n                {\n                    object: {\n                        workspaceID: 43747,\n                        id: 4,\n                        version: 1\n                    },\n                    type: {\n                        module: 'KBaseGenomes',\n                        name: 'Genome'\n                    },\n                    scientificName: 'Escherichia coli',\n                    feature: 'CF61_RS00005'\n                }\n            ]\n\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    ...state,\n                    status: DBStatus.LOADED,\n                    linkedObjects\n                }\n            });\n        } catch (ex) {\n            this.set((state: LinkedObjectsDBState) => {\n                return {\n                    status: DBStatus.ERROR,\n                    error: {\n                        code: 'not-found',\n                        source: 'LinkedObjectsDB.getLinkedObjects',\n                        message: ex.message\n                    }\n                }\n            });\n        }\n    }\n\n}\n","import React from 'react';\nimport './style.css';\nimport { Table } from 'antd';\nimport { LinkedObject } from '../../../../types/ontology';\n\nexport interface Props {\n    linkedObjects: Array<LinkedObject>;\n}\n\ninterface State {\n\n}\n\nexport default class LinkedObjects extends React.Component<Props, State> {\n    renderTable() {\n        return <Table\n            dataSource={this.props.linkedObjects}\n            className=\"KBaseAntdOverride-remove-table-border ScrollingFlexTable\"\n            size=\"small\"\n            pagination={false}\n            scroll={{ y: '100%' }}\n            // rowKey=\"name\"\n            bordered={false}\n        >\n            <Table.Column\n                dataIndex={\"scientificName\"}\n                title=\"Scientific Name\"\n                width=\"40%\"\n            />\n            <Table.Column\n                dataIndex={\"type.name\"}\n                title=\"Type\"\n                width=\"30%\"\n            />\n            <Table.Column\n                dataIndex={\"feature\"}\n                title=\"Feature\"\n                width=\"30%\"\n            />\n        </Table>\n    }\n    renderNone() {\n        return (\n            <p style={{ fontStyle: 'italic' }}>\n                No objects use this term.\n            </p>\n        )\n    }\n    render() {\n        if (this.props.linkedObjects.length === 0) {\n            return this.renderNone();\n        }\n        return this.renderTable();\n    }\n}","import React from 'react';\nimport LinkedObjectsDB, { LinkedObjectsDBStateLoaded } from './LinkedObjectsDB';\nimport { DBStatus, DBStateError } from '../../../../lib/DB';\n\nimport { AppConfig } from '@kbase/ui-components';\nimport View from './view';\nimport { OntologyReference } from '../../../../types/ontology';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../../components/ErrorView';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    termRef: OntologyReference;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: LinkedObjectsDB;\n    constructor(props: Props) {\n        super(props);\n        this.db = new LinkedObjectsDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        return <ErrorView error={db.error} />\n    }\n\n    renderLoaded(db: LinkedObjectsDBStateLoaded) {\n        return (\n            <View\n                linkedObjects={db.linkedObjects}\n            />\n        );\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                this.db.getLinkedObjects(this.props.termRef);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n        }\n    }\n}\n","import { AppConfig } from '@kbase/ui-components';\nimport { StoreState } from '../../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps { }\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps() {\n    return {};\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import React from 'react';\nimport { FlexTabs } from '@kbase/ui-components';\nimport './style.css';\nimport { OntologyTerm, Synonym } from '../../../types/ontology';\nimport TermLink from '../TermLink';\nimport LinkedObjects from './LinkedObjects';\n\nexport interface DetailProps {\n    term: OntologyTerm\n}\n\ninterface DetailState {\n}\n\nexport default class Detail extends React.Component<DetailProps, DetailState> {\n    renderSynonyms(synonyms: Array<Synonym>) {\n        if (synonyms.length === 0) {\n            return <i>-</i>;\n        }\n        return synonyms.map((s, index) => {\n            return (\n                <div key={String(index)}>\n                    {s}\n                </div>\n            )\n        });\n    }\n\n    renderComments() {\n        if (this.props.term.comments.length === 0) {\n            return <i>-</i>;\n        }\n        return this.props.term.comments.map((comment, index) => {\n            return <p key={String(index)}>{comment}</p>\n        });\n    }\n\n    renderDetail() {\n        return (\n            <div className=\"InfoTable DetailTable\">\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\">\n                        ID\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        <TermLink term={this.props.term} newWindow={true} />\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\">\n                        Name\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        {this.props.term.name}\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\">\n                        Definition\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        {this.props.term.definition}\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\">\n                        Comments\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        {this.renderComments()}\n\n                    </div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\">\n                        Synonyms\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\">\n                                exact\n                                </div>\n                            <div className=\"InfoTable-dataCol\">\n                                {this.renderSynonyms(this.props.term.synonyms.exact)}\n                            </div>\n                        </div>\n\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\">\n                                narrow\n                                </div>\n                            <div className=\"InfoTable-dataCol\">\n                                {this.renderSynonyms(this.props.term.synonyms.narrow)}\n                            </div>\n                        </div>\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\">\n                                broad\n                                </div>\n                            <div className=\"InfoTable-dataCol\">\n                                {this.renderSynonyms(this.props.term.synonyms.broad)}\n                            </div>\n                        </div>\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\">\n                                related\n                                </div>\n                            <div className=\"InfoTable-dataCol\">\n                                {this.renderSynonyms(this.props.term.synonyms.broad)}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        )\n    }\n    renderGraph() {\n        return (\n            <div>\n                graph here...\n            </div>\n        )\n    }\n    renderLinkedObjects() {\n\n        return (\n            <LinkedObjects termRef={this.props.term.ref} />\n        )\n    }\n    renderMetadata() {\n        return (\n            <div>\n                render metadata here...\n            </div>\n        )\n    }\n\n    render() {\n        const tabs = [\n            {\n                tab: 'detail',\n                title: 'Detail',\n                component: this.renderDetail()\n            },\n            // {\n            //     tab: 'graph',\n            //     title: 'Graph',\n            //     component: this.renderGraph()\n            // },\n            {\n                tab: 'linked',\n                title: 'Linked Objects',\n                component: this.renderLinkedObjects()\n            },\n            // {\n            //     tab: 'metadata',\n            //     title: 'Metadata',\n            //     component: this.renderMetadata()\n            // }\n        ]\n        return (\n            <FlexTabs tabs={tabs} />\n        )\n    }\n}","import React from 'react';\n\nexport interface Props {\n\n}\n\ninterface State {\n\n}\n\nexport default class SourceInfo extends React.Component<Props, State> {\n    render() {\n        return (\n            <div className=\"Row\">\n                <div className=\"Col-auto\">\n                    <img src=\"images/go-logo.png\" style={{ height: '64px' }} alt=\"Gene Ontology Logo\" />\n                </div>\n                <div className=\"Col\">\n                    <div className=\"InfoTable\">\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                                Source\n                            </div>\n                            <div className=\"InfoTable-dataCol\">\n                                <a\n                                    href=\"http://geneontology.org/\"\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                >\n                                    Gene Ontology (GO)\n                                </a>\n                            </div>\n                        </div>\n                        <div className=\"InfoTable-row\">\n                            <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                                Version\n                            </div>\n                            <div className=\"InfoTable-dataCol\">SOME VERSION</div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n\n}","import React from 'react';\nimport { OntologyTerm } from '../../../types/ontology';\n\nexport interface Props {\n    term: OntologyTerm\n}\n\ninterface State {\n\n}\n\nexport default class TermSummary extends React.Component<Props, State> {\n    render() {\n        return (\n            <div className=\"InfoTable\">\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                        ID\n                    </div>\n                    <div className=\"InfoTable-dataCol\">{this.props.term.goID}</div>\n                </div>\n                <div className=\"InfoTable-row\">\n                    <div className=\"InfoTable-labelCol\" style={{ width: '5em' }}>\n                        Name\n                    </div>\n                    <div className=\"InfoTable-dataCol\">\n                        {this.props.term.name}\n                    </div>\n                </div>\n\n            </div>\n        );\n    }\n\n}","import React from 'react';\nimport { OntologyReference, OntologyTerm } from '../../../types/ontology';\nimport './style.css';\nimport Nav from '../Nav';\nimport Detail from '../Detail';\nimport { Row, Col } from 'antd';\nimport SourceInfo from './SourceInfo';\nimport TermSummary from './TermSummary';\n\nexport interface Props {\n    // termRef: OntologyReference;\n    targetTerm: OntologyTerm;\n    selectedTerm: OntologyTerm;\n    selectTerm: (termRef: OntologyReference) => void;\n    navigate: (termRef: OntologyReference) => void;\n    setTitle: (title: string) => void;\n}\n\ninterface State { }\n\nexport default class OntologyView extends React.Component<Props, State> {\n    componentDidMount() {\n        this.props.setTitle(`Ontology Landing Page ${this.props.targetTerm.name}`);\n    }\n\n    renderLayout() {\n        return (\n            <div className=\"Col scrollable Taxonomy\">\n                <div className=\"Col-auto Ontology-summary-section\">\n                    <Row>\n                        <Col span={12}>\n                            <TermSummary term={this.props.targetTerm} />\n                        </Col>\n                        <Col span={12}>\n                            <SourceInfo />\n                        </Col>\n                    </Row>\n                </div>\n                <div className=\"Row scrollable\">\n                    <div className=\"Col scrollable\" style={{ flex: '0 0 20em' }}>\n                        <Nav targetTerm={this.props.targetTerm} selectedTerm={this.props.selectedTerm} selectTerm={this.props.selectTerm.bind(this)} />\n                    </div>\n\n                    <div className=\"Col scrollable\" style={{ marginLeft: '10px' }}>\n                        <Detail term={this.props.selectedTerm} />\n                    </div>\n                </div>\n            </div>\n        )\n    }\n\n    render() {\n        return this.renderLayout();\n    }\n}\n","import React from 'react';\nimport OntologyDB, { OntologyDBStateLoaded } from './OntologyDB';\nimport { DBStatus, DBStateError } from '../../../lib/DB';\nimport { AppConfig } from '@kbase/ui-components';\nimport View from './view';\nimport { Icon } from 'antd';\nimport ErrorView from '../../../components/ErrorView';\nimport { OntologyReference } from '../../../types/ontology';\n\nexport interface Props {\n    token: string;\n    config: AppConfig;\n    termRef: OntologyReference;\n    // taxonID: TaxonID;\n    navigate: (termRef: OntologyReference) => void;\n    setTitle: (title: string) => void;\n}\n\ninterface State { }\n\nexport default class Data extends React.Component<Props, State> {\n    db: OntologyDB;\n    currentlyNavigatedOntologyRef: OntologyReference | null;\n    constructor(props: Props) {\n        super(props);\n        this.db = new OntologyDB({\n            onUpdate: () => {\n                this.forceUpdate();\n            },\n            initialData: {\n                status: DBStatus.NONE\n            },\n            token: props.token,\n            config: props.config\n        });\n        this.currentlyNavigatedOntologyRef = null;\n    }\n\n    selectTerm(termRef: OntologyReference) {\n        return this.db.setSelectedTerm(termRef);\n    }\n\n    navigateToTerm(termRef: OntologyReference) {\n        return this.props.navigate(termRef);\n    }\n\n    renderLoading() {\n        return <Icon type=\"loading\" />;\n    }\n\n    renderError(db: DBStateError) {\n        // NB this is rendered raw in the container, which is a flex row.\n        return (\n            <div className=\"Col\">\n                <div style={{ width: '50%', margin: '20px auto 0 auto' }}>\n                    <ErrorView error={db.error} />\n                </div>\n            </div>\n        );\n    }\n\n    renderLoaded(db: OntologyDBStateLoaded) {\n        return (\n            <View\n                targetTerm={db.targetTerm}\n                selectedTerm={db.selectedTerm}\n                selectTerm={this.selectTerm.bind(this)}\n                navigate={this.navigateToTerm.bind(this)}\n                setTitle={this.props.setTitle}\n            />\n        );\n    }\n\n    componentDidMount() {\n        this.db.getTargetTerm(this.props.termRef);\n    }\n\n    componentDidUpdate(previousProps: Props) {\n        if (previousProps.termRef.id !== this.props.termRef.id ||\n            previousProps.termRef.timestamp !== this.props.termRef.timestamp) {\n            this.db.getTargetTerm(this.props.termRef);\n        }\n    }\n\n    render() {\n        const db = this.db.get();\n        switch (db.status) {\n            case DBStatus.NONE:\n                // this.db.getTargetTaxon(this.props.taxonID);\n                return this.renderLoading();\n            case DBStatus.LOADING:\n                return this.renderLoading();\n            case DBStatus.ERROR:\n                return this.renderError(db);\n            case DBStatus.LOADED:\n                return this.renderLoaded(db);\n            // if (this.props.taxonID !== db.targetTaxon.id) {\n            //     this.db.getTargetTaxon(this.props.taxonID);\n            //     return this.renderLoaded(db);\n            // } else {\n            //     return this.renderLoaded(db);\n            // }\n        }\n    }\n}\n","import { AppConfig, sendTitle } from '@kbase/ui-components';\nimport { StoreState } from '../../../redux/store';\nimport DataComponent from './data';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../../redux/actions';\nimport { OntologyReference } from '../../../types/ontology';\nimport { ontologyNamespaceToString } from '../lib/model';\n\n\nexport interface OwnProps { }\n\nexport interface StateProps {\n    token: string;\n    config: AppConfig;\n}\n\nexport interface DispatchProps {\n    navigate: (ref: OntologyReference) => void;\n    setTitle: (title: string) => void;\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        app: { config }\n    } = state;\n    if (!userAuthorization) {\n        throw new Error('Invalid state - no user authorization');\n    }\n    return {\n        token: userAuthorization.token,\n        config\n    };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, props: OwnProps): DispatchProps {\n    return {\n        navigate: (ref: OntologyReference) => {\n            const relationEngineID = [\n                'ontology',\n                ontologyNamespaceToString(ref.namespace),\n                ref.id,\n                String(ref.timestamp)\n            ].join('/');\n            dispatch(navigate(relationEngineID) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(DataComponent);\n","import { RelationEngineID, StoreState } from '../../redux/store';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { navigate } from '../../redux/actions';\nimport { connect } from 'react-redux';\nimport Main from './Main';\nimport { sendTitle } from '@kbase/ui-components';\n\nexport interface OwnProps {\n}\n\nexport interface StateProps {\n}\n\nexport interface DispatchProps {\n    navigate: (relationEngineID: RelationEngineID) => void;\n    setTitle: (title: string) => void;\n}\n\nfunction mapStateToProps(state: StoreState, ownProps: OwnProps): StateProps {\n    return {};\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, ownProps: OwnProps): DispatchProps {\n    return {\n        navigate: (relationEngineId: RelationEngineID) => {\n            dispatch(navigate(relationEngineId) as any);\n        },\n        setTitle: (title: string) => {\n            dispatch(sendTitle(title) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(Main);\n","import React from 'react';\nimport { RootState } from '@kbase/ui-components';\nimport {\n    RelationEngineID,\n    Navigation,\n    ViewType,\n    NavigationSome\n} from '../../redux/store';\nimport Taxonomy from '../../landingPages/taxonomy';\nimport OntologyView from '../../landingPages/ontology';\n\nexport interface DispatcherProps {\n    token: string | null;\n    rootState: RootState;\n    // view: RelationEngineView;\n    navigation: Navigation;\n    trigger: number;\n    navigate: (relationEngineID: RelationEngineID) => void;\n}\n\ninterface DispatcherState { }\n\nexport class Dispatcher extends React.Component<DispatcherProps, DispatcherState> {\n    renderUnauthorized() {\n        return <div>Sorry, not authorized. Please log in first.</div>;\n    }\n\n    renderRootState() {\n        switch (this.props.rootState) {\n            case RootState.NONE:\n                return '';\n            case RootState.HOSTED:\n                return '';\n            case RootState.DEVELOP:\n                return '';\n            case RootState.ERROR:\n                return 'error';\n        }\n    }\n\n    renderNavigationNone() {\n        return <div>none</div>;\n    }\n\n    // renderNavigationLoading(view: RelationEngineViewLoading) {\n    //     return <Loading message=\"Loading view...\" />;\n    // }\n\n    // renderNavigationLoaded(view: RelationEngineViewLoaded) {\n    //     // This is currently how we dispatch to the type-specific\n    //     // landing page.\n    //     switch (view.relationEngineNodeType) {\n    //         case RelationEngineNodeType.TAXON:\n    //             return <Taxonomy taxonID={view.relationEngineID} />;\n    //     }\n    // }\n\n    // renderNavigationError(view: RelationEngineViewError) {\n    //     return <Alert type=\"error\" message={`View Error: ${view.message}`} />;\n    // }\n\n    renderNavigationSome(navigation: NavigationSome) {\n        // This is currently how we dispatch to the type-specific\n        // landing page.\n        switch (navigation.type) {\n            case ViewType.TAXONOMY:\n                return <Taxonomy taxonRef={navigation.ref} />;\n            case ViewType.ONTOLOGY:\n                console.log('navigation ref', navigation);\n                return <OntologyView termRef={navigation.ref} />;\n            default:\n                // TODO: make real error display.\n                console.error('Unhandled navigation', navigation);\n        }\n    }\n\n    renderNavigation() {\n        switch (this.props.navigation.type) {\n            case ViewType.NONE:\n                return this.renderNavigationNone();\n            default:\n                return this.renderNavigationSome(this.props.navigation);\n            // case ViewStatus.LOADING:\n            //     return this.renderNavigationLoading(this.props.view);\n            // case ViewStatus.LOADED:\n            //     return this.renderNavigationLoaded(this.props.view);\n            // case ViewStatus.ERROR:\n            //     return this.renderNavigationError(this.props.view);\n        }\n    }\n\n    parseHash(hash: string): { path: Array<string>; params: { relationEngineID: string } } {\n        const hashRe = /^#(.*?)\\/(.*)$/;\n        const m = hashRe.exec(hash);\n\n        if (!m) {\n            throw new Error('Invalid path');\n        }\n\n        // Just for now...\n        // TODO: for real\n\n        const [, path, relationEngineID] = m;\n\n        return {\n            path: [path],\n            params: { relationEngineID }\n        };\n    }\n\n    componentDidMount() {\n        if (this.props.rootState === RootState.DEVELOP) {\n            // Navigate on change of the hash\n            window.addEventListener('hashchange', (ev: HashChangeEvent) => {\n                const url = new URL(ev.newURL);\n                const hash = url.hash;\n                if (!hash) {\n                    throw new Error('no hash!');\n                }\n                const {\n                    params: { relationEngineID }\n                } = this.parseHash(hash);\n                this.props.navigate(relationEngineID);\n            });\n\n            // First time here, we also want to navigate based on the\n            // hash, or if empty (the default when a dev session starts)\n            // use some default interesting taxon id.\n            const hash = window.location.hash;\n            if (hash) {\n                const {\n                    params: { relationEngineID }\n                } = this.parseHash(hash);\n                this.props.navigate(relationEngineID);\n            } else {\n                // TODO: remove?\n                this.props.navigate('taxonomy/ncbi_taxonomy/562');\n            }\n        }\n    }\n\n    render() {\n        if (!this.props.token) {\n            return this.renderUnauthorized();\n        }\n        return (\n            <div className=\"Col scrollable\">\n                <div className=\"Row-auto\">{this.renderRootState()}</div>\n                <div className=\"Row  scrollable\">{this.renderNavigation()}</div>\n            </div>\n        );\n    }\n}\n","import { StoreState, RelationEngineID, Navigation } from '../../redux/store';\nimport { Dispatch } from 'react';\nimport { Action } from 'redux';\nimport { connect } from 'react-redux';\nimport { Dispatcher } from './Dispatcher';\nimport { RootState } from '@kbase/ui-components';\nimport { navigate } from '../../redux/actions';\n\ninterface OwnProps { }\n\ninterface StateProps {\n    token: string | null;\n    rootState: RootState;\n    // view: RelationEngineView;\n    // viewState: ViewStatus;\n    navigation: Navigation;\n    trigger: number;\n}\n\ninterface DispatchProps {\n    navigate: (relationEngineID: RelationEngineID) => void;\n}\n\nfunction mapStateToProps(state: StoreState, props: OwnProps): StateProps {\n    const {\n        auth: { userAuthorization },\n        root: { state: rootState },\n        navigation,\n        trigger\n    } = state;\n\n    // Auth integration.\n    let token;\n    if (!userAuthorization) {\n        token = null;\n    } else {\n        token = userAuthorization.token;\n    }\n\n    return { token, rootState, navigation, trigger };\n}\n\nfunction mapDispatchToProps(dispatch: Dispatch<Action>, ownProps: OwnProps): DispatchProps {\n    return {\n        navigate: (relationEngineID: RelationEngineID) => {\n            dispatch(navigate(relationEngineID) as any);\n        }\n    };\n}\n\nexport default connect<StateProps, DispatchProps, OwnProps, StoreState>(\n    mapStateToProps,\n    mapDispatchToProps\n)(Dispatcher);\n","import React from 'react';\nimport { Provider } from 'react-redux';\nimport { createReduxStore } from './redux/store';\nimport { AppBase, AuthGate } from '@kbase/ui-components';\nimport './App.css';\nimport Dispatcher from './components/dispatcher';\nimport { Unsubscribe } from 'redux';\nimport { navigate } from './redux/actions';\n\nconst store = createReduxStore();\n\ninterface AppProps { }\n\ninterface AppState { }\n\nexport default class App<AppProps, AppState> extends React.Component {\n    storeUnsubscribe: Unsubscribe | null;\n    constructor(props: AppProps) {\n        super(props);\n        this.storeUnsubscribe = null;\n    }\n    componentDidMount() {\n        let last: {\n            view: string | null;\n            params: { [key: string]: string };\n        } = {\n            view: null,\n            params: {}\n        };\n        this.storeUnsubscribe = store.subscribe(() => {\n            const state = store.getState();\n            if (!state) {\n                return;\n            }\n            const {\n                app: {\n                    runtime: { navigation }\n                },\n                auth: { userAuthorization }\n            } = state;\n\n            // This is a bit of a cheat.\n            if (!userAuthorization) {\n                return;\n            }\n\n            const view = navigation.view;\n            const params = navigation.params as { [key: string]: string };\n\n            if (\n                view !== last.view ||\n                last.params === null ||\n                Object.keys(params).some((key) => {\n                    return params[key] !== last.params[key];\n                })\n            ) {\n                last.params = params;\n                last.view = view;\n                // TODO: store may change but there is not navigation yet.\n                if (params['relationEngineID']) {\n                    store.dispatch(navigate(params['relationEngineID']) as any);\n                }\n            }\n        });\n    }\n    componentWillUnmount() {\n        if (this.storeUnsubscribe) {\n            this.storeUnsubscribe();\n        }\n    }\n    render() {\n        return (\n            <Provider store={store}>\n                <AppBase>\n                    <AuthGate required={true}>\n                        <div className=\"App Col scrollable\">\n                            <Dispatcher />\n                        </div>\n                    </AuthGate>\n                </AppBase>\n            </Provider>\n        );\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}