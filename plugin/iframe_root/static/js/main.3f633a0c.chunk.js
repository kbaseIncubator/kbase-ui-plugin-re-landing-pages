(window["webpackJsonpreact-app"]=window["webpackJsonpreact-app"]||[]).push([[0],{379:function(e){e.exports=JSON.parse('[[0,"Unspecified"],[1,"Standard"],[2,"Vertebrate Mitochondrial"],[3,"Yeast Mitochondrial"],[4,"Mold Mitochondrial; Protozoan Mitochondrial; Coelenterate Mitochondrial; Mycoplasma; Spiroplasma"],[5,"Invertebrate Mitochondrial"],[6,"Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear"],[9,"Echinoderm Mitochondrial; Flatworm Mitochondrial"],[10,"Euplotid Nuclear"],[11,"Bacterial, Archaeal and Plant Plastid"],[12,"Alternative Yeast Nuclear"],[13,"Ascidian Mitochondrial"],[14,"Alternative Flatworm Mitochondrial"],[15,"Blepharisma Macronuclear"],[16,"Chlorophycean Mitochondrial"],[21,"Trematode Mitochondrial"],[22,"Scenedesmus obliquus mitochondrial"],[23,"Thraustochytrium mitochondrial code"],[24,"Pterobranchia Mitochondrial"],[25,"Candidate Division SR1 and Gracilibacteria"],[26,"Pachysolen tannophilus Nuclear"],[27,"Karyorelict Nuclear"],[28,"Condylostoma Nuclear"],[29,"Mesodinium Nuclear"],[30,"Peritrich Nuclear"],[31,"Blastocrithidia Nuclear"],[32,"Balanophoraceae Plastid"],[33,"Cephalodiscidae Mitochondrial"]]')},385:function(e,t,n){e.exports=n(806)},390:function(e,t,n){},769:function(e,t,n){},774:function(e,t,n){},775:function(e,t,n){},777:function(e,t,n){},786:function(e,t,n){},787:function(e,t,n){},794:function(e,t,n){},795:function(e,t,n){},796:function(e,t,n){},797:function(e,t,n){},798:function(e,t,n){},799:function(e,t,n){},800:function(e,t,n){},801:function(e,t,n){},802:function(e,t,n){},803:function(e,t,n){},804:function(e,t,n){},805:function(e,t,n){},806:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(10),o=n.n(i),s=(n(390),n(13)),c=n(15),l=n(19),u=n(16),m=n(18),p=n(40),d=n(63),f=n(44),h=n(142),v=n(378),g=n(21),b=n.n(g),O=n(50),y=n(34),E=n(382),T=n(80),k=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getNodeInfo",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=/^(.*?)\/(.*)$/,a=/^([^\/]+)\/([^\/]+)(?:\/([^\/]+))?$/,r=/^([^\/]+)\/([^\/]+)(?:\/([^\/]+))?$/,e.abrupt("return",new Promise((function(e,i){var o=n.exec(t);if(o){var s=o,c=Object(O.a)(s,3),l=c[1],u=c[2];switch(l){case"taxonomy":!function(){if(o=a.exec(u)){4!==o.length&&i(new Error('Invalid relation engine id "'+t+'"'));var n,r=o,s=Object(O.a)(r,4),c=s[1],l=s[2],m=s[3];switch(n=m?parseInt(m,10):Date.now(),c){case"ncbi_taxonomy":return void e([{collection:"taxonomy",namespace:c,id:l,timestamp:n,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:i(new Error('Unrecognized taxonomy namespace "'+c+'"'))}}else i(new Error("Taxonomy ref is "))}();break;case"ontology":if(!(o=r.exec(u)))return void i(new Error("Taxonomy ref is "));var m,p=o,d=Object(E.a)(p),f=d[1],h=d[2],v=d.slice(3);switch(m=v.length?parseInt(v[0]):Date.now(),f){case"go_ontology":return void e([{collection:"ontology",namespace:f,id:h,timestamp:m,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:return void i(new Error('Ontology namespace not found "'+f+'"'))}default:i(new Error("Collection ".concat(l," does not resolve to a type")))}}else i(new Error("Invalid relation engine ID "+t))})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(T.DynamicServiceClient);k.module="relation_engine_api";var j,x,N,w,R,I,C,D,L,A=n(193);Object(A.a)(Error);function S(e){switch(e){case N.TAXONOMY:return"taxonomy";case N.ONTOLOGY:return"ontology"}}function P(e){switch(e){case w.NCBI:return"ncbi_taxonomy";case w.GTDB:return"gtdb"}}function G(e){switch(e){case"ncbi_taxonomy":return w.NCBI;case"gtdb":return w.GTDB;default:throw new Error('Unrecognized namespace "'+e+'"')}}function _(e){switch(e){case"go_ontology":return R.GO;default:throw new Error("Ontology namespace not supported: "+e)}}function M(e){switch(e){case R.GO:return"go_ontology"}}function B(e){return{type:L.NAVIGATE_SUCCESS,navigation:e}}function z(e){return function(){var t=Object(y.a)(b.a.mark((function t(n,a){var r,i,o,s,c,l,u;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:L.NAVIGATE_START}),console.log("navigating...",e),r=a(),i=r.auth.userAuthorization,o=r.app.config.services.ServiceWizard.url,i){t.next=5;break}return t.abrupt("return");case 5:return s=new k({url:o,token:i.token}),t.prev=6,t.next=9,s.getNodeInfo(e);case 9:c=t.sent,l=Object(O.a)(c,1),u=l[0],t.t0=u.collection,t.next="taxonomy"===t.t0?15:"ontology"===t.t0?17:19;break;case 15:return n(B({type:W.TAXONOMY,ref:{collection:N.TAXONOMY,namespace:G(u.namespace),id:u.id,timestamp:u.timestamp}})),t.abrupt("break",19);case 17:return n(B({type:W.ONTOLOGY,ref:{collection:N.ONTOLOGY,namespace:_(u.namespace),id:u.id,timestamp:u.timestamp}})),t.abrupt("break",19);case 19:t.next=25;break;case 21:t.prev=21,t.t1=t.catch(6),console.error("ERROR",t.t1),n((m=t.t1.message,{type:L.NAVIGATE_ERROR,message:m}));case 25:case"end":return t.stop()}var m}),t,null,[[6,21]])})));return function(e,n){return t.apply(this,arguments)}}()}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function F(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{navigation:t.navigation,trigger:Date.now()})}!function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(j||(j={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(x||(x={})),function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(N||(N={})),function(e){e[e.NCBI=0]="NCBI",e[e.GTDB=1]="GTDB"}(w||(w={})),function(e){e[e.GO=0]="GO"}(R||(R={})),function(e){e[e.GO=0]="GO"}(I||(I={})),function(e){e.IS_A="OntologyRelation$is_a",e.PART_OF="OntologyRelation$part_of"}(C||(C={})),function(e){e[e.EXACT=0]="EXACT",e[e.NARROW=1]="NARROW",e[e.BROAD=2]="BROAD",e[e.RELATED=3]="RELATED"}(D||(D={})),function(e){e.NAVIGATE="kbase-ui-plugin-landing-pages/navigate",e.NAVIGATE_START="kbase-ui-plugin-landing-pages/navigate/start",e.NAVIGATE_SUCCESS="kbase-ui-plugin-landing-pages/navigate/success",e.NAVIGATE_ERROR="kbase-ui-plugin-landing-pages/navigate/error"}(L||(L={}));var W,Y,X,V=function(e,t){var n=Object(f.baseReducer)(e,t);if(n)return n;if(!e)return e;switch(t.type){case L.NAVIGATE_SUCCESS:return F(e,t)}return e};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function H(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(f.makeBaseStoreState)(),{navigation:{type:W.NONE},trigger:0})}!function(e){e[e.NONE=0]="NONE",e[e.TAXONOMY=1]="TAXONOMY",e[e.ONTOLOGY=2]="ONTOLOGY"}(W||(W={})),function(e){e[e.TAXON=0]="TAXON",e[e.ONTOLOGY_TERM=1]="ONTOLOGY_TERM"}(Y||(Y={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(X||(X={}));n(769),n(79);var q,$=n(8);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.RELOADING=3]="RELOADING",e[e.ERROR=4]="ERROR"}(q||(q={}));var J=function(){function e(t){Object(s.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(c.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),Q=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLineage",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,a=t.id,r=t.ts,i={ns:n,id:a,ts:r},e.next=4,this.callFunc("get_lineage",[i]);case 4:return o=e.sent,s=Object(O.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c,l,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,a=t.id,r=t.ts,i=t.offset,o=t.limit,s=t.searchTerm,e.next=3,this.callFunc("get_children",[{ns:n,id:a,ts:r,offset:i,limit:o,search_text:s}]);case 3:return c=e.sent,l=Object(O.a)(c,1),u=l[0],e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,a=t.id,r=t.ts,i={ns:n,id:a,ts:r},e.next=4,this.callFunc("get_taxon",[i]);case 4:return o=e.sent,s=Object(O.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWorkspaceObjects",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c,l,u;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxon_ns,a=t.taxon_id,r=t.ts,i=t.offset,o=t.limit,s={taxon_ns:n,taxon_id:a,ts:r,limit:o,offset:i},e.next=4,this.callFunc("get_associated_ws_objects",[s]);case 4:return c=e.sent,l=Object(O.a)(c,1),u=l[0],e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(T.DynamicServiceClient);Q.module="taxonomy_re_api";var Z=function(){function e(t){var n=t.token,a=t.url;Object(s.a)(this,e),this.taxonomyClient=void 0,this.taxonomyClient=new Q({token:n,url:a})}return Object(c.a)(e,[{key:"getLineage",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,a=t.id,r=t.timestamp,e.next=3,this.taxonomyClient.getLineage({ns:P(n),id:a,ts:r});case 3:return i=e.sent,o=i.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:N.TAXONOMY,namespace:w.NCBI,id:e.id,timestamp:i.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(b.a.mark((function e(t,n){var a,r,i,o,s;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.namespace,r=t.id,i=t.timestamp,e.next=3,this.taxonomyClient.getChildren({ns:P(a),id:r,ts:i,offset:n.offset,limit:n.limit,searchTerm:n.searchTerm});case 3:return o=e.sent,s=o.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:N.TAXONOMY,namespace:w.NCBI,id:e.id,timestamp:o.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",[s,o.total_count]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,a=t.id,r=t.timestamp,e.next=3,this.taxonomyClient.getTaxon({ns:P(n),id:a,ts:r});case 3:return i=e.sent,o=i.results[0],s="root"!==o.scientific_name&&"cellular organisms"!==o.scientific_name,c={ref:{collection:N.TAXONOMY,namespace:w.NCBI,id:o.id,timestamp:i.ts},name:o.scientific_name,rank:o.rank,ncbiID:o.NCBI_taxon_id,geneticCode:parseInt(o.gencode),aliases:o.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:s},e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedObjects",value:function(){var e=Object(y.a)(b.a.mark((function e(t,n){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={taxon_ns:P(t.namespace),taxon_id:t.id,ts:t.timestamp,offset:n.offset,limit:n.limit},e.next=3,this.taxonomyClient.getAssociatedWorkspaceObjects(a);case 3:return r=e.sent,e.abrupt("return",r.results.map((function(e){return{linkedAt:e.edge.updated_at,objectID:e.ws_obj.object_id,workspaceID:e.ws_obj.workspace_id,version:e.ws_obj.version,objectName:e.ws_obj.name,createdAt:e.ws_obj.epoch,workspaceUpdatedAt:e.ws_obj.updated_at}})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ee(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ee(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ne=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getTargetTaxon",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return te({},e,{status:q.LOADING})})),n=new Z({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getTaxon(t);case 5:a=e.sent,this.set((function(e){return te({},e,{status:q.LOADED,targetTaxon:a,selectedTaxon:a})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonDB.getTargetTaxon",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedTaxon",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new Z({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=4,n.getTaxon(t);case 4:a=e.sent,this.set((function(e){return te({},e,{selectedTaxon:a})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonDB.getSelectedTaxon",message:e.t0.message}}}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(J),ae=(n(771),n(83)),re=(n(773),n(54)),ie=(n(774),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"Row"},r.a.createElement("div",{className:"Col-auto"},r.a.createElement("img",{src:"images/ncbi-logo.jpg",style:{height:"64px"},alt:"NCBI Logo"})),r.a.createElement("div",{className:"Col"},r.a.createElement("div",{className:"InfoTable"},r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),r.a.createElement("div",{className:"InfoTable-dataCol"},r.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/guide/taxonomy/",target:"_blank",rel:"noopener noreferrer"},"NCBI"))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),r.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(r.a.Component)),oe=(n(775),n(130),n(36)),se=(n(777),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"clickTaxon",value:function(){this.props.selectTaxonRef(this.props.taxon.ref)}},{key:"clickNavigateToTaxon",value:function(){var e=["review",S(this.props.taxon.ref.collection),P(this.props.taxon.ref.namespace),this.props.taxon.ref.id,String(this.props.taxon.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),r.a.createElement("div",{className:"TaxonItem-inspector",onClick:this.clickTaxon.bind(this)},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),r.a.createElement("div",{className:"TaxonItem-inspector"},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"TaxonItem-name"},this.props.taxon.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.taxon,t=["TaxonItem"];this.props.isActive&&t.push("TaxonItem-active");var n=r.a.createElement("div",null,r.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),r.a.createElement("div",null,e.rank));return r.a.createElement(oe.a,{title:n,placement:"right"},r.a.createElement("div",{className:t.join(" "),key:this.props.taxon.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(r.a.Component)),ce=(n(182),n(74));function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var me=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchChildren",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c,l,u,m,p;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,a=t.page,r=t.pageSize,i=t.searchTerm,e.prev=1,this.set((function(e){return e.status===q.LOADED?ue({},e,{status:q.RELOADING}):ue({},e,{status:q.LOADING})})),o=new Z({token:this.token,url:this.serviceWizardURL}),s=(a-1)*r,c=r,e.next=8,o.getChildren(n,{offset:s,limit:c,searchTerm:i});case 8:l=e.sent,u=Object(O.a)(l,2),m=u[0],p=u[1],this.set((function(e){return ue({},e,{status:q.LOADED,taxa:m,total:p,page:a,pageSize:r})})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonChildrenDB.fetchChildren",message:e.t0.message}}}));case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(J),pe=(n(354),n(75)),de=(n(782),n(88)),fe=(n(250),n(69)),he=(n(155),n(59)),ve=(n(786),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectTaxon",value:function(e){this.props.selectTaxonRef(e)}},{key:"navigateToTaxon",value:function(e){this.props.navigateToTaxonRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.taxa.map((function(t,n){var a=null!==e.props.selectedTaxonRef&&e.props.selectedTaxonRef.id===t.ref.id;return r.a.createElement(se,{taxon:t,isActive:a,selectTaxonRef:e.selectTaxon.bind(e),key:String(n),navigateToTaxonRef:e.navigateToTaxon.bind(e)})}))}},{key:"renderNoItems",value:function(){return r.a.createElement(he.a,{description:"No Children",image:he.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.taxa.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(r.a.Component)),ge=(n(787),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderMessage",value:function(){return r.a.createElement("span",null,r.a.createElement($.a,{type:"exclamation-circle",style:{color:"red"}})," ",this.props.error.message)}},{key:"render",value:function(){return r.a.createElement(ce.a,{type:"error",message:this.renderMessage()})}}]),t}(r.a.Component)),be=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).searchTerm=void 0,n.page=void 0,n.pageSize=void 0,n.searchTerm="",n.page=1,n.pageSize=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchChildren(this.props.taxonRef,1,10,"")}},{key:"renderTaxaNone",value:function(){return r.a.createElement("div",null,"None")}},{key:"renderTaxaLoading",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderTitleLoaded",value:function(e){if(0===e.total)return r.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"No Children");var t=Intl.NumberFormat("en-US",{useGrouping:!0}).format(e.total),n=(e.page-1)*e.pageSize+1,a=n+e.taxa.length-1;return r.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"Children (",n,"-",a," of ",t,")")}},{key:"renderTitleReLoading",value:function(e){return r.a.createElement(fe.a,{size:"small"},this.renderTitleLoaded(e))}},{key:"renderTitle",value:function(){var e=this.props.db;switch(e.status){case q.NONE:case q.LOADING:return r.a.createElement("div",null,"Loading...");case q.ERROR:return r.a.createElement(ge,{error:e.error});case q.LOADED:return this.renderTitleLoaded(e);case q.RELOADING:return this.renderTitleReLoading(e)}}},{key:"doSearch",value:function(e){this.searchTerm=e,this.props.fetchChildren(this.props.taxonRef,1,this.pageSize||10,e)}},{key:"renderSearch",value:function(){var e=this.props.db.status!==q.LOADED||this.props.db.total<=this.props.db.pageSize&&!this.searchTerm;return r.a.createElement("div",{style:{marginBottom:"4px"}},r.a.createElement(de.a.Search,{placeholder:"Search Children",onSearch:this.doSearch.bind(this),disabled:e}))}},{key:"renderTaxaLoaded",value:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ve,{taxa:e.taxa,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:e.total,maxItems:10}))}},{key:"renderTaxaReLoading",value:function(e){return r.a.createElement(fe.a,{tip:"Loading"},this.renderTaxaLoaded(e))}},{key:"renderTaxaError",value:function(e){return r.a.createElement(ge,{error:e.error})}},{key:"renderTaxa",value:function(){switch(this.props.db.status){case q.NONE:return this.renderTaxaNone();case q.LOADING:return this.renderTaxaLoading();case q.LOADED:return this.renderTaxaLoaded(this.props.db);case q.RELOADING:return this.renderTaxaReLoading(this.props.db);case q.ERROR:return this.renderTaxaError(this.props.db)}}},{key:"changePage",value:function(e,t){this.page=e,this.pageSize=t||10,this.props.fetchChildren(this.props.taxonRef,this.page,this.pageSize,this.searchTerm)}},{key:"renderPaginationNone",value:function(){return r.a.createElement(pe.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoading",value:function(){return r.a.createElement(pe.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationError",value:function(){return r.a.createElement(pe.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoaded",value:function(e){return r.a.createElement(pe.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,onChange:this.changePage.bind(this)})}},{key:"renderPaginationReLoading",value:function(e){return r.a.createElement(pe.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,disabled:!0})}},{key:"renderPagination",value:function(){var e=this.props.db;switch(e.status){case q.NONE:return this.renderPaginationNone();case q.LOADING:return this.renderPaginationLoading();case q.ERROR:return this.renderPaginationError();case q.LOADED:return this.renderPaginationLoaded(e);case q.RELOADING:return this.renderPaginationReLoading(e)}}},{key:"renderChildren",value:function(){return r.a.createElement("div",null,this.renderTitle(),this.renderSearch(),this.renderPagination(),this.renderTaxa())}},{key:"render",value:function(){return this.renderChildren()}}]),t}(r.a.Component),Oe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new me({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"fetchChildren",value:function(e,t,n,a){return this.db.fetchChildren({taxonRef:e,page:t,pageSize:n,searchTerm:a})}},{key:"renderSuccess",value:function(e){return r.a.createElement(be,{db:e,taxonRef:this.props.taxonRef,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,fetchChildren:this.fetchChildren.bind(this)})}},{key:"renderError",value:function(e){return r.a.createElement(ce.a,{type:"error",message:e.error.message})}},{key:"renderTest",value:function(){return"test"}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.ERROR:return this.renderError(e);default:return this.renderSuccess(e)}}}]),t}(r.a.Component);var ye=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}}),(function(){return{}}))(Oe);function Ee(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ee(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ee(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ke=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLineage",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return Te({},e,{status:q.LOADING})})),n=new Z({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getLineage(t);case 5:a=e.sent,this.set((function(e){return Te({},e,{status:q.LOADED,lineage:a})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"LineageDB.getLineage",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(J),je=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(ve,{taxa:this.props.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:this.props.lineage.length,maxItems:10})}}]),t}(r.a.Component),xe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new ke({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case q.NONE:this.db.getLineage(this.props.taxonRef)}}},{key:"componentWillUnmount",value:function(){}},{key:"renderLoading",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderError",value:function(e){return r.a.createElement(ge,{error:e.error})}},{key:"renderLoaded",value:function(e){return r.a.createElement(je,{lineage:e.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(r.a.Component);var Ne=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}}),(function(){return{}}))(xe),we=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"onClick",value:function(e){this.props.selectTaxonRef(e)}},{key:"clickTaxon",value:function(e){this.props.selectTaxonRef(e.ref)}},{key:"renderLineage",value:function(){return r.a.createElement(Ne,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:this.props.selectedTaxon.ref,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderChildrenCount",value:function(e){return 0===e?r.a.createElement("div",{className:""},"No children"):1===e?r.a.createElement("div",null,"One child"):r.a.createElement("div",null,Intl.NumberFormat("en-US",{useGrouping:!0}).format(e)," ","children")}},{key:"renderChildren",value:function(){var e;return e=this.props.selectedTaxon?this.props.selectedTaxon.ref:null,r.a.createElement(ye,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderTargetTaxon",value:function(){var e=this.props.selectedTaxon&&this.props.selectedTaxon.ref.id===this.props.targetTaxon.ref.id&&this.props.selectedTaxon.ref.timestamp===this.props.targetTaxon.ref.timestamp;return r.a.createElement(se,{taxon:this.props.targetTaxon,isActive:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){return r.a.createElement("div",{className:"Col scrollable"},r.a.createElement("div",{className:"Col-auto Lineage-box"},r.a.createElement("div",{className:"Lineage-box-title"},"Lineage"),this.renderLineage()),r.a.createElement("div",{className:"Col-auto Lineage-box Lineage-target-taxon"},this.renderTargetTaxon()),r.a.createElement("div",{className:"Col-auto scrollable Lineage-box"},this.renderChildren()))}}]),t}(r.a.Component),Re=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={};return"species"===this.props.taxon.rank&&(e={fontStyle:"italic"}),r.a.createElement("div",{className:"InfoTable"},r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),r.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Rank"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)))}}]),t}(r.a.Component),Ie=(n(788),n(91)),Ce=(n(251),n(70));var De=function(e){if(!(e instanceof Array))throw new Error("Invalid genetic codes file!");return e.map((function(e){var t=Object(O.a)(e,2),n=t[0],a=t[1];if("number"!==typeof n)throw new Error("Invalid genetic code id in file");if("string"!==typeof a)throw new Error("Invalid genetic code label in file");return[n,a]}))}(n(379)).reduce((function(e,t){var n=Object(O.a)(t,2),a=n[0],r=n[1];return e.set(a,r),e}),new Map),Le=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderAliases",value:function(){var e=function(e,t){var n=e.replace(/^["']/,""),a=t.replace(/^["']/,"");return n.localeCompare(a)};return r.a.createElement(Ce.a,{dataSource:this.props.taxon.aliases,className:"KBaseAntdOverride-remove-table-border",size:"small",pagination:!1,scroll:{y:"25em"},rowKey:"name",bordered:!1},r.a.createElement(Ce.a.Column,{title:"Name",dataIndex:"name",key:"name",defaultSortOrder:"ascend",sorter:function(t,n){return e(t.name,n.name)}}),r.a.createElement(Ce.a.Column,{title:"Category",dataIndex:"category",key:"category",width:"20em",sorter:function(t,n){return e(t.category,n.category)}}))}},{key:"renderTaxonDetail",value:function(){var e={};return"species"===this.props.taxon.rank&&(e.fontStyle="italic"),r.a.createElement("div",{className:"InfoTable"},r.a.createElement("div",{className:"InfoTable-row",key:"name"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Name"),r.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),r.a.createElement("div",{className:"InfoTable-row",key:"rank"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Rank"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)),r.a.createElement("div",{className:"InfoTable-row",key:"ncbiid"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"NCBI ID"),r.a.createElement("div",{className:"InfoTable-dataCol"},r.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=".concat(this.props.taxon.ncbiID),target:"_blank",rel:"noopener noreferrer"},this.props.taxon.ncbiID))),r.a.createElement("div",{className:"InfoTable-row",key:"genetic-code"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Genetic Code"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.geneticCode," -"," ",De.get(this.props.taxon.geneticCode)||"Unknown")),r.a.createElement("div",{className:"InfoTable-row",key:"aliases"},r.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Aliases"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAliases())))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderTaxonDetail())}}]),t}(r.a.Component),Ae=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.taxon;switch(e.ref.namespace){case w.NCBI:return r.a.createElement(Le,{taxon:e});default:return r.a.createElement(ce.a,{type:"error",message:"This taxon type is not supported"})}}}]),t}(r.a.Component);function Se(e,t,n){if("string"===typeof t)t=t.split(".");else if(!(t instanceof Array))throw new TypeError("Invalid type for key: "+typeof t);for(var a=e,r=0;r<t.length;r+=1){if(void 0===a||"object"!==typeof a||null===a)return n;a=a[t[r]]}return void 0===a?n:a}var Pe,Ge=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).name="NotFound",n}return Object(m.a)(t,e),t}(Object(A.a)(Error)),_e="https://en.wikipedia.org/w/api.php",Me=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"scrubTerm",value:function(e){var t=e.split(""),n=/[\w \s]/;return t.filter((function(e){return!!n.exec(e)})).join("")}},{key:"findTerm",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Empty term passed");case 2:return n=this.scrubTerm(t),e.abrupt("return",this.getWikipediaInfo(n).then((function(e){var t=e.imageUrl,n=e.pageUrl,a=e.introText,r=e.title,i=e.pageId,o=e.matchingTerms,s=e.exactMatch;return{imageUrl:t,pageUrl:n,introText:a.replace(/====/g,"####").replace(/===/g,"###").replace(/==/g,"##").replace(/\n/g,"  \n"),title:r,pageId:i,matchingTerms:o,exactMatch:s}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWikipediaInfo",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n=this;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPage(t).then((function(e){var t=e.wikiResponse,a=e.matchingTerms,r=e.exactMatch;return Promise.all([n.getImage({size:500,pageId:t.parse.pageid}),n.getPageInfo({pageId:t.parse.pageid})]).then((function(e){var n=Object(O.a)(e,2),i=n[0],o=n[1];return{imageUrl:i,pageUrl:o.url,introText:o.introText,title:t.parse.title,pageId:t.parse.pageid,matchingTerms:a,exactMatch:r}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/),a=!0,e.abrupt("return",new Promise((function(e,r){!function n(i){0===i.length&&r(new Ge('No Wikipedia page found matching "'+t+'"'));var o=new URL(_e),s=o.searchParams;s.set("action","parse"),s.set("format","json"),s.set("prop","text|headhtml"),s.set("section","0"),s.set("redirects",""),s.set("page",i.join(" "));s.set("origin","*"),fetch(o.toString(),{method:"GET",headers:{accept:"application/json"}}).then((function(t){switch(t.status){case 200:try{return t.json().then((function(t){if(t.error){if("missingtitle"===t.error.code)return i.pop(),a=!1,n(i),null;console.error("wikipedia api error",t),r(new Error("Wikipedia api error: "+t.error.code))}else e({wikiResponse:t,matchingTerms:i,exactMatch:a})}))}catch(s){r(new Error("Error parsing wikipedia response: "+s.message))}break;default:var o="Unexpected response from wikipedia api: "+t.status;console.error(o,t),r(new Error(o))}})).catch((function(e){r(e)}))}(n)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPageInfo",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageId,a=new URL(_e),(r=a.searchParams).set("action","query"),r.set("pageids",n),r.set("prop","info|extracts"),r.set("explaintext","true"),r.set("inprop","url"),r.set("origin","*"),r.set("format","json"),e.abrupt("return",fetch(a.toString(),{method:"GET"}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return{url:Se(e,["query","pages",String(n),"fullurl"],null),introText:Se(e,["query","pages",String(n),"extract"],null)}}))}catch(a){throw console.error("error getting page info",a.message),a}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.size,a=t.pageId,r=new URL(_e),(i=r.searchParams).set("action","query"),i.set("format","json"),i.set("prop","pageimages"),i.set("pithumbsize",String(n)),i.set("pageids",String(a)),i.set("origin","*"),o={accept:"application/json"},e.abrupt("return",fetch(r.toString(),{method:"GET",headers:o}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return Se(e,["query","pages",String(a),"thumbnail","source"],null)}))}catch(n){throw new Error("Error parsing wikipedia response: "+n.message)}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})).catch((function(e){var t="Error getting image from wikipedia: "+e.message;throw console.error(t,e),new Error("Error getting image from wikipedia: "+e.message)})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Be=n(380),ze=n.n(Be),Ue=(n(794),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"Loading-box"},r.a.createElement(fe.a,{size:"large"}),r.a.createElement("br",null),this.props.message)}}]),t}(r.a.Component));n(795);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(Pe||(Pe={}));var Fe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).wikipediaClient=void 0,n.canceled=void 0,n.wikipediaClient=new Me,n.canceled=!1,n.state={state:Pe.NONE},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){this.canceled=!0}},{key:"renderArticle",value:function(e){var t=ze()(e.introText);return r.a.createElement("div",{style:{overflow:"auto"},dangerouslySetInnerHTML:{__html:t}})}},{key:"renderImage",value:function(e){return e.imageUrl?r.a.createElement("div",null,r.a.createElement("img",{src:e.imageUrl,style:{width:"100%"},alt:"".concat(this.props.term)})):r.a.createElement("div",{className:"Wikipedia-empty-image"},r.a.createElement("div",{className:"-content"},"Image not found"))}},{key:"renderMatch",value:function(e){if(e.exactMatch){var t=r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{type:"check",style:{color:"green"}}),' Exact match on "',e.matchingTerms.join(" "),'"');return r.a.createElement(ce.a,{type:"success",message:t})}var n=r.a.createElement(r.a.Fragment,null,r.a.createElement($.a,{type:"warning",style:{color:"orange"}}),' Inexact match on: "',e.matchingTerms.join(" "),'"');return r.a.createElement(ce.a,{type:"warning",message:n})}},{key:"renderWikipediaLogoCredit",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{style:{borderBottom:"1px solid gray"}},"Link to the original Wikipedia entry"),r.a.createElement("div",{style:{fontSize:"80%"}},r.a.createElement("p",{style:{textAlign:"center"}},"credit:",r.a.createElement("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",title:"Creative Commons Attribution-ShareAlike 3.0",target:"_blank",rel:"noopener noreferrer"},"CC BY-SA 3.0"),r.a.createElement("a",{href:"https://en.wikipedia.org/w/index.php?curid=33285413",target:"_blank",rel:"noopener noreferrer"},"Link"))))}},{key:"renderWikipediaInfo",value:function(e){return r.a.createElement("div",{className:"Row scrollable"},r.a.createElement("div",{className:"Col Col-grow-2 scrollable"},r.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"}},r.a.createElement("div",{style:{flex:"1 1 0px"}},this.renderMatch(e)),r.a.createElement("div",{style:{flex:"0 0 auto",alignSelf:"center",marginLeft:"10px"}},r.a.createElement("div",{style:{height:"32px",textAlign:"center"}},r.a.createElement(oe.a,{title:this.renderWikipediaLogoCredit()},r.a.createElement("a",{href:e.pageUrl,target:"_blank",rel:"noopener noreferrer"},r.a.createElement("img",{src:"images/wikipedia-logo.svg",style:{height:"100%"},alt:"Wikipedia Logo"})))),r.a.createElement("div",null))),r.a.createElement("div",{className:"scrollable",style:{flex:"2 1 0px",paddingRight:"4px",marginRight:"4px",overflowY:"auto"}},this.renderArticle(e))),r.a.createElement("div",{className:"Col Col-grow-1",style:{flex:"1 1 0px",marginLeft:"10px"}},this.renderImage(e)))}},{key:"updateInfo",value:function(){var e=this,t=new Me,n=this.props.term;this.setState({state:Pe.LOADING}),t.findTerm(n).then((function(t){e.canceled||e.setState({state:Pe.LOADED,wikipediaInfo:t})})).catch((function(t){if(!e.canceled)return e.setState({state:Pe.ERROR,error:t.message})}))}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e,t){e.term!==this.props.term&&this.updateInfo()}},{key:"renderNone",value:function(){return r.a.createElement("div",null)}},{key:"renderLoading",value:function(){return r.a.createElement(Ue,{message:"Searching Wikipedia..."})}},{key:"renderLoaded",value:function(e){return this.renderWikipediaInfo(e.wikipediaInfo)}},{key:"renderError",value:function(e){return r.a.createElement(ce.a,{type:"error",message:e.error})}},{key:"render",value:function(){if(!this.canceled)switch(this.state.state){case Pe.NONE:return this.renderNone();case Pe.LOADING:return this.renderLoading();case Pe.LOADED:return this.renderLoaded(this.state);case Pe.ERROR:return this.renderError(this.state)}}}]),t}(r.a.Component),We=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderTaxonDescription",value:function(){return r.a.createElement(Fe,{term:this.props.taxon.name})}},{key:"notBiological",value:function(){switch(this.props.taxon.name){case"root":return r.a.createElement("div",null,r.a.createElement("p",null,"This taxon is the topmost node in the NCBI Taxonomy tree."));case"cellular organisms":return r.a.createElement("div",null,r.a.createElement("p",null,"This taxon represents all cellular organisms."));default:return r.a.createElement("div",null,r.a.createElement("p",null,"Unknown non-biological taxon."))}}},{key:"render",value:function(){return this.props.taxon.isBiological?r.a.createElement("div",{className:"Col scrollable"},this.renderTaxonDescription()):this.notBiological()}}]),t}(r.a.Component);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ve=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchLinkedObjects",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n,a,r,i,o,s,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,a=t.page,r=t.pageSize,e.prev=1,this.set((function(e){return Xe({},e,{status:q.LOADING})})),i=new Z({token:this.token,url:this.serviceWizardURL}),o=(a-1)*r,s=r,e.next=8,i.getLinkedObjects(n,{offset:o,limit:s});case 8:c=e.sent,this.set((function(e){return Xe({},e,{status:q.LOADED,linkedObjects:c,page:a,pageSize:r})})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"LinkedDataDB.fetchLinkedObjects",message:e.t0.message}}}));case 16:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(J),Ke=n(160),He=n.n(Ke),qe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderLinkedObjects",value:function(){return r.a.createElement(Ce.a,{dataSource:this.props.linkedObjects,size:"small",className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",bordered:!1,rowKey:function(e){return[e.workspaceID,e.objectID,e.version].join("/")}},r.a.createElement(He.a,{title:"Type",width:"15%",render:function(e){return r.a.createElement("a",{href:"https://ci.kbase.us/#spec/type/KBaseGenomes.Genome",target:"_blank",rel:"noopener noreferrer"},"Genome")}}),r.a.createElement(He.a,{title:"Object",dataIndex:"objectName",width:"35%",sorter:function(e,t){return e.objectName.localeCompare(t.objectName)},render:function(e,t){var n=["","#dataview",t.workspaceID,t.objectID,t.version].join("/"),a={fontStyle:"italic",marginRight:"3px"},i=r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("span",{style:a},"Ref"),r.a.createElement("span",null,t.workspaceID,"/",t.objectID,"/",t.version)),r.a.createElement("div",null,r.a.createElement("span",{style:a},"Workspace ID"),r.a.createElement("span",null,t.workspaceID)),r.a.createElement("div",null,r.a.createElement("span",{style:a},"Object ID"),r.a.createElement("span",null,t.objectID)),r.a.createElement("div",null,r.a.createElement("span",{style:a},"Version"),r.a.createElement("span",null,t.version)));return r.a.createElement(oe.a,{title:i},r.a.createElement("a",{href:n},e))}}),r.a.createElement(He.a,{title:"Narrative",width:"35%",render:function(e){return r.a.createElement("a",{href:"https://ci.kbase.us/narrative/".concat(e),target:"_blank",rel:"noopener noreferrer"},"Narrative or refdata ws title")}}),r.a.createElement(He.a,{title:"Object Created",dataIndex:"createdAt",width:"15%",sorter:function(e,t){return e.createdAt-t.createdAt},render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}))}},{key:"render",value:function(){return this.renderLinkedObjects()}}]),t}(r.a.Component),$e=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new Ve({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"fetchLinkedData",value:function(e,t,n){return this.db.fetchLinkedObjects({taxonRef:e,page:t,pageSize:n})}},{key:"renderNone",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderLoading",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderError",value:function(e){return r.a.createElement(ge,{error:e.error})}},{key:"renderLoaded",value:function(e){return r.a.createElement(qe,{linkedObjects:e.linkedObjects})}},{key:"componentDidMount",value:function(){switch(this.db.get().status){case q.NONE:this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:1,pageSize:1e3})}}},{key:"componentDidUpdate",value:function(e){e.taxonRef.id===this.props.taxonRef.id&&e.taxonRef.namespace===this.props.taxonRef.namespace&&e.taxonRef.timestamp===this.props.taxonRef.timestamp||this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:1,pageSize:1e3})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:return this.renderNone();case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(r.a.Component);var Je=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}}),(function(){return{}}))($e),Qe=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(Ie.a,{defaultActiveKey:"detail",animated:!1,className:"FullHeight-tabs"},r.a.createElement(Ie.a.TabPane,{tab:"Detail",key:"detail",forceRender:!1},r.a.createElement(Ae,{taxon:this.props.taxon})),r.a.createElement(Ie.a.TabPane,{tab:"Description",key:"description",forceRender:!1},r.a.createElement(We,{taxon:this.props.taxon})),r.a.createElement(Ie.a.TabPane,{tab:"Linked Data",key:"linkedData",forceRender:!1},r.a.createElement(Je,{taxonRef:this.props.taxon.ref})))}}]),t}(r.a.Component),Ze=(n(796),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderTaxonInfo",value:function(){return this.props.selectedTaxon?r.a.createElement(Qe,{taxon:this.props.selectedTaxon}):r.a.createElement("div",null,"No taxon selected")}},{key:"componentDidMount",value:function(){this.props.setTitle('Taxonomy Landing Page for "'+this.props.targetTaxon.name+'"')}},{key:"render",value:function(){return r.a.createElement("div",{className:"Col scrollable Taxonomy"},r.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},r.a.createElement(ae.a,null,r.a.createElement(re.a,{span:12},r.a.createElement(Re,{taxon:this.props.targetTaxon})),r.a.createElement(re.a,{span:12},r.a.createElement(ie,null)))),r.a.createElement("div",{className:"Row scrollable"},r.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},r.a.createElement(we,{selectedTaxon:this.props.selectedTaxon,selectTaxonRef:this.props.selectTaxonRef,targetTaxon:this.props.targetTaxon,navigateToTaxonRef:this.props.navigateToTaxonREf})),r.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},this.renderTaxonInfo())))}},{key:"renderx",value:function(){return r.a.createElement("div",{className:"Col scrollable Taxonomy"},r.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},r.a.createElement(ae.a,null,r.a.createElement(re.a,{span:12},"summary"),r.a.createElement(re.a,{span:12},"source info"))),r.a.createElement("div",{className:"Row scrollable"},"omitted"))}}]),t}(r.a.Component)),et=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedTaxonRef=void 0,n.db=new ne({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n.currentlyNavigatedTaxonRef=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectTaxon",value:function(e){return this.db.getSelectedTaxon(e)}},{key:"navigateToTaxon",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderError",value:function(e){return r.a.createElement("div",{className:"Col"},r.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},r.a.createElement(ge,{error:e.error})))}},{key:"renderLoaded",value:function(e){return r.a.createElement(Ze,{targetTaxon:e.targetTaxon,selectedTaxon:e.selectedTaxon,selectTaxonRef:this.selectTaxon.bind(this),navigateToTaxonREf:this.navigateToTaxon.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTaxon(this.props.taxonRef)}},{key:"componentDidUpdate",value:function(e){e.taxonRef.id===this.props.taxonRef.id&&e.taxonRef.timestamp===this.props.taxonRef.timestamp||this.db.getTargetTaxon(this.props.taxonRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(r.a.Component);var tt=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}}),(function(e,t){return{navigate:function(t){var n=["taxonomy",P(t.namespace),t.id,String(t.timestamp)].join("/");e(z(n))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(et);var nt=Object(p.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(z(t))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(tt),at=(n(797),n(798),n(799),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"clickTerm",value:function(){this.props.selectTermRef(this.props.term.ref)}},{key:"clickNavigateToTerm",value:function(){var e=["review","ontology",M(this.props.term.ref.namespace),this.props.term.ref.id,String(this.props.term.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTerm-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTerm-inspector",onClick:this.clickTerm.bind(this)},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTerm-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTerm-inspector"},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTerm-name"},this.props.term.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.term;if(this.props.isActive){["OntologyTerm"].push("OntologyTerm-active")}var t=r.a.createElement("div",null,r.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name));return r.a.createElement(oe.a,{title:t,placement:"right"},r.a.createElement("div",{className:["OntologyTerm"].join(" "),key:this.props.term.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(r.a.Component)),rt=(n(800),n(801),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"clickTerm",value:function(){this.props.selectTermRef(this.props.term.ref)}},{key:"clickNavigateToTerm",value:function(){var e=["review","ontology",M(this.props.term.ref.namespace),String(this.props.term.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTermRelatedBrief-inspector",onClick:this.clickTerm.bind(this)},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTermRelatedBrief-inspector"},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name"},this.props.term.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.term;if(this.props.isActive){["OntologyTermRelatedBrief"].push("OntologyTermRelatedBrief-active")}var t=r.a.createElement("div",null,r.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name));return r.a.createElement(oe.a,{title:t,placement:"right"},r.a.createElement("div",{className:["OntologyTermRelatedBrief"].join(" "),key:this.props.term.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(r.a.Component)),it=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectTerm",value:function(e){this.props.selectTermRef(e)}},{key:"navigateToTerm",value:function(e){this.props.navigateToTermRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.terms.map((function(t){var n=e.props.selectedTermRef===t.ref;return r.a.createElement(rt,{term:t,isActive:n,selectTermRef:e.selectTerm.bind(e),key:t.ref.id,navigateToTermRef:e.navigateToTerm.bind(e)})}))}},{key:"renderNoItems",value:function(){return r.a.createElement(he.a,{description:"No Children",image:he.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(r.a.Component),ot=(n(802),n(803),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"clickTerm",value:function(){this.props.selectTermRef(this.props.term.ref)}},{key:"clickNavigateToTerm",value:function(){var e=["review","ontology",M(this.props.term.ref.namespace),String(this.props.term.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTermRelatedBrief-inspector",onClick:this.clickTerm.bind(this)},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name",onClick:this.clickNavigateToTerm.bind(this)},this.props.term.name),r.a.createElement("div",{className:"OntologyTermRelatedBrief-inspector"},r.a.createElement($.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"OntologyTermRelatedBrief-name"},this.props.term.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.term;if(this.props.isActive){["OntologyTermRelatedBrief"].push("OntologyTermRelatedBrief-active")}var t=r.a.createElement("div",null,r.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name));return r.a.createElement(oe.a,{title:t,placement:"right"},r.a.createElement("div",{className:["OntologyTermRelatedBrief"].join(" "),key:this.props.term.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(r.a.Component)),st=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectTerm",value:function(e){this.props.selectTermRef(e)}},{key:"navigateToTerm",value:function(e){this.props.navigateToTermRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.terms.map((function(t){var n=e.props.selectedTermRef===t.ref;return r.a.createElement(ot,{term:t,isActive:n,selectTermRef:e.selectTerm.bind(e),key:t.ref.id,navigateToTermRef:e.navigateToTerm.bind(e)})}))}},{key:"renderNoItems",value:function(){return r.a.createElement(he.a,{description:"No Children",image:he.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(r.a.Component),ct=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"selectTermRef",value:function(e){console.log("selecting",e)}},{key:"navigateToTermRef",value:function(e){console.log("navigating to ",e)}},{key:"render",value:function(){var e=Date.now(),t={ref:{collection:N.ONTOLOGY,namespace:R.GO,id:"GO:0046294",timestamp:e},name:"aldehyde catabolic process",goID:"GO:0046294"},n=[{ref:{collection:N.ONTOLOGY,namespace:R.GO,id:"GO:0043276",timestamp:e},relation:C.IS_A,name:"anoikis",goID:"GO:0043276"},{ref:{collection:N.ONTOLOGY,namespace:R.GO,id:"GO:0008637",timestamp:e},relation:C.PART_OF,name:"apoptotic",goID:"GO:0008637"}],a=[{ref:{collection:N.ONTOLOGY,namespace:R.GO,id:"GO:0012501",timestamp:e},relation:C.IS_A,name:"programmed cell death",goID:"GO:0012501"}];return r.a.createElement("div",{className:"Col scrollable OntologyNav"},r.a.createElement("div",{className:"Col OntologyNav-title"},"parents"),r.a.createElement("div",{className:"Col OntologyNav-ancestorsArea"},r.a.createElement(st,{terms:a,totalItems:a.length,selectedTermRef:null,selectTermRef:this.selectTermRef.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)})),r.a.createElement("div",{className:"Col OntologyNav-title"},"selected"),r.a.createElement("div",{className:"Col OntologyNav-termArea"},r.a.createElement(at,{term:t,isActive:!1,selectTermRef:this.selectTermRef.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)})),r.a.createElement("div",{className:"Col OntologyNav-title"},"children"),r.a.createElement("div",{className:"Col OntologyNav-childrenArea scrollable"},r.a.createElement(it,{terms:n,totalItems:n.length,selectedTermRef:null,selectTermRef:this.selectTermRef.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)})))}}]),t}(r.a.Component),lt=(n(804),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderGOLink",value:function(e){var t="http://amigo.geneontology.org/amigo/term/".concat(e.goID),n=this.props.newWindow?"_blank":"_parent";return r.a.createElement("a",{href:t,target:n},e.ref.id)}},{key:"render",value:function(){var e=this.props.term;switch(e.type){case I.GO:return this.renderGOLink(e)}}}]),t}(r.a.Component));function ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ut(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ut(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var pt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"getLinkedObjects",value:function(){var e=Object(y.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.set((function(e){return mt({},e,{status:q.LOADING})})),n=[{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"}],this.set((function(e){return mt({},e,{status:q.LOADED,linkedObjects:n})}))}catch(t){this.set((function(e){return{status:q.ERROR,error:{code:"not-found",source:"LinkedObjectsDB.getLinkedObjects",message:t.message}}}))}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(J),dt=(n(805),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderTable",value:function(){return r.a.createElement(Ce.a,{dataSource:this.props.linkedObjects,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,scroll:{y:"100%"},bordered:!1},r.a.createElement(Ce.a.Column,{dataIndex:"scientificName",title:"Scientific Name",width:"40%"}),r.a.createElement(Ce.a.Column,{dataIndex:"type.name",title:"Type",width:"30%"}),r.a.createElement(Ce.a.Column,{dataIndex:"feature",title:"Feature",width:"30%"}))}},{key:"renderNone",value:function(){return r.a.createElement("p",{style:{fontStyle:"italic"}},"No objects use this term.")}},{key:"render",value:function(){return 0===this.props.linkedObjects.length?this.renderNone():this.renderTable()}}]),t}(r.a.Component)),ft=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new pt({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderLoading",value:function(){return r.a.createElement($.a,{type:"loading"})}},{key:"renderError",value:function(e){return r.a.createElement(ge,{error:e.error})}},{key:"renderLoaded",value:function(e){return r.a.createElement(dt,{linkedObjects:e.linkedObjects})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:return this.db.getLinkedObjects(this.props.termRef),this.renderLoading();case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(r.a.Component);var ht=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}}),(function(){return{}}))(ft),vt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderSynonyms",value:function(e){return 0===e.length?r.a.createElement("i",null,"-"):e.map((function(e,t){return r.a.createElement("div",{key:String(t)},e)}))}},{key:"renderDetail",value:function(){return r.a.createElement("div",{className:"InfoTable DetailTable"},r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"ID"),r.a.createElement("div",{className:"InfoTable-dataCol"},r.a.createElement(lt,{term:this.props.term,newWindow:!0}))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"Name"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"Definition"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.definition)),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"Comment"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.comment||r.a.createElement("i",null,"-"))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"Synonyms"),r.a.createElement("div",{className:"InfoTable-dataCol"},r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"exact"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.exact))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"narrow"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.narrow))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"broad"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))),r.a.createElement("div",{className:"InfoTable-row"},r.a.createElement("div",{className:"InfoTable-labelCol"},"related"),r.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))))))}},{key:"renderGraph",value:function(){return r.a.createElement("div",null,"graph here...")}},{key:"renderLinkedObjects",value:function(){return r.a.createElement(ht,{termRef:this.props.term.ref})}},{key:"renderMetadata",value:function(){return r.a.createElement("div",null,"render metadata here...")}},{key:"render",value:function(){var e=[{tab:"detail",title:"Detail",component:this.renderDetail()},{tab:"linked",title:"Linked Objects",component:this.renderLinkedObjects()}];return r.a.createElement(f.FlexTabs,{tabs:e})}}]),t}(r.a.Component),gt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderLayout",value:function(){var e={type:I.GO,relation:C.IS_A,ref:{collection:N.ONTOLOGY,namespace:R.GO,id:"GO:0046294",timestamp:Date.now()},goID:"GO:0046294",name:"formaldehyde catabolic process",definition:"The chemical reactions and pathways resulting in the breakdown of formaldehyde (methanal, H2C=O), the simplest aldehyde. Source: GOC:ai",comment:null,namespace:"biological_process",isObsolete:!1,synonyms:{exact:["formaldehyde breakdown","formaldehyde catabolism","formaldehyde degradation","methanal catabolic process","methanal catabolism"],narrow:[],broad:[],related:[]}};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"Col OntologyLandingPage-navCol",key:"left"},r.a.createElement(ct,null)),r.a.createElement("div",{className:"Col OntologyLandingPage-detailCol",key:"right"},r.a.createElement(vt,{term:e})))}},{key:"render",value:function(){return this.renderLayout()}},{key:"componentDidMount",value:function(){this.props.setTitle("ONTOLOGY LANDING PAGE")}}]),t}(r.a.Component);var bt=Object(p.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(z(t))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(gt),Ot=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"renderUnauthorized",value:function(){return r.a.createElement("div",null,"Sorry, not authorized. Please log in first.")}},{key:"renderRootState",value:function(){switch(this.props.rootState){case f.RootState.NONE:case f.RootState.HOSTED:case f.RootState.DEVELOP:return"";case f.RootState.ERROR:return"error"}}},{key:"renderNavigationNone",value:function(){return r.a.createElement("div",null,"none")}},{key:"renderNavigationSome",value:function(e){switch(e.type){case W.TAXONOMY:return r.a.createElement(nt,{taxonRef:e.ref});case W.ONTOLOGY:return r.a.createElement(bt,{termRef:e.ref})}}},{key:"renderNavigation",value:function(){switch(this.props.navigation.type){case W.NONE:return this.renderNavigationNone();default:return this.renderNavigationSome(this.props.navigation)}}},{key:"parseHash",value:function(e){var t=/^#(.*?)\/(.*)$/.exec(e);if(!t)throw new Error("Invalid path");var n=Object(O.a)(t,3);return{path:[n[1]],params:{relationEngineID:n[2]}}}},{key:"componentDidMount",value:function(){var e=this;if(this.props.rootState===f.RootState.DEVELOP){window.addEventListener("hashchange",(function(t){var n=new URL(t.newURL).hash;if(!n)throw new Error("no hash!");var a=e.parseHash(n).params.relationEngineID;e.props.navigate(a)}));var t=window.location.hash;if(t){var n=this.parseHash(t).params.relationEngineID;this.props.navigate(n)}else this.props.navigate("taxonomy/ncbi_taxonomy/562")}}},{key:"render",value:function(){return this.props.token?r.a.createElement("div",{className:"Col scrollable"},r.a.createElement("div",{className:"Row-auto"},this.renderRootState()),r.a.createElement("div",{className:"Row  scrollable"},this.renderNavigation())):this.renderUnauthorized()}}]),t}(r.a.Component);var yt=Object(p.connect)((function(e,t){var n=e.auth.userAuthorization,a=e.root.state,r=e.navigation,i=e.trigger;return{token:n?n.token:null,rootState:a,navigation:r,trigger:i}}),(function(e,t){return{navigate:function(t){e(z(t))}}}))(Ot),Et=Object(h.d)(V,H(),Object(h.c)(Object(h.a)(v.a))),Tt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).storeUnsubscribe=void 0,n.storeUnsubscribe=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e={view:null,params:{}};this.storeUnsubscribe=Et.subscribe((function(){var t=Et.getState();if(t){var n=t.app.runtime.navigation;if(t.auth.userAuthorization){var a=n.view,r=n.params;(a!==e.view||null===e.params||Object.keys(r).some((function(t){return r[t]!==e.params[t]})))&&(e.params=r,e.view=a,r.relationEngineID&&Et.dispatch(z(r.relationEngineID)))}}}))}},{key:"componentWillUnmount",value:function(){this.storeUnsubscribe&&this.storeUnsubscribe()}},{key:"render",value:function(){return r.a.createElement(p.Provider,{store:Et},r.a.createElement(f.AppBase,null,r.a.createElement(f.AuthGate,{required:!0},r.a.createElement("div",{className:"App Col scrollable"},r.a.createElement(yt,null)))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Tt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[385,1,2]]]);
//# sourceMappingURL=main.3f633a0c.chunk.js.map