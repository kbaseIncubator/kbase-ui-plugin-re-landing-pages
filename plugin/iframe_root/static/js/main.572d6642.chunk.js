(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{365:function(e){e.exports=JSON.parse('[[0,"Unspecified"],[1,"Standard"],[2,"Vertebrate Mitochondrial"],[3,"Yeast Mitochondrial"],[4,"Mold Mitochondrial; Protozoan Mitochondrial; Coelenterate Mitochondrial; Mycoplasma; Spiroplasma"],[5,"Invertebrate Mitochondrial"],[6,"Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear"],[9,"Echinoderm Mitochondrial; Flatworm Mitochondrial"],[10,"Euplotid Nuclear"],[11,"Bacterial, Archaeal and Plant Plastid"],[12,"Alternative Yeast Nuclear"],[13,"Ascidian Mitochondrial"],[14,"Alternative Flatworm Mitochondrial"],[15,"Blepharisma Macronuclear"],[16,"Chlorophycean Mitochondrial"],[21,"Trematode Mitochondrial"],[22,"Scenedesmus obliquus mitochondrial"],[23,"Thraustochytrium mitochondrial code"],[24,"Pterobranchia Mitochondrial"],[25,"Candidate Division SR1 and Gracilibacteria"],[26,"Pachysolen tannophilus Nuclear"],[27,"Karyorelict Nuclear"],[28,"Condylostoma Nuclear"],[29,"Mesodinium Nuclear"],[30,"Peritrich Nuclear"],[31,"Blastocrithidia Nuclear"],[32,"Balanophoraceae Plastid"],[33,"Cephalodiscidae Mitochondrial"]]')},372:function(e,t,n){e.exports=n(793)},377:function(e,t,n){},761:function(e,t,n){},764:function(e,t,n){},765:function(e,t,n){},767:function(e,t,n){},776:function(e,t,n){},777:function(e,t,n){},784:function(e,t,n){},785:function(e,t,n){},786:function(e,t,n){},787:function(e,t,n){},788:function(e,t,n){},789:function(e,t,n){},790:function(e,t,n){},791:function(e,t,n){},792:function(e,t,n){},793:function(e,t,n){"use strict";n.r(t);var r,a,o,i=n(0),s=n.n(i),c=n(8),l=n.n(c),u=(n(377),n(12)),d=n(13),p=n(17),f=n(15),h=n(16),m=n(35),v=n(46),b=n(38),g=n(131),O=n(364),y=n(11),E=n.n(y),k=n(39),j=n(22);!function(e){e[e.NONE=0]="NONE",e[e.LOADED=1]="LOADED",e[e.ERROR=2]="ERROR"}(r||(r={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(a||(a={})),function(e){e[e.NONE=0]="NONE",e[e.TAXONOMY=1]="TAXONOMY",e[e.ONTOLOGY=2]="ONTOLOGY"}(o||(o={}));var w,N,T,x=n(152),R=n.n(x),D=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"dataSources",value:function(){var e=Object(j.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.get(["data_sources"]));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dataSourceInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=["api","v1","data_sources",t],console.log("PATH",n),e.abrupt("return",this.get(n));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(function(){function e(t){Object(u.a)(this,e),this.params=void 0,this.params=t}return Object(d.a)(e,[{key:"get",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.params.url+"/"+t.join("/"),e.next=3,R.a.get(n,{headers:{Accept:"application/json"}});case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}());function I(e){if(["go_ontology","envo_ontology","gtdb_taxonomy","ncbi_taxonomy","rdp_taxonomy"].includes(e))return e;throw new Error("Not a valid namespace: "+e)}function C(e,t){var n,r=e.split("/"),a=Object(k.a)(r,3),o=a[0],i=a[1],s=a[2],c=function(e){switch(e){case"go_ontology":return N.GO;case"envo_ontology":return N.ENVO;case"ncbi_taxonomy":return N.NCBI;case"gtdb_taxonomy":return N.GTDB;case"rdp_taxonomy":return N.RDP}}(I(o)),l=function(e){switch(e){case"taxonomy":return w.TAXONOMY;case"ontology":return w.ONTOLOGY;default:throw new Error('Unrecognized relation engine category name "'+e+'"')}}(t);switch(n="undefined"===typeof s?Date.now():parseInt(s,10),l){case w.ONTOLOGY:switch(c){case N.GO:case N.ENVO:return{category:l,dataSource:c,id:i,timestamp:n};default:throw new Error("Invalid data source for ontology")}case w.TAXONOMY:switch(c){case N.NCBI:case N.GTDB:case N.RDP:return{category:l,dataSource:c,id:i,timestamp:n};default:throw new Error("Invalid data source for taxonomy")}}}function L(e){switch(e.category){case w.ONTOLOGY:switch(e.dataSource){case N.GO:return"go_ontology";case N.ENVO:return"envo_ontology"}break;case w.TAXONOMY:switch(e.dataSource){case N.NCBI:return"ncbi_taxonomy";case N.GTDB:return"gtdb_taxonomy";case N.RDP:return"rdp_taxonomy"}}}function A(e){return{type:T.NAVIGATE_SUCCESS,navigation:e}}function S(e){return function(){var t=Object(j.a)(E.a.mark((function t(n,r){var a,i,s,c,l,u,d,p,f,h,m;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:T.NAVIGATE_START}),a=r(),i=a.auth.userAuthorization,s=a.app.config.services.RelationEngine.url,i){t.next=4;break}return t.abrupt("return");case 4:return c=new D({url:s,token:i.token,timeout:1e4}),t.prev=5,l=e.split("/"),u=Object(k.a)(l,2),d=u[0],p=I(d),t.next=10,c.dataSourceInfo(p);case 10:f=t.sent,console.log("datasource info?",f),h=f.data_source.category,m=C(e,h),t.t0=m.category,t.next=t.t0===w.TAXONOMY?17:t.t0===w.ONTOLOGY?19:21;break;case 17:return n(A({type:o.TAXONOMY,ref:m})),t.abrupt("break",21);case 19:return n(A({type:o.ONTOLOGY,ref:m})),t.abrupt("break",21);case 21:t.next=27;break;case 23:t.prev=23,t.t1=t.catch(5),console.error("ERROR",t.t1),n((v=t.t1.message,{type:T.NAVIGATE_ERROR,message:v}));case 27:case"end":return t.stop()}var v}),t,null,[[5,23]])})));return function(e,n){return t.apply(this,arguments)}}()}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{navigation:t.navigation,trigger:Date.now()})}!function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(w||(w={})),function(e){e[e.ENVO=0]="ENVO",e[e.GO=1]="GO",e[e.GTDB=2]="GTDB",e[e.NCBI=3]="NCBI",e[e.RDP=4]="RDP"}(N||(N={})),function(e){e.NAVIGATE="kbase-ui-plugin-landing-pages/navigate",e.NAVIGATE_START="kbase-ui-plugin-landing-pages/navigate/start",e.NAVIGATE_SUCCESS="kbase-ui-plugin-landing-pages/navigate/success",e.NAVIGATE_ERROR="kbase-ui-plugin-landing-pages/navigate/error"}(T||(T={}));var G,U,z=function(e,t){var n=Object(b.baseReducer)(e,t);if(n)return n;if(!e)return e;switch(t.type){case T.NAVIGATE_SUCCESS:return P(e,t)}return e};function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(b.makeBaseStoreState)(),{navigation:{type:o.NONE},trigger:0,view:{status:a.NONE}})}!function(e){e[e.TAXON=0]="TAXON",e[e.ONTOLOGY_TERM=1]="ONTOLOGY_TERM"}(G||(G={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(U||(U={}));n(761),n(74);var W,F=n(18);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.RELOADING=3]="RELOADING",e[e.ERROR=4]="ERROR"}(W||(W={}));var Y,V=function(){function e(t){Object(u.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(d.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),H=n(75),K=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_lineage",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o=t.offset,i=t.limit,s=t.searchTerm,e.next=3,this.callFunc("get_children",[{ns:n,id:r,ts:a,offset:o,limit:i,search_text:s}]);case 3:return c=e.sent,l=Object(k.a)(c,1),u=l[0],e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_taxon",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWorkspaceObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxon_ns,r=t.taxon_id,a=t.ts,o=t.offset,i=t.limit,s={taxon_ns:n,taxon_id:r,ts:a,limit:i,offset:o},e.next=4,this.callFunc("get_associated_ws_objects",[s]);case 4:return c=e.sent,l=Object(k.a)(c,1),u=l[0],console.log("associated",u),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(H.DynamicServiceClient);K.module="taxonomy_re_api",function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NARRATIVE=1]="NARRATIVE",e[e.REFDATA=2]="REFDATA"}(Y||(Y={}));var X=function(){function e(t){var n=t.token,r=t.url;Object(u.a)(this,e),this.taxonomyClient=void 0,this.taxonomyClient=new K({token:n,url:r})}return Object(d.a)(e,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.timestamp,e.next=3,this.taxonomyClient.getLineage({ns:L(t),id:n,ts:r});case 3:return a=e.sent,o=a.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{category:w.TAXONOMY,dataSource:N.NCBI,id:e.id,timestamp:a.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t,n){var r,a,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.id,a=t.timestamp,e.next=3,this.taxonomyClient.getChildren({ns:L(t),id:r,ts:a,offset:n.offset,limit:n.limit,searchTerm:n.searchTerm});case 3:return o=e.sent,i=o.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{category:w.TAXONOMY,dataSource:N.NCBI,id:e.id,timestamp:o.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",[i,o.total_count]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,r=t.timestamp,e.next=3,this.taxonomyClient.getTaxon({ns:L(t),id:n,ts:r});case 3:return a=e.sent,o=a.results[0],i="root"!==o.scientific_name&&"cellular organisms"!==o.scientific_name,s={ref:{category:w.TAXONOMY,dataSource:N.NCBI,id:o.id,timestamp:a.ts},name:o.scientific_name,rank:o.rank,ncbiID:o.NCBI_taxon_id,geneticCode:parseInt(o.gencode),aliases:o.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:i},e.abrupt("return",s);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t,n){var r,a,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={taxon_ns:L(t),taxon_id:t.id,ts:t.timestamp,offset:n.offset,limit:n.limit},e.next=3,this.taxonomyClient.getAssociatedWorkspaceObjects(r);case 3:return a=e.sent,o=a.results.map((function(e){var t,n;return e.ws_obj.workspace.narr_name?(t=Y.NARRATIVE,n=e.ws_obj.workspace.narr_name):e.ws_obj.workspace.refdata_source?(t=Y.REFDATA,n=e.ws_obj.workspace.refdata_source+" Reference Data"):(t=Y.UNKNOWN,n="Unknown Workspace Type"),{linkedAt:e.edge.updated_at,objectID:e.ws_obj.object_id,workspaceID:e.ws_obj.workspace_id,version:e.ws_obj.version,objectName:e.ws_obj.name,createdAt:e.ws_obj.epoch,workspaceUpdatedAt:e.ws_obj.updated_at,type:{module:e.ws_obj.type.module_name,name:e.ws_obj.type.type_name,majorVersion:e.ws_obj.type.maj_ver,minorVersion:e.ws_obj.type.min_ver},workspaceType:t,title:n}})),e.abrupt("return",{linkedObjects:o,totalCount:a.total_count});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getTargetTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return $({},e,{status:W.LOADING})})),n=new X({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getTaxon(t);case 5:r=e.sent,this.set((function(e){return $({},e,{status:W.LOADED,targetTaxon:r,selectedTaxon:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:W.ERROR,error:{code:"not-found",source:"TaxonDB.getTargetTaxon",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new X({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=4,n.getTaxon(t);case 4:r=e.sent,this.set((function(e){return $({},e,{selectedTaxon:r})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:W.ERROR,error:{code:"not-found",source:"TaxonDB.getSelectedTaxon",message:e.t0.message}}}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),Q=(n(338),n(187)),Z=(n(340),n(138)),ee=(n(764),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Row"},s.a.createElement("div",{className:"Col-auto"},s.a.createElement("img",{src:"images/ncbi-logo.jpg",style:{height:"64px"},alt:"NCBI Logo"})),s.a.createElement("div",{className:"Col"},s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/guide/taxonomy/",target:"_blank",rel:"noopener noreferrer"},"NCBI"))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),s.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(s.a.Component)),te=(n(765),n(149),n(67)),ne=(n(767),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={hovering:!1},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"clickTaxon",value:function(){this.props.selectTaxonRef(this.props.taxon.ref)}},{key:"clickNavigateToTaxon",value:function(){var e=["review",L(this.props.taxon.ref),this.props.taxon.ref.id,String(this.props.taxon.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),s.a.createElement("div",{className:"TaxonItem-inspector",onClick:this.clickTaxon.bind(this)},s.a.createElement(F.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),s.a.createElement("div",{className:"TaxonItem-inspector"},s.a.createElement(F.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name"},this.props.taxon.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.taxon,t=["TaxonItem"];this.props.isActive&&t.push("TaxonItem-active");var n=s.a.createElement("div",null,s.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),s.a.createElement("div",null,e.rank));return s.a.createElement(te.a,{title:n,placement:"right"},s.a.createElement("div",{className:t.join(" "),key:this.props.taxon.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(s.a.Component)),re=(n(150),n(68));function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ie=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"fetchChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u,d,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,o=t.searchTerm,e.prev=1,this.set((function(e){return e.status===W.LOADED?oe({},e,{status:W.RELOADING}):oe({},e,{status:W.LOADING})})),i=new X({token:this.token,url:this.serviceWizardURL}),s=(r-1)*a,c=a,e.next=8,i.getChildren(n,{offset:s,limit:c,searchTerm:o});case 8:l=e.sent,u=Object(k.a)(l,2),d=u[0],p=u[1],this.set((function(e){return oe({},e,{status:W.LOADED,taxa:d,total:p,page:r,pageSize:a})})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set((function(t){return{status:W.ERROR,error:{code:"not-found",source:"TaxonChildrenDB.fetchChildren",message:e.t0.message}}}));case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),se=(n(342),n(101)),ce=(n(772),n(367)),le=(n(178),n(88)),ue=(n(177),n(70)),de=(n(776),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"selectTaxon",value:function(e){this.props.selectTaxonRef(e)}},{key:"navigateToTaxon",value:function(e){this.props.navigateToTaxonRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.taxa.map((function(t,n){var r=null!==e.props.selectedTaxonRef&&e.props.selectedTaxonRef.id===t.ref.id;return s.a.createElement(ne,{taxon:t,isActive:r,selectTaxonRef:e.selectTaxon.bind(e),key:String(n),navigateToTaxonRef:e.navigateToTaxon.bind(e)})}))}},{key:"renderNoItems",value:function(){return s.a.createElement(ue.a,{description:"No Children",image:ue.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.taxa.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(s.a.Component)),pe=(n(777),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderMessage",value:function(){return s.a.createElement("span",null,s.a.createElement(F.a,{type:"exclamation-circle",style:{color:"red"}})," ",this.props.error.message)}},{key:"render",value:function(){return s.a.createElement(re.a,{type:"error",message:this.renderMessage()})}}]),t}(s.a.Component)),fe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).searchTerm=void 0,n.page=void 0,n.pageSize=void 0,n.searchTerm="",n.page=1,n.pageSize=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchChildren(this.props.taxonRef,1,10,"")}},{key:"renderTaxaNone",value:function(){return s.a.createElement("div",null,"None")}},{key:"renderTaxaLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderTitleLoaded",value:function(e){if(0===e.total)return s.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"No Children");var t=Intl.NumberFormat("en-US",{useGrouping:!0}).format(e.total),n=(e.page-1)*e.pageSize+1,r=n+e.taxa.length-1;return s.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"Children (",n,"-",r," of ",t,")")}},{key:"renderTitleReLoading",value:function(e){return s.a.createElement(le.a,{size:"small"},this.renderTitleLoaded(e))}},{key:"renderTitle",value:function(){var e=this.props.db;switch(e.status){case W.NONE:case W.LOADING:return s.a.createElement("div",null,"Loading...");case W.ERROR:return s.a.createElement(pe,{error:e.error});case W.LOADED:return this.renderTitleLoaded(e);case W.RELOADING:return this.renderTitleReLoading(e)}}},{key:"doSearch",value:function(e){this.searchTerm=e,this.props.fetchChildren(this.props.taxonRef,1,this.pageSize||10,e)}},{key:"renderSearch",value:function(){var e=this.props.db.status!==W.LOADED||this.props.db.total<=this.props.db.pageSize&&!this.searchTerm;return s.a.createElement("div",{style:{marginBottom:"4px"}},s.a.createElement(ce.a.Search,{placeholder:"Search Children",onSearch:this.doSearch.bind(this),disabled:e}))}},{key:"renderTaxaLoaded",value:function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement(de,{taxa:e.taxa,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:e.total,maxItems:10}))}},{key:"renderTaxaReLoading",value:function(e){return s.a.createElement(le.a,{tip:"Loading"},this.renderTaxaLoaded(e))}},{key:"renderTaxaError",value:function(e){return s.a.createElement(pe,{error:e.error})}},{key:"renderTaxa",value:function(){switch(this.props.db.status){case W.NONE:return this.renderTaxaNone();case W.LOADING:return this.renderTaxaLoading();case W.LOADED:return this.renderTaxaLoaded(this.props.db);case W.RELOADING:return this.renderTaxaReLoading(this.props.db);case W.ERROR:return this.renderTaxaError(this.props.db)}}},{key:"changePage",value:function(e,t){this.page=e,this.pageSize=t||10,this.props.fetchChildren(this.props.taxonRef,this.page,this.pageSize,this.searchTerm)}},{key:"renderPaginationNone",value:function(){return s.a.createElement(se.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoading",value:function(){return s.a.createElement(se.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationError",value:function(){return s.a.createElement(se.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoaded",value:function(e){return s.a.createElement(se.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,onChange:this.changePage.bind(this)})}},{key:"renderPaginationReLoading",value:function(e){return s.a.createElement(se.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,disabled:!0})}},{key:"renderPagination",value:function(){var e=this.props.db;switch(e.status){case W.NONE:return this.renderPaginationNone();case W.LOADING:return this.renderPaginationLoading();case W.ERROR:return this.renderPaginationError();case W.LOADED:return this.renderPaginationLoaded(e);case W.RELOADING:return this.renderPaginationReLoading(e)}}},{key:"renderChildren",value:function(){return s.a.createElement("div",null,this.renderTitle(),this.renderSearch(),this.renderPagination(),this.renderTaxa())}},{key:"render",value:function(){return this.renderChildren()}}]),t}(s.a.Component),he=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new ie({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"fetchChildren",value:function(e,t,n,r){return this.db.fetchChildren({taxonRef:e,page:t,pageSize:n,searchTerm:r})}},{key:"renderSuccess",value:function(e){return s.a.createElement(fe,{db:e,taxonRef:this.props.taxonRef,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,fetchChildren:this.fetchChildren.bind(this)})}},{key:"renderError",value:function(e){return s.a.createElement(re.a,{type:"error",message:e.error.message})}},{key:"renderTest",value:function(){return"test"}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.ERROR:return this.renderError(e);default:return this.renderSuccess(e)}}}]),t}(s.a.Component);var me=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(he);function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ge=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return be({},e,{status:W.LOADING})})),n=new X({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getLineage(t);case 5:r=e.sent,this.set((function(e){return be({},e,{status:W.LOADED,lineage:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:W.ERROR,error:{code:"not-found",source:"LineageDB.getLineage",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),Oe=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement(de,{taxa:this.props.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:this.props.lineage.length,maxItems:10})}}]),t}(s.a.Component),ye=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new ge({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case W.NONE:this.db.getLineage(this.props.taxonRef)}}},{key:"componentWillUnmount",value:function(){}},{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement(pe,{error:e.error})}},{key:"renderLoaded",value:function(e){return s.a.createElement(Oe,{lineage:e.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Ee=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(ye),ke=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onClick",value:function(e){this.props.selectTaxonRef(e)}},{key:"clickTaxon",value:function(e){this.props.selectTaxonRef(e.ref)}},{key:"renderLineage",value:function(){return s.a.createElement(Ee,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:this.props.selectedTaxon.ref,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderChildrenCount",value:function(e){return 0===e?s.a.createElement("div",{className:""},"No children"):1===e?s.a.createElement("div",null,"One child"):s.a.createElement("div",null,Intl.NumberFormat("en-US",{useGrouping:!0}).format(e)," ","children")}},{key:"renderChildren",value:function(){var e;return e=this.props.selectedTaxon?this.props.selectedTaxon.ref:null,s.a.createElement(me,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderTargetTaxon",value:function(){var e=this.props.selectedTaxon&&this.props.selectedTaxon.ref.id===this.props.targetTaxon.ref.id&&this.props.selectedTaxon.ref.timestamp===this.props.targetTaxon.ref.timestamp;return s.a.createElement(ne,{taxon:this.props.targetTaxon,isActive:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){return s.a.createElement("div",{className:"Col scrollable",style:{overflowY:"auto"}},s.a.createElement("div",{className:"Col-auto Nav-box"},s.a.createElement("div",{className:"Nav-box-title"},"Lineage"),this.renderLineage()),s.a.createElement("div",{className:"Col-auto Nav-box Lineage-target-taxon"},this.renderTargetTaxon()),s.a.createElement("div",{className:"Col-auto scrollable Nav-box"},this.renderChildren()))}}]),t}(s.a.Component),je=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e={};return"species"===this.props.taxon.rank&&(e={fontStyle:"italic"}),s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Rank"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)))}}]),t}(s.a.Component),we=(n(778),n(155)),Ne=(n(151),n(54));var Te=function(e){if(!(e instanceof Array))throw new Error("Invalid genetic codes file!");return e.map((function(e){var t=Object(k.a)(e,2),n=t[0],r=t[1];if("number"!==typeof n)throw new Error("Invalid genetic code id in file");if("string"!==typeof r)throw new Error("Invalid genetic code label in file");return[n,r]}))}(n(365)).reduce((function(e,t){var n=Object(k.a)(t,2),r=n[0],a=n[1];return e.set(r,a),e}),new Map),xe=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderAliases",value:function(){var e=function(e,t){var n=e.replace(/^["']/,""),r=t.replace(/^["']/,"");return n.localeCompare(r)};return s.a.createElement(Ne.a,{dataSource:this.props.taxon.aliases,className:"KBaseAntdOverride-remove-table-border",size:"small",pagination:!1,scroll:{y:"25em"},rowKey:"name",bordered:!1},s.a.createElement(Ne.a.Column,{title:"Name",dataIndex:"name",key:"name",defaultSortOrder:"ascend",sorter:function(t,n){return e(t.name,n.name)}}),s.a.createElement(Ne.a.Column,{title:"Category",dataIndex:"category",key:"category",width:"20em",sorter:function(t,n){return e(t.category,n.category)}}))}},{key:"renderTaxonDetail",value:function(){var e={};return"species"===this.props.taxon.rank&&(e.fontStyle="italic"),s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row",key:"name"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),s.a.createElement("div",{className:"InfoTable-row",key:"rank"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Rank"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)),s.a.createElement("div",{className:"InfoTable-row",key:"ncbiid"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"NCBI ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=".concat(this.props.taxon.ncbiID),target:"_blank",rel:"noopener noreferrer"},this.props.taxon.ncbiID))),s.a.createElement("div",{className:"InfoTable-row",key:"genetic-code"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Genetic Code"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.geneticCode," -"," ",Te.get(this.props.taxon.geneticCode)||"Unknown")),s.a.createElement("div",{className:"InfoTable-row",key:"aliases"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Aliases"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAliases())))}},{key:"render",value:function(){return s.a.createElement("div",null,this.renderTaxonDetail())}}]),t}(s.a.Component),Re=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.taxon;switch(e.ref.dataSource){case N.NCBI:return s.a.createElement(xe,{taxon:e});default:return s.a.createElement(re.a,{type:"error",message:"This taxon type is not supported"})}}}]),t}(s.a.Component),De=n(369);function Ie(e,t,n){if("string"===typeof t)t=t.split(".");else if(!(t instanceof Array))throw new TypeError("Invalid type for key: "+typeof t);for(var r=e,a=0;a<t.length;a+=1){if(void 0===r||"object"!==typeof r||null===r)return n;r=r[t[a]]}return void 0===r?n:r}var Ce,Le=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).name="NotFound",n}return Object(h.a)(t,e),t}(Object(De.a)(Error)),Ae="https://en.wikipedia.org/w/api.php",Se=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,[{key:"scrubTerm",value:function(e){var t=e.split(""),n=/[\w \s]/;return t.filter((function(e){return!!n.exec(e)})).join("")}},{key:"findTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Empty term passed");case 2:return n=this.scrubTerm(t),e.abrupt("return",this.getWikipediaInfo(n).then((function(e){var t=e.imageUrl,n=e.pageUrl,r=e.introText,a=e.title,o=e.pageId,i=e.matchingTerms,s=e.exactMatch;return{imageUrl:t,pageUrl:n,introText:r.replace(/====/g,"####").replace(/===/g,"###").replace(/==/g,"##").replace(/\n/g,"  \n"),title:a,pageId:o,matchingTerms:i,exactMatch:s}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWikipediaInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPage(t).then((function(e){var t=e.wikiResponse,r=e.matchingTerms,a=e.exactMatch;return Promise.all([n.getImage({size:500,pageId:t.parse.pageid}),n.getPageInfo({pageId:t.parse.pageid})]).then((function(e){var n=Object(k.a)(e,2),o=n[0],i=n[1];return{imageUrl:o,pageUrl:i.url,introText:i.introText,title:t.parse.title,pageId:t.parse.pageid,matchingTerms:r,exactMatch:a}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/),r=!0,e.abrupt("return",new Promise((function(e,a){!function n(o){0===o.length&&a(new Le('No Wikipedia page found matching "'+t+'"'));var i=new URL(Ae),s=i.searchParams;s.set("action","parse"),s.set("format","json"),s.set("prop","text|headhtml"),s.set("section","0"),s.set("redirects",""),s.set("page",o.join(" "));s.set("origin","*"),fetch(i.toString(),{method:"GET",headers:{accept:"application/json"}}).then((function(t){switch(t.status){case 200:try{return t.json().then((function(t){if(t.error){if("missingtitle"===t.error.code)return o.pop(),r=!1,n(o),null;console.error("wikipedia api error",t),a(new Error("Wikipedia api error: "+t.error.code))}else e({wikiResponse:t,matchingTerms:o,exactMatch:r})}))}catch(s){a(new Error("Error parsing wikipedia response: "+s.message))}break;default:var i="Unexpected response from wikipedia api: "+t.status;console.error(i,t),a(new Error(i))}})).catch((function(e){a(e)}))}(n)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPageInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageId,r=new URL(Ae),(a=r.searchParams).set("action","query"),a.set("pageids",n),a.set("prop","info|extracts"),a.set("explaintext","true"),a.set("inprop","url"),a.set("origin","*"),a.set("format","json"),e.abrupt("return",fetch(r.toString(),{method:"GET"}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return{url:Ie(e,["query","pages",String(n),"fullurl"],null),introText:Ie(e,["query","pages",String(n),"extract"],null)}}))}catch(r){throw console.error("error getting page info",r.message),r}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.size,r=t.pageId,a=new URL(Ae),(o=a.searchParams).set("action","query"),o.set("format","json"),o.set("prop","pageimages"),o.set("pithumbsize",String(n)),o.set("pageids",String(r)),o.set("origin","*"),i={accept:"application/json"},e.abrupt("return",fetch(a.toString(),{method:"GET",headers:i}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return Ie(e,["query","pages",String(r),"thumbnail","source"],null)}))}catch(n){throw new Error("Error parsing wikipedia response: "+n.message)}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})).catch((function(e){var t="Error getting image from wikipedia: "+e.message;throw console.error(t,e),new Error("Error getting image from wikipedia: "+e.message)})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),_e=n(366),Pe=n.n(_e),Ge=(n(784),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Loading-box"},s.a.createElement(le.a,{size:"large"}),s.a.createElement("br",null),this.props.message)}}]),t}(s.a.Component));n(785);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(Ce||(Ce={}));var Ue,ze=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).wikipediaClient=void 0,n.canceled=void 0,n.wikipediaClient=new Se,n.canceled=!1,n.state={state:Ce.NONE},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){this.canceled=!0}},{key:"renderArticle",value:function(e){var t=Pe()(e.introText);return s.a.createElement("div",{style:{overflow:"auto"},dangerouslySetInnerHTML:{__html:t}})}},{key:"renderImage",value:function(e){return e.imageUrl?s.a.createElement("div",null,s.a.createElement("img",{src:e.imageUrl,style:{width:"100%"},alt:"".concat(this.props.term)})):s.a.createElement("div",{className:"Wikipedia-empty-image"},s.a.createElement("div",{className:"-content"},"Image not found"))}},{key:"renderMatch",value:function(e){if(e.exactMatch){var t=s.a.createElement(s.a.Fragment,null,s.a.createElement(F.a,{type:"check",style:{color:"green"}}),' Exact match on "',e.matchingTerms.join(" "),'"');return s.a.createElement(re.a,{type:"success",message:t})}var n=s.a.createElement(s.a.Fragment,null,s.a.createElement(F.a,{type:"warning",style:{color:"orange"}}),' Inexact match on: "',e.matchingTerms.join(" "),'"');return s.a.createElement(re.a,{type:"warning",message:n})}},{key:"renderWikipediaLogoCredit",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{style:{borderBottom:"1px solid gray"}},"Link to the original Wikipedia entry"),s.a.createElement("div",{style:{fontSize:"80%"}},s.a.createElement("p",{style:{textAlign:"center"}},"credit:",s.a.createElement("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",title:"Creative Commons Attribution-ShareAlike 3.0",target:"_blank",rel:"noopener noreferrer"},"CC BY-SA 3.0"),s.a.createElement("a",{href:"https://en.wikipedia.org/w/index.php?curid=33285413",target:"_blank",rel:"noopener noreferrer"},"Link"))))}},{key:"renderWikipediaInfo",value:function(e){return s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col Col-grow-2 scrollable"},s.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"}},s.a.createElement("div",{style:{flex:"1 1 0px"}},this.renderMatch(e)),s.a.createElement("div",{style:{flex:"0 0 auto",alignSelf:"center",marginLeft:"10px"}},s.a.createElement("div",{style:{height:"32px",textAlign:"center"}},s.a.createElement(te.a,{title:this.renderWikipediaLogoCredit()},s.a.createElement("a",{href:e.pageUrl,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:"images/wikipedia-logo.svg",style:{height:"100%"},alt:"Wikipedia Logo"})))),s.a.createElement("div",null))),s.a.createElement("div",{className:"scrollable",style:{flex:"2 1 0px",paddingRight:"4px",marginRight:"4px",overflowY:"auto"}},this.renderArticle(e))),s.a.createElement("div",{className:"Col Col-grow-1",style:{flex:"1 1 0px",marginLeft:"10px"}},this.renderImage(e)))}},{key:"updateInfo",value:function(){var e=this,t=new Se,n=this.props.term;this.setState({state:Ce.LOADING}),t.findTerm(n).then((function(t){e.canceled||e.setState({state:Ce.LOADED,wikipediaInfo:t})})).catch((function(t){if(!e.canceled)return e.setState({state:Ce.ERROR,error:t.message})}))}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e,t){e.term!==this.props.term&&this.updateInfo()}},{key:"renderNone",value:function(){return s.a.createElement("div",null)}},{key:"renderLoading",value:function(){return s.a.createElement(Ge,{message:"Searching Wikipedia..."})}},{key:"renderLoaded",value:function(e){return this.renderWikipediaInfo(e.wikipediaInfo)}},{key:"renderError",value:function(e){return s.a.createElement(re.a,{type:"error",message:e.error})}},{key:"render",value:function(){if(!this.canceled)switch(this.state.state){case Ce.NONE:return this.renderNone();case Ce.LOADING:return this.renderLoading();case Ce.LOADED:return this.renderLoaded(this.state);case Ce.ERROR:return this.renderError(this.state)}}}]),t}(s.a.Component),Me=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderTaxonDescription",value:function(){return s.a.createElement(ze,{term:this.props.taxon.name})}},{key:"notBiological",value:function(){switch(this.props.taxon.name){case"root":return s.a.createElement("div",null,s.a.createElement("p",null,"This taxon is the topmost node in the NCBI Taxonomy tree."));case"cellular organisms":return s.a.createElement("div",null,s.a.createElement("p",null,"This taxon represents all cellular organisms."));default:return s.a.createElement("div",null,s.a.createElement("p",null,"Unknown non-biological taxon."))}}},{key:"render",value:function(){return this.props.taxon.isBiological?s.a.createElement("div",{className:"Col scrollable"},this.renderTaxonDescription()):this.notBiological()}}]),t}(s.a.Component);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR",e[e.RELOADING=4]="RELOADING"}(Ue||(Ue={}));var Be,We=function(){function e(t){Object(u.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(d.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),Fe=n(84),Ye=n.n(Fe);function Ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function He(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ve(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ve(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING"}(Be||(Be={}));var Ke=function(){function e(t){Object(u.a)(this,e),this.taskFun=void 0,this.hasResult=void 0,this.result=void 0,this.canceled=void 0,this.taskFun=t,this.result=null,this.hasResult=!1,this.canceled=!1}return Object(d.a)(e,[{key:"run",value:function(){var e=Object(j.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.taskFun();case 3:return this.result=e.sent,e.abrupt("return",this.result);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.canceled=!0}},{key:"get",value:function(){if(null===this.result)throw new Error("Attempt to fetch value when not set");return this.result}},{key:"isCanceled",value:function(){return this.canceled}}]),e}(),Xe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.currentTask=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n.currentTask=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"fetchLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,this.currentTask&&this.currentTask.cancel(),o=function(){var e=Object(j.a)(E.a.mark((function e(){var t,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new X({token:c.token,url:c.serviceWizardURL}),o=(r-1)*a,i=a,e.next=5,t.getLinkedObjects(n,{offset:o,limit:i});case 5:return s=e.sent,console.log("linked",s),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Ue.LOADING:case Ue.LOADED:case Ue.RELOADING:return He({},e,{linkedObjectsCollection:He({},e.linkedObjectsCollection,{status:Ue.LOADING})});case Ue.NONE:case Ue.ERROR:default:return He({},e,{linkedObjectsCollection:{status:Ue.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),i=new Ke(o),this.currentTask=i,e.prev=6,e.next=9,i.run();case 9:if(s=e.sent,!i.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return He({},e,{linkedObjectsCollection:{status:Ue.LOADED,data:He({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return He({},t,{linkedObjectsCollection:{status:Ue.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"queryLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,t.sort,this.currentTask&&this.currentTask.cancel(),o=function(){var e=Object(j.a)(E.a.mark((function e(){var t,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new X({token:c.token,url:c.serviceWizardURL}),o=(r-1)*a,i=a,e.next=5,t.getLinkedObjects(n,{offset:o,limit:i});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Ue.LOADING:case Ue.LOADED:case Ue.RELOADING:return He({},e,{linkedObjectsCollection:He({},e.linkedObjectsCollection,{status:Ue.LOADING})});case Ue.NONE:case Ue.ERROR:default:return He({},e,{linkedObjectsCollection:{status:Ue.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),i=new Ke(o),this.currentTask=i,e.prev=6,e.next=9,i.run();case 9:if(s=e.sent,!i.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return He({},e,{linkedObjectsCollection:{status:Ue.LOADED,data:He({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return He({},t,{linkedObjectsCollection:{status:Ue.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(We),qe=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"onChangePage",value:function(e,t){this.props.setPage(e,t||12)}},{key:"onChangeTable",value:function(e,t,n){var r;n.column&&n.column.dataIndex?r={sortColumn:n.column.dataIndex,sortDirection:function(e){switch(e){case"ascending":return Be.ASCENDING;case"descending":return Be.DESCENDING;default:throw new Error("Unknown sort direction: "+e)}}("descend"===n.order?"descending":"ascending")}:r=null;this.props.updateView(e.current||1,e.pageSize||12,r)}},{key:"componentDidMount",value:function(){this.props.setPage(1,12)}},{key:"componentDidUpdate",value:function(e){switch(e.linkedObjectsCollection.status){case Ue.NONE:case Ue.LOADING:case Ue.LOADED:case Ue.ERROR:case Ue.RELOADING:}}},{key:"renderLinkedObjects",value:function(e,t){return s.a.createElement(Ne.a,{dataSource:e.linkedObjects,size:"small",className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",bordered:!1,rowKey:function(e){return[e.workspaceID,e.objectID,e.version].join("/")},pagination:{position:"top",defaultPageSize:12,total:e.totalCount},loading:t,onChange:this.onChangeTable.bind(this)},s.a.createElement(Ye.a,{title:"Type",dataIndex:"type",width:"10%",render:function(e){var t=[[e.module,e.name].join("."),[e.majorVersion,e.minorVersion].join(".")].join("-");return s.a.createElement("a",{href:"/#spec/type/".concat(t),target:"_blank",rel:"noopener noreferrer"},e.name)}}),s.a.createElement(Ye.a,{title:"Object",dataIndex:"objectName",width:"35%",sorter:!0,render:function(e,t){var n=["","#dataview",t.workspaceID,t.objectID,t.version].join("/"),r={fontStyle:"italic",marginRight:"3px"},a=s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("span",{style:r},"Ref"),s.a.createElement("span",null,t.workspaceID,"/",t.objectID,"/",t.version)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Workspace ID"),s.a.createElement("span",null,t.workspaceID)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Object ID"),s.a.createElement("span",null,t.objectID)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Version"),s.a.createElement("span",null,t.version)));return s.a.createElement(te.a,{title:a},s.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},e))}}),s.a.createElement(Ye.a,{title:"Narrative",width:"35%",dataIndex:"workspaceID",render:function(e,t){switch(t.workspaceType){case Y.NARRATIVE:return s.a.createElement("a",{href:"/narrative/".concat(e),target:"_blank",rel:"noopener noreferrer"},t.title);case Y.REFDATA:case Y.UNKNOWN:return s.a.createElement("span",null,t.title)}}}),s.a.createElement(Ye.a,{title:"Object Created",dataIndex:"createdAt",width:"10%",sorter:!0,render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}),s.a.createElement(Ye.a,{title:"Linked At",dataIndex:"linkedAt",width:"10%",sorter:!0,defaultSortOrder:"descend",render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}))}},{key:"renderLoading",value:function(){return s.a.createElement(le.a,null)}},{key:"renderError",value:function(e){return s.a.createElement(re.a,{type:"error",message:e.message})}},{key:"render",value:function(){var e=this.props.linkedObjectsCollection;switch(e.status){case Ue.NONE:return this.renderLoading();case Ue.ERROR:return this.renderError(e.error);case Ue.LOADING:return this.renderLinkedObjects(e.data,!0);case Ue.LOADED:return this.renderLinkedObjects(e.data,!1);case Ue.RELOADING:return this.renderLinkedObjects(e.data,!0)}}}]),t}(s.a.Component),$e=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.lastTaxonRef=void 0,n.db=new Xe({onUpdate:function(){n.forceUpdate()},initialData:{linkedObjectsCollection:{status:Ue.NONE}},token:e.token,config:e.config}),n.lastTaxonRef=e.taxonRef,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(){this.lastTaxonRef!==this.props.taxonRef&&(this.lastTaxonRef=this.props.taxonRef,this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:1,pageSize:12}))}},{key:"fetchLinkedObjects",value:function(e,t){return this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t})}},{key:"queryLinkedObjects",value:function(e,t,n){return this.db.queryLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t,sort:n})}},{key:"render",value:function(){var e=this.db.get();return s.a.createElement(qe,{linkedObjectsCollection:e.linkedObjectsCollection,updateView:this.queryLinkedObjects.bind(this),setPage:this.fetchLinkedObjects.bind(this)})}}]),t}(s.a.Component);var Je=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))($e),Qe=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement(we.a,{defaultActiveKey:"detail",animated:!1,className:"FullHeight-tabs"},s.a.createElement(we.a.TabPane,{tab:"Detail",key:"detail",forceRender:!1},s.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},s.a.createElement(Re,{taxon:this.props.taxon}))),s.a.createElement(we.a.TabPane,{tab:"Description",key:"description",forceRender:!1},s.a.createElement(Me,{taxon:this.props.taxon})),s.a.createElement(we.a.TabPane,{tab:"Linked Data",key:"linkedData",forceRender:!1},s.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},s.a.createElement(Je,{taxonRef:this.props.taxon.ref}))))}}]),t}(s.a.Component),Ze=(n(786),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderTaxonInfo",value:function(){return this.props.selectedTaxon?s.a.createElement(Qe,{taxon:this.props.selectedTaxon}):s.a.createElement("div",null,"No taxon selected")}},{key:"componentDidMount",value:function(){this.props.setTitle('Taxonomy Landing Page for "'+this.props.targetTaxon.name+'"')}},{key:"render",value:function(){return s.a.createElement("div",{className:"Col scrollable Taxonomy"},s.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},s.a.createElement(Q.a,null,s.a.createElement(Z.a,{span:12},s.a.createElement(je,{taxon:this.props.targetTaxon})),s.a.createElement(Z.a,{span:12},s.a.createElement(ee,null)))),s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},s.a.createElement(ke,{selectedTaxon:this.props.selectedTaxon,selectTaxonRef:this.props.selectTaxonRef,targetTaxon:this.props.targetTaxon,navigateToTaxonRef:this.props.navigateToTaxonREf})),s.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},this.renderTaxonInfo())))}}]),t}(s.a.Component)),et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedTaxonRef=void 0,n.db=new J({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n.currentlyNavigatedTaxonRef=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"selectTaxon",value:function(e){return this.db.getSelectedTaxon(e)}},{key:"navigateToTaxon",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(pe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(Ze,{targetTaxon:e.targetTaxon,selectedTaxon:e.selectedTaxon,selectTaxonRef:this.selectTaxon.bind(this),navigateToTaxonREf:this.navigateToTaxon.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTaxon(this.props.taxonRef)}},{key:"componentDidUpdate",value:function(e){e.taxonRef.id===this.props.taxonRef.id&&e.taxonRef.timestamp===this.props.taxonRef.timestamp||this.db.getTargetTaxon(this.props.taxonRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var tt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=[L(t),t.id,String(t.timestamp)].join("/");e(S(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(et);var nt,rt,at,ot=Object(m.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(S(t))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(tt),it=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getParents",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_parents",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTerms",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_terms",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_children",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRelatedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_children",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getHierarchicalAncestors",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_hierarchical_ancestors",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWSObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_associated_ws_objects",[t]);case 2:return n=e.sent,r=Object(k.a)(n,1),a=r[0],e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(H.DynamicServiceClient);function st(e,t){var n=function(e){switch(e){case"go_ontology":return"go_ontology";case"envo_ontology":return"envo_ontology";default:throw new Error("Ontology namespace not supported: "+e)}}("go_ontology");switch(n){case"go_ontology":return{type:nt.GO,ref:{category:w.ONTOLOGY,dataSource:N.GO,id:e.id,timestamp:t},namespace:e.namespace,comments:e.comments,definition:e.def.val,goID:e.id,isObsolete:!1,name:e.name,synonyms:{exact:e.synonyms.filter((function(e){return"hasExactSynonym"===e.pred})).map((function(e){return e.val})),narrow:e.synonyms.filter((function(e){return"hasNarrowSynonym"===e.pred})).map((function(e){return e.val})),broad:e.synonyms.filter((function(e){return"hasBroadSynonym"===e.pred})).map((function(e){return e.val})),related:e.synonyms.filter((function(e){return"hasRelatedSynonym"===e.pred})).map((function(e){return e.val}))}};default:throw new Error("Ontology namespace not yet supported: "+n)}}function ct(e){switch(e){case"is_a":return rt.IS_A;case"part_of":return rt.PART_OF;case"has_part":return rt.HAS_PART;case"regulates":return rt.REGULATES;case"positively_regulates":return rt.POSITIVELY_REGULATES;case"negatively_regulates":return rt.NEGATIVELY_REGULATES;case"occurs_in":return rt.OCCURS_IN;case"ends_during":return rt.ENDS_DURING;case"happens_during":return rt.HAPPENS_DURING;default:throw new Error("Unknown relation: "+e)}}function lt(e){switch(e){case rt.IS_A:return"is_a";case rt.PART_OF:return"part_of";case rt.HAS_PART:return"has_part";case rt.REGULATES:return"regulates";case rt.POSITIVELY_REGULATES:return"positively_regulates";case rt.NEGATIVELY_REGULATES:return"negatively_regulates";case rt.OCCURS_IN:return"occurs_in";case rt.ENDS_DURING:return"ends_during";case rt.HAPPENS_DURING:return"happens_during"}}function ut(e,t){return{term:st(e.term,t),relation:ct(e.edge.type)}}function dt(e){switch(e.category){case w.ONTOLOGY:switch(e.dataSource){case N.GO:return"go_ontology";case N.ENVO:return"envo_ontology"}}}it.module="OntologyAPI",function(e){e[e.GO=0]="GO"}(nt||(nt={})),function(e){e.IS_A="OntologyRelation$is_a",e.PART_OF="OntologyRelation$part_of",e.HAS_PART="OntologyRelation$has_part",e.REGULATES="OntologyRelation$regulates",e.POSITIVELY_REGULATES="OntologyRelation$positivelyRegulates",e.NEGATIVELY_REGULATES="OntologyRelation$negativelyRegulates",e.OCCURS_IN="OntologyRelation$occursIn",e.ENDS_DURING="OntologyRelation$endsDuring",e.HAPPENS_DURING="OntologyRelation$happensDuring"}(rt||(rt={})),function(e){e[e.EXACT=0]="EXACT",e[e.NARROW=1]="NARROW",e[e.BROAD=2]="BROAD",e[e.RELATED=3]="RELATED"}(at||(at={}));var pt=function(){function e(t){var n=t.token,r=t.url;Object(u.a)(this,e),this.ontologyClient=void 0,this.token=void 0,this.url=void 0,this.token=n,this.url=r,this.ontologyClient=new it({token:n,url:r})}return Object(d.a)(e,[{key:"getTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new it({token:this.token,url:this.url}),e.next=4,r.getTerms({ns:dt(n),ids:[n.id],ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{term:st(a.results[0],a.ts)});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getParents",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new it({token:this.token,url:this.url}),e.next=4,r.getParents({ns:dt(n),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return ut(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new it({token:this.token,url:this.url}),e.next=4,r.getChildren({ns:dt(n),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return ut(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRelatedFeatures",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=t.offset,a=t.limit,o=new it({token:this.token,url:this.url}),e.next=4,o.getAssociatedWSObjects({ns:dt(n),id:n.id,ts:n.timestamp||Date.now(),offset:r,limit:a});case 4:return i=e.sent,s=[],i.results.forEach((function(e){e.features.forEach((function(t){s.push({featureID:t.feature_id,relatedAt:t.updated_at,objectName:e.ws_obj.name,objectRef:{workspaceID:e.ws_obj.workspace_id,objectID:e.ws_obj.object_id,version:e.ws_obj.version}})}))})),e.abrupt("return",{features:s});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAncestorGraph",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new it({token:this.token,url:this.url}),e.next=4,r.getHierarchicalAncestors({ns:dt(n),id:n.id,ts:n.timestamp||Date.now(),offset:0,limit:1e3});case 4:return a=e.sent,o=[],a.results.forEach((function(e){var t=ct(e.edge.type);o.some((function(n){return n.from===e.edge.from&&n.to===e.edge.to&&n.relation===t}))||o.push({relation:t,from:e.edge.from,to:e.edge.to})})),i=o.reduce((function(e,t){var n=e.get(t.from);return n||(n=[]),n.push(t),e.set(t.from,n),e}),new Map),s=new Map,a.results.forEach((function(e){if(!s.has(e.term.id)){var t=st(e.term,a.ts),n=!1;i.get(t.ref.id)||(n=!0),s.set(e.term.id,{id:t.ref.id,term:t,isRoot:n})}})),e.abrupt("return",{termsGraph:{terms:Array.from(s.values()),relations:o}});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function ft(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ht(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ft(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ft(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var mt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getTargetTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return ht({},e,{status:W.LOADING})})),n=new pt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getTerm({ref:t});case 5:r=e.sent,a=r.term,this.set((function(e){return ht({},e,{status:W.LOADED,targetTerm:a,selectedTerm:a})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return ht({},t,{status:W.ERROR,error:e.t0.message})}));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setSelectedTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.get().status===W.LOADED){e.next=3;break}return e.abrupt("return");case 3:return n=new pt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=6,n.getTerm({ref:t});case 6:r=e.sent,a=r.term,this.set((function(e){return ht({},e,{selectedTerm:a})}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),vt=(n(787),n(788),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderGOLink",value:function(e){var t="http://amigo.geneontology.org/amigo/term/".concat(e.goID),n=this.props.newWindow?"_blank":"_parent",r=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"Link to the Gene Ontology AmiGO page for this term."),s.a.createElement("p",null,"Opens in a separate window or tab."));return s.a.createElement(te.a,{title:r},s.a.createElement("a",{href:t,target:n},e.ref.id," ",s.a.createElement(F.a,{type:"link"})))}},{key:"render",value:function(){var e=this.props.term;switch(e.type){case nt.GO:return this.renderGOLink(e)}}}]),t}(s.a.Component));function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new pt({url:this.props.config.services.ServiceWizard.url,token:this.props.token}),e.prev=1,this.set((function(e){return gt({},e,{status:W.LOADING})})),e.next=5,n.getRelatedFeatures({ref:t,offset:0,limit:1e3});case 5:r=e.sent,this.set((function(e){return gt({},e,{status:W.LOADED,linkedObjects:r.features})})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.set((function(t){return{status:W.ERROR,error:{code:"not-found",source:"LinkedObjectsDB.getLinkedObjects",message:e.t0.message}}}));case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),yt=(n(789),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderTable",value:function(){return s.a.createElement(Ne.a,{dataSource:this.props.linkedObjects,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,scroll:{y:"100%"},rowKey:function(e){return[e.objectRef.workspaceID,e.objectRef.objectID,e.objectRef.version,e.featureID].join(":")},bordered:!1},s.a.createElement(Ne.a.Column,{dataIndex:"objectName",title:"Object Name",width:"40%",render:function(e,t){var n=["dataview",String(t.objectRef.workspaceID),String(t.objectRef.objectID),String(t.objectRef.version)].join("/"),r=new URL("",window.location.origin);return r.hash=n,s.a.createElement("a",{href:r.toString(),target:"_blank",rel:"noopener noreferrer"},e)}}),s.a.createElement(Ne.a.Column,{dataIndex:"featureID",title:"Feature",width:"40%",render:function(e,t){var n=["dataview",String(t.objectRef.workspaceID),String(t.objectRef.objectID),String(t.objectRef.version)].join("/"),r=new URL("",window.location.origin);r.hash=n;var a=r.searchParams;return a.set("sub","Feature"),a.set("subid",e),s.a.createElement("a",{href:r.toString(),target:"_blank",rel:"noopener noreferrer"},e)}}),s.a.createElement(Ne.a.Column,{dataIndex:"relatedAt",width:"20%",title:"Linked",render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}))}},{key:"renderNone",value:function(){return s.a.createElement("p",{style:{fontStyle:"italic"}},"No objects use this term.")}},{key:"render",value:function(){return 0===this.props.linkedObjects.length?this.renderNone():this.renderTable()}}]),t}(s.a.Component)),Et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new Ot({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case W.NONE:this.db.getLinkedObjects(this.props.termRef)}}},{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement(pe,{error:e.error})}},{key:"renderLoaded",value:function(e){return s.a.createElement(yt,{linkedObjects:e.linkedObjects})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var kt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(Et);function jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getChildrenTerms",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return wt({},e,{status:W.LOADING})})),n=new pt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getChildren({ref:t});case 5:r=e.sent,(a=r.terms).sort((function(e,t){return e.term.name.localeCompare(t.term.name)})),this.set((function(e){return wt({},e,{status:W.LOADED,terms:a})})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return wt({},t,{status:W.ERROR,error:e.t0.message})}));case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),Tt=(n(790),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderRelation",value:function(e){return lt(e)}},{key:"renderItemsTable",value:function(){var e=this;return s.a.createElement(Ne.a,{dataSource:this.props.terms,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,rowKey:function(e){return e.term.ref.id},scroll:{y:"100%"}},s.a.createElement(Ye.a,{dataIndex:"term.name",title:"Name",width:"60%"}),s.a.createElement(Ye.a,{dataIndex:"term.goID",title:"ID",width:"20%",render:function(e,t){var n=s.a.createElement("div",null,t.term.name,s.a.createElement("br",null),t.term.goID,s.a.createElement("hr",null),t.term.definition);return s.a.createElement(te.a,{title:n,placement:"left"},s.a.createElement("a",{href:"/#review/go_ontology/".concat(e,"/").concat(t.term.ref.timestamp),target:"_parent"},e))}}),s.a.createElement(Ye.a,{dataIndex:"relation",title:"Relation",width:"20%",render:function(t){return e.renderRelation(t)}}))}},{key:"renderNoItems",value:function(){return s.a.createElement(ue.a,{description:"No Children",image:ue.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsTable()}}]),t}(s.a.Component)),xt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new Nt({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(pe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(Tt,{terms:e.terms})}},{key:"componentDidMount",value:function(){this.db.getChildrenTerms(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Rt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=[dt(t),t.id,String(t.timestamp)].join("/");e(S(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(xt);function Dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ct=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"getAncestorGraph",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return It({},e,{status:W.LOADING})})),n=new pt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getTerm({ref:t});case 5:return r=e.sent,a=r.term,e.next=9,n.getAncestorGraph({ref:t});case 9:o=e.sent,i=o.termsGraph,s={id:a.ref.id,isRoot:!1,term:a},i.terms.push(s),this.set((function(e){return It({},e,{status:W.LOADED,graph:i,term:a})})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return It({},t,{status:W.ERROR,error:{code:"error",source:"ancestor-graph-data-fetch",message:e.t0.message}})}));case 20:case"end":return e.stop()}}),e,this,[[2,16]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(V),Lt=n(189),At=(n(791),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).networkGraphNode=void 0,n.graphNode=void 0,n.network=void 0,n.graphNode=s.a.createRef(),n.networkGraphNode=s.a.createRef(),n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"mountGraph",value:function(){var e=this;if(null!==this.graphNode.current){var t=new Lt.a({});t.add(this.props.data.nodes.map((function(e){var t;return t=e.isTerm?"red":"black",e.isRoot&&(t="green"),{id:e.id,label:e.label,color:{border:t},shape:e.isRoot||e.isTerm?"ellipse":"box"}})));var n=new Lt.a({});n.add(this.props.data.edges.map((function(e){return{from:e.from,to:e.to,arrows:"to",label:e.label}})));var r={layout:{hierarchical:{enabled:!0,direction:"DU",sortMethod:"directed",nodeSpacing:300}},physics:!1,height:"400px",nodes:{color:{highlight:{border:"blue",background:"rgb(204, 255, 255, 1)"}},margin:{top:10,right:10,bottom:10,left:10}}};this.network=new Lt.b(this.graphNode.current,{nodes:t,edges:n},r),this.network.on("selectNode",(function(t){var n=Object(k.a)(t.nodes,1)[0];e.props.selectNodeID(n)})),this.props.selectedNodeID&&this.network.selectNodes([this.props.selectedNodeID])}}},{key:"componentDidMount",value:function(){var e=this;this.mountGraph(),window.addEventListener("resize",(function(){e.onResize()})),this.onResize()}},{key:"onResize",value:function(){var e;e=this.networkGraphNode.current?this.networkGraphNode.current.clientHeight+"px":"400px",this.network&&(this.network.setSize("100%",e),this.network.redraw())}},{key:"componentDidUpdate",value:function(){this.props.selectedNodeID&&this.network&&this.network.selectNodes([this.props.selectedNodeID])}},{key:"render",value:function(){return s.a.createElement("div",{ref:this.networkGraphNode,className:"NetworkGraph"},s.a.createElement("div",{ref:this.graphNode,className:"NetworkGraph-graphWrapper"}))}}]),t}(s.a.Component)),St=(n(792),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={selectedNodeID:null},n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"selectGraphNode",value:function(e){this.setState({selectedNodeID:e.term.ref.id})}},{key:"renderTable",value:function(){var e=this;return s.a.createElement(Ne.a,{dataSource:this.props.graph.terms,size:"small",pagination:!1,scroll:{y:"100%"},className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",rowSelection:{type:"radio",fixed:!1,hideDefaultSelections:!0,selectedRowKeys:this.state.selectedNodeID?[this.state.selectedNodeID]:[]},rowKey:function(e){return e.id}},s.a.createElement(Ne.a.Column,{dataIndex:"term",defaultSortOrder:"ascend",sorter:function(e,t){return e.term.name.localeCompare(t.term.name)},key:"term.id",title:"Name",width:"85%",render:function(t,n){return s.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){e.selectGraphNode(n)}},t.name)}}),s.a.createElement(Ne.a.Column,{dataIndex:"term",sorter:function(e,t){return e.term.name.localeCompare(t.term.name)},title:"ID",width:"15%",render:function(e){var t=["/#review",dt(e.ref),e.ref.id].join("/");return s.a.createElement("a",{href:t,target:"_parent"},e.ref.id)}}))}},{key:"selectNodeID",value:function(e){this.setState({selectedNodeID:e})}},{key:"render",value:function(){var e=this,t={nodes:this.props.graph.terms.map((function(t){var n=t.id===e.props.term.ref.id;return{id:t.id,label:t.term.name,isTerm:n,isRoot:t.isRoot,isSelected:t.term.ref.id===e.state.selectedNodeID}})),edges:this.props.graph.relations.map((function(e){return{from:e.from,to:e.to,label:lt(e.relation)}}))};return s.a.createElement("div",{className:"AncestorGraph"},s.a.createElement("div",{className:"AncestorGraph-graph"},s.a.createElement(At,{data:t,height:"400px",selectedNodeID:this.state.selectedNodeID,selectNodeID:this.selectNodeID.bind(this)})),s.a.createElement("div",{className:"AncestorGraph-table"},this.renderTable()))}}]),t}(s.a.Component)),_t=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new Ct({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(pe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(St,{graph:e.graph,term:e.term})}},{key:"componentDidMount",value:function(){this.db.getAncestorGraph(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Pt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=[dt(t),t.id,String(t.timestamp)].join("/");e(S(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(_t),Gt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderSynonyms",value:function(e){return 0===e.length?s.a.createElement("i",null,"-"):e.map((function(e,t){return s.a.createElement("div",{key:String(t)},e)}))}},{key:"renderComments",value:function(){return 0===this.props.term.comments.length?s.a.createElement("i",null,"-"):this.props.term.comments.map((function(e,t){return e.split("\n").map((function(e,n){return s.a.createElement("p",{key:String(t)+"-"+String(n)},e)}))}))}},{key:"renderDetail",value:function(){return s.a.createElement("div",{className:"InfoTable DetailTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement(vt,{term:this.props.term,newWindow:!0}))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Definition"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.definition)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Comments"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderComments())),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"synonyms"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAllSynonyms())))}},{key:"renderAllSynonyms",value:function(){return s.a.createElement("div",{className:"InfoTable DetailTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"exact"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.exact))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"narrow"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.narrow))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"broad"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"related"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))))}},{key:"renderGraph",value:function(){return s.a.createElement(Pt,{termRef:this.props.term.ref})}},{key:"renderLinkedObjects",value:function(){return s.a.createElement(kt,{termRef:this.props.term.ref})}},{key:"renderMetadata",value:function(){return s.a.createElement("div",null,"render metadata here...")}},{key:"renderChildren",value:function(){return s.a.createElement(Rt,{termRef:this.props.term.ref})}},{key:"render",value:function(){var e=[{tab:"graph",title:"Graph",component:this.renderGraph()},{tab:"detail",title:"Detail",component:this.renderDetail()},{tab:"synonyms",title:"Synonyms",component:this.renderAllSynonyms()},{tab:"children",title:"Children",component:this.renderChildren()},{tab:"linked",title:"Linked Data",component:this.renderLinkedObjects()}];return s.a.createElement(b.FlexTabs,{tabs:e})}}]),t}(s.a.Component),Ut=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Row"},s.a.createElement("div",{className:"Col-auto",style:{justifyContent:"center"}},s.a.createElement("img",{src:"images/go-logo.png",style:{height:"50px"},alt:"Gene Ontology Logo"})),s.a.createElement("div",{className:"Col"},s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"http://geneontology.org/",target:"_blank",rel:"noopener noreferrer"},"Gene Ontology (GO)"))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),s.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(s.a.Component),zt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.goID)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)))}}]),t}(s.a.Component),Mt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.setTitle('Ontology Landing Page for "'.concat(this.props.targetTerm.name,'" (').concat(this.props.targetTerm.goID,")"))}},{key:"renderLayout",value:function(){return s.a.createElement("div",{className:"Col scrollable Taxonomy"},s.a.createElement("div",{className:"Col-auto Ontology-summary-section"},s.a.createElement(Q.a,null,s.a.createElement(Z.a,{span:12},s.a.createElement(zt,{term:this.props.targetTerm})),s.a.createElement(Z.a,{span:12},s.a.createElement(Ut,null)))),s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col scrollable"},s.a.createElement(Gt,{term:this.props.selectedTerm}))))}},{key:"render",value:function(){return this.renderLayout()}}]),t}(s.a.Component),Bt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new mt({onUpdate:function(){n.forceUpdate()},initialData:{status:W.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"selectTerm",value:function(e){return this.db.setSelectedTerm(e)}},{key:"navigateToTerm",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return s.a.createElement(F.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(pe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(Mt,{targetTerm:e.targetTerm,selectedTerm:e.selectedTerm,selectTerm:this.selectTerm.bind(this),navigate:this.navigateToTerm.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTerm(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){e.termRef.id===this.props.termRef.id&&e.termRef.timestamp===this.props.termRef.timestamp||this.db.getTargetTerm(this.props.termRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case W.NONE:case W.LOADING:return this.renderLoading();case W.ERROR:return this.renderError(e);case W.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Wt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=[dt(t),t.id,String(t.timestamp)].join("/");e(S(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(Bt);var Ft=Object(m.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(S(t))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(Wt),Yt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(d.a)(t,[{key:"renderUnauthorized",value:function(){return s.a.createElement("div",null,"Sorry, not authorized. Please log in first.")}},{key:"renderRootState",value:function(){switch(this.props.rootState){case b.RootState.NONE:case b.RootState.HOSTED:case b.RootState.DEVELOP:return"";case b.RootState.ERROR:return"error"}}},{key:"renderNavigationNone",value:function(){return s.a.createElement("div",null,"none")}},{key:"renderNavigationSome",value:function(e){switch(e.type){case o.TAXONOMY:return s.a.createElement(ot,{taxonRef:e.ref});case o.ONTOLOGY:return s.a.createElement(Ft,{termRef:e.ref});default:console.error("Unhandled navigation",e)}}},{key:"renderNavigation",value:function(){switch(this.props.navigation.type){case o.NONE:return this.renderNavigationNone();default:return this.renderNavigationSome(this.props.navigation)}}},{key:"parseHash",value:function(e){var t=/^#(.*?)\/(.*)$/.exec(e);if(!t)throw new Error("Invalid path");var n=Object(k.a)(t,3);return{path:[n[1]],params:{relationEngineID:n[2]}}}},{key:"componentDidMount",value:function(){var e=this;if(this.props.rootState===b.RootState.DEVELOP){window.addEventListener("hashchange",(function(t){var n=new URL(t.newURL).hash;if(!n)throw new Error("no hash!");var r=e.parseHash(n).params.relationEngineID;e.props.navigate(r)}));var t=window.location.hash;if(t){var n=this.parseHash(t).params.relationEngineID;this.props.navigate(n)}else this.props.navigate("go_ontology/GO:0007610")}}},{key:"render",value:function(){return this.props.token?s.a.createElement("div",{className:"Col scrollable"},s.a.createElement("div",{className:"Row-auto"},this.renderRootState()),s.a.createElement("div",{className:"Row  scrollable"},this.renderNavigation())):this.renderUnauthorized()}}]),t}(s.a.Component);var Vt=Object(m.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.root.state,a=e.navigation,o=e.trigger;return{token:n?n.token:null,rootState:r,navigation:a,trigger:o}}),(function(e,t){return{navigate:function(t){e(S(t))}}}))(Yt),Ht=Object(g.d)(z,B(),Object(g.c)(Object(g.a)(O.a))),Kt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).storeUnsubscribe=void 0,n.storeUnsubscribe=null,n}return Object(h.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e={view:null,params:{}};this.storeUnsubscribe=Ht.subscribe((function(){var t=Ht.getState();if(t){var n=t.app.runtime.navigation;if(t.auth.userAuthorization){var r=n.view,a=n.params;(r!==e.view||null===e.params||Object.keys(a).some((function(t){return a[t]!==e.params[t]})))&&(e.params=a,e.view=r,a.relationEngineID&&Ht.dispatch(S(a.relationEngineID)))}}}))}},{key:"componentWillUnmount",value:function(){this.storeUnsubscribe&&this.storeUnsubscribe()}},{key:"render",value:function(){return s.a.createElement(m.Provider,{store:Ht},s.a.createElement(b.AppBase,null,s.a.createElement(b.AuthGate,{required:!0},s.a.createElement("div",{className:"App Col scrollable"},s.a.createElement(Vt,null)))))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(Kt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[372,1,2]]]);
//# sourceMappingURL=main.572d6642.chunk.js.map