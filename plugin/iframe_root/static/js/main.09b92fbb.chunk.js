(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],{386:function(e){e.exports=JSON.parse('[[0,"Unspecified"],[1,"Standard"],[2,"Vertebrate Mitochondrial"],[3,"Yeast Mitochondrial"],[4,"Mold Mitochondrial; Protozoan Mitochondrial; Coelenterate Mitochondrial; Mycoplasma; Spiroplasma"],[5,"Invertebrate Mitochondrial"],[6,"Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear"],[9,"Echinoderm Mitochondrial; Flatworm Mitochondrial"],[10,"Euplotid Nuclear"],[11,"Bacterial, Archaeal and Plant Plastid"],[12,"Alternative Yeast Nuclear"],[13,"Ascidian Mitochondrial"],[14,"Alternative Flatworm Mitochondrial"],[15,"Blepharisma Macronuclear"],[16,"Chlorophycean Mitochondrial"],[21,"Trematode Mitochondrial"],[22,"Scenedesmus obliquus mitochondrial"],[23,"Thraustochytrium mitochondrial code"],[24,"Pterobranchia Mitochondrial"],[25,"Candidate Division SR1 and Gracilibacteria"],[26,"Pachysolen tannophilus Nuclear"],[27,"Karyorelict Nuclear"],[28,"Condylostoma Nuclear"],[29,"Mesodinium Nuclear"],[30,"Peritrich Nuclear"],[31,"Blastocrithidia Nuclear"],[32,"Balanophoraceae Plastid"],[33,"Cephalodiscidae Mitochondrial"]]')},391:function(e,t,n){e.exports=n(809)},396:function(e,t,n){},777:function(e,t,n){},780:function(e,t,n){},781:function(e,t,n){},783:function(e,t,n){},792:function(e,t,n){},793:function(e,t,n){},800:function(e,t,n){},801:function(e,t,n){},802:function(e,t,n){},803:function(e,t,n){},804:function(e,t,n){},805:function(e,t,n){},806:function(e,t,n){},807:function(e,t,n){},808:function(e,t,n){},809:function(e,t,n){"use strict";n.r(t);var r,a,o,i=n(0),s=n.n(i),c=n(9),l=n.n(c),u=(n(396),n(12)),d=n(13),p=n(17),f=n(15),m=n(16),h=n(35),v=n(49),b=n(40),O=n(148),g=n(385),y=n(14),E=n.n(y),k=n(37),j=n(23);!function(e){e[e.NONE=0]="NONE",e[e.LOADED=1]="LOADED",e[e.ERROR=2]="ERROR"}(r||(r={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(a||(a={})),function(e){e[e.NONE=0]="NONE",e[e.TAXONOMY=1]="TAXONOMY",e[e.ONTOLOGY=2]="ONTOLOGY"}(o||(o={}));var w=n(72),N=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getNodeInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=/^(.*?)\/(.*)$/,r=/^([^/]+)\/([^/]+)(?:\/([^/]+))?$/,a=/^([^/]+)\/([^/]+)(?:\/([^/]+))?$/,e.abrupt("return",new Promise((function(e,o){var i=n.exec(t);if(i){var s=i,c=Object(k.a)(s,3),l=c[1],u=c[2];switch(l){case"taxonomy":!function(){if(i=r.exec(u)){4!==i.length&&o(new Error('Invalid relation engine id "'+t+'"'));var n,a=i,s=Object(k.a)(a,4),c=s[1],l=s[2],d=s[3];switch(n=d?parseInt(d,10):Date.now(),c){case"ncbi_taxonomy":return void e([{collection:"taxonomy",namespace:c,id:l,timestamp:n,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:o(new Error('Unrecognized taxonomy namespace "'+c+'"'))}}else o(new Error("Taxonomy ref is "))}();break;case"ontology":if(!(i=a.exec(u)))return void o(new Error("Taxonomy ref is "));var d,p=i,f=Object(k.a)(p,4),m=f[1],h=f[2],v=f[3];switch(d=v?parseInt(v):Date.now(),m){case"go":return void e([{collection:"ontology",namespace:m,id:h,timestamp:d,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:return void o(new Error('Ontology namespace not found "'+m+'"'))}default:o(new Error("Collection ".concat(l," does not resolve to a type")))}}else o(new Error("Invalid relation engine ID "+t))})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(w.DynamicServiceClient);N.module="relation_engine_api";var T,x,R,D,I,C,L,A,S,G=n(200);Object(G.a)(Error);function P(e){switch(e){case R.TAXONOMY:return"taxonomy";case R.ONTOLOGY:return"ontology"}}function _(e){switch(e){case D.NCBI:return"ncbi_taxonomy";case D.GTDB:return"gtdb"}}function U(e){switch(e){case"ncbi_taxonomy":return D.NCBI;case"gtdb":return D.GTDB;default:throw new Error('Unrecognized namespace "'+e+'"')}}function z(e){switch(e){case"go":return I.GO;default:throw new Error("Ontology namespace not supported: "+e)}}function M(e){switch(e){case I.GO:return"go"}}function B(e){return{type:S.NAVIGATE_SUCCESS,navigation:e}}function W(e){return function(){var t=Object(j.a)(E.a.mark((function t(n,r){var a,i,s,c,l,u,d;return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:S.NAVIGATE_START}),a=r(),i=a.auth.userAuthorization,s=a.app.config.services.ServiceWizard.url,i){t.next=4;break}return t.abrupt("return");case 4:return c=new N({url:s,token:i.token}),t.prev=5,t.next=8,c.getNodeInfo(e);case 8:l=t.sent,u=Object(k.a)(l,1),d=u[0],t.t0=d.collection,t.next="taxonomy"===t.t0?14:"ontology"===t.t0?16:18;break;case 14:return n(B({type:o.TAXONOMY,ref:{collection:R.TAXONOMY,namespace:U(d.namespace),id:d.id,timestamp:d.timestamp}})),t.abrupt("break",18);case 16:return n(B({type:o.ONTOLOGY,ref:{collection:R.ONTOLOGY,namespace:z(d.namespace),id:d.id,timestamp:d.timestamp}})),t.abrupt("break",18);case 18:t.next=24;break;case 20:t.prev=20,t.t1=t.catch(5),console.error("ERROR",t.t1),n((p=t.t1.message,{type:S.NAVIGATE_ERROR,message:p}));case 24:case"end":return t.stop()}var p}),t,null,[[5,20]])})));return function(e,n){return t.apply(this,arguments)}}()}function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{navigation:t.navigation,trigger:Date.now()})}!function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(T||(T={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(x||(x={})),function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(R||(R={})),function(e){e[e.NCBI=0]="NCBI",e[e.GTDB=1]="GTDB"}(D||(D={})),function(e){e[e.GO=0]="GO"}(I||(I={})),function(e){e[e.GO=0]="GO"}(C||(C={})),function(e){e.IS_A="OntologyRelation$is_a",e.PART_OF="OntologyRelation$part_of",e.HAS_PART="OntologyRelation$has_part",e.REGULATES="OntologyRelation$regulates",e.POSITIVELY_REGULATES="OntologyRelation$positivelyRegulates",e.NEGATIVELY_REGULATES="OntologyRelation$negativelyRegulates",e.OCCURS_IN="OntologyRelation$occursIn",e.ENDS_DURING="OntologyRelation$endsDuring",e.HAPPENS_DURING="OntologyRelation$happensDuring"}(L||(L={})),function(e){e[e.EXACT=0]="EXACT",e[e.NARROW=1]="NARROW",e[e.BROAD=2]="BROAD",e[e.RELATED=3]="RELATED"}(A||(A={})),function(e){e.NAVIGATE="kbase-ui-plugin-landing-pages/navigate",e.NAVIGATE_START="kbase-ui-plugin-landing-pages/navigate/start",e.NAVIGATE_SUCCESS="kbase-ui-plugin-landing-pages/navigate/success",e.NAVIGATE_ERROR="kbase-ui-plugin-landing-pages/navigate/error"}(S||(S={}));var V,K,X=function(e,t){var n=Object(b.baseReducer)(e,t);if(n)return n;if(!e)return e;switch(t.type){case S.NAVIGATE_SUCCESS:return Y(e,t)}return e};function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(b.makeBaseStoreState)(),{navigation:{type:o.NONE},trigger:0,view:{status:a.NONE}})}!function(e){e[e.TAXON=0]="TAXON",e[e.ONTOLOGY_TERM=1]="ONTOLOGY_TERM"}(V||(V={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(K||(K={}));n(777),n(81);var q,J=n(4);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.RELOADING=3]="RELOADING",e[e.ERROR=4]="ERROR"}(q||(q={}));var Q,Z=function(){function e(t){Object(u.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(d.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),ee=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_lineage",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o=t.offset,i=t.limit,s=t.searchTerm,e.next=3,this.callFunc("get_children",[{ns:n,id:r,ts:a,offset:o,limit:i,search_text:s}]);case 3:return c=e.sent,l=Object(k.a)(c,1),u=l[0],e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_taxon",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWorkspaceObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxon_ns,r=t.taxon_id,a=t.ts,o=t.offset,i=t.limit,s={taxon_ns:n,taxon_id:r,ts:a,limit:i,offset:o},e.next=4,this.callFunc("get_associated_ws_objects",[s]);case 4:return c=e.sent,l=Object(k.a)(c,1),u=l[0],console.log("associated",u),e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(w.DynamicServiceClient);ee.module="taxonomy_re_api",function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NARRATIVE=1]="NARRATIVE",e[e.REFDATA=2]="REFDATA"}(Q||(Q={}));var te=function(){function e(t){var n=t.token,r=t.url;Object(u.a)(this,e),this.taxonomyClient=void 0,this.taxonomyClient=new ee({token:n,url:r})}return Object(d.a)(e,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,r=t.id,a=t.timestamp,e.next=3,this.taxonomyClient.getLineage({ns:_(n),id:r,ts:a});case 3:return o=e.sent,i=o.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:R.TAXONOMY,namespace:D.NCBI,id:e.id,timestamp:o.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t,n){var r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.namespace,a=t.id,o=t.timestamp,e.next=3,this.taxonomyClient.getChildren({ns:_(r),id:a,ts:o,offset:n.offset,limit:n.limit,searchTerm:n.searchTerm});case 3:return i=e.sent,s=i.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:R.TAXONOMY,namespace:D.NCBI,id:e.id,timestamp:i.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",[s,i.total_count]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,r=t.id,a=t.timestamp,e.next=3,this.taxonomyClient.getTaxon({ns:_(n),id:r,ts:a});case 3:return o=e.sent,i=o.results[0],s="root"!==i.scientific_name&&"cellular organisms"!==i.scientific_name,c={ref:{collection:R.TAXONOMY,namespace:D.NCBI,id:i.id,timestamp:o.ts},name:i.scientific_name,rank:i.rank,ncbiID:i.NCBI_taxon_id,geneticCode:parseInt(i.gencode),aliases:i.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:s},e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t,n){var r,a,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={taxon_ns:_(t.namespace),taxon_id:t.id,ts:t.timestamp,offset:n.offset,limit:n.limit},e.next=3,this.taxonomyClient.getAssociatedWorkspaceObjects(r);case 3:return a=e.sent,o=a.results.map((function(e){var t,n;return e.ws_obj.workspace.narr_name?(t=Q.NARRATIVE,n=e.ws_obj.workspace.narr_name):e.ws_obj.workspace.refdata_source?(t=Q.REFDATA,n=e.ws_obj.workspace.refdata_source+" Reference Data"):(t=Q.UNKNOWN,n="Unknown Workspace Type"),{linkedAt:e.edge.updated_at,objectID:e.ws_obj.object_id,workspaceID:e.ws_obj.workspace_id,version:e.ws_obj.version,objectName:e.ws_obj.name,createdAt:e.ws_obj.epoch,workspaceUpdatedAt:e.ws_obj.updated_at,type:{module:e.ws_obj.type.module_name,name:e.ws_obj.type.type_name,majorVersion:e.ws_obj.type.maj_ver,minorVersion:e.ws_obj.type.min_ver},workspaceType:t,title:n}})),e.abrupt("return",{linkedObjects:o,totalCount:a.total_count});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getTargetTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return re({},e,{status:q.LOADING})})),n=new te({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getTaxon(t);case 5:r=e.sent,this.set((function(e){return re({},e,{status:q.LOADED,targetTaxon:r,selectedTaxon:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonDB.getTargetTaxon",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedTaxon",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new te({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=4,n.getTaxon(t);case 4:r=e.sent,this.set((function(e){return re({},e,{selectedTaxon:r})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonDB.getSelectedTaxon",message:e.t0.message}}}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),oe=(n(358),n(76)),ie=(n(360),n(54)),se=(n(780),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Row"},s.a.createElement("div",{className:"Col-auto"},s.a.createElement("img",{src:"images/ncbi-logo.jpg",style:{height:"64px"},alt:"NCBI Logo"})),s.a.createElement("div",{className:"Col"},s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/guide/taxonomy/",target:"_blank",rel:"noopener noreferrer"},"NCBI"))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),s.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(s.a.Component)),ce=(n(781),n(161),n(39)),le=(n(783),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={hovering:!1},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"clickTaxon",value:function(){this.props.selectTaxonRef(this.props.taxon.ref)}},{key:"clickNavigateToTaxon",value:function(){var e=["review",P(this.props.taxon.ref.collection),_(this.props.taxon.ref.namespace),this.props.taxon.ref.id,String(this.props.taxon.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),s.a.createElement("div",{className:"TaxonItem-inspector",onClick:this.clickTaxon.bind(this)},s.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),s.a.createElement("div",{className:"TaxonItem-inspector"},s.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"TaxonItem-name"},this.props.taxon.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.taxon,t=["TaxonItem"];this.props.isActive&&t.push("TaxonItem-active");var n=s.a.createElement("div",null,s.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),s.a.createElement("div",null,e.rank));return s.a.createElement(ce.a,{title:n,placement:"right"},s.a.createElement("div",{className:t.join(" "),key:this.props.taxon.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(s.a.Component)),ue=(n(162),n(65));function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"fetchChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c,l,u,d,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,o=t.searchTerm,e.prev=1,this.set((function(e){return e.status===q.LOADED?pe({},e,{status:q.RELOADING}):pe({},e,{status:q.LOADING})})),i=new te({token:this.token,url:this.serviceWizardURL}),s=(r-1)*a,c=a,e.next=8,i.getChildren(n,{offset:s,limit:c,searchTerm:o});case 8:l=e.sent,u=Object(k.a)(l,2),d=u[0],p=u[1],this.set((function(e){return pe({},e,{status:q.LOADED,taxa:d,total:p,page:r,pageSize:a})})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"TaxonChildrenDB.fetchChildren",message:e.t0.message}}}));case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),me=(n(362),n(77)),he=(n(788),n(90)),ve=(n(190),n(61)),be=(n(189),n(68)),Oe=(n(792),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"selectTaxon",value:function(e){this.props.selectTaxonRef(e)}},{key:"navigateToTaxon",value:function(e){this.props.navigateToTaxonRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.taxa.map((function(t,n){var r=null!==e.props.selectedTaxonRef&&e.props.selectedTaxonRef.id===t.ref.id;return s.a.createElement(le,{taxon:t,isActive:r,selectTaxonRef:e.selectTaxon.bind(e),key:String(n),navigateToTaxonRef:e.navigateToTaxon.bind(e)})}))}},{key:"renderNoItems",value:function(){return s.a.createElement(be.a,{description:"No Children",image:be.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.taxa.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(s.a.Component)),ge=(n(793),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderMessage",value:function(){return console.log("err?",this.props),s.a.createElement("span",null,s.a.createElement(J.a,{type:"exclamation-circle",style:{color:"red"}})," ",this.props.error.message)}},{key:"render",value:function(){return s.a.createElement(ue.a,{type:"error",message:this.renderMessage()})}}]),t}(s.a.Component)),ye=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).searchTerm=void 0,n.page=void 0,n.pageSize=void 0,n.searchTerm="",n.page=1,n.pageSize=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchChildren(this.props.taxonRef,1,10,"")}},{key:"renderTaxaNone",value:function(){return s.a.createElement("div",null,"None")}},{key:"renderTaxaLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderTitleLoaded",value:function(e){if(0===e.total)return s.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"No Children");var t=Intl.NumberFormat("en-US",{useGrouping:!0}).format(e.total),n=(e.page-1)*e.pageSize+1,r=n+e.taxa.length-1;return s.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"Children (",n,"-",r," of ",t,")")}},{key:"renderTitleReLoading",value:function(e){return s.a.createElement(ve.a,{size:"small"},this.renderTitleLoaded(e))}},{key:"renderTitle",value:function(){var e=this.props.db;switch(e.status){case q.NONE:case q.LOADING:return s.a.createElement("div",null,"Loading...");case q.ERROR:return s.a.createElement(ge,{error:e.error});case q.LOADED:return this.renderTitleLoaded(e);case q.RELOADING:return this.renderTitleReLoading(e)}}},{key:"doSearch",value:function(e){this.searchTerm=e,this.props.fetchChildren(this.props.taxonRef,1,this.pageSize||10,e)}},{key:"renderSearch",value:function(){var e=this.props.db.status!==q.LOADED||this.props.db.total<=this.props.db.pageSize&&!this.searchTerm;return s.a.createElement("div",{style:{marginBottom:"4px"}},s.a.createElement(he.a.Search,{placeholder:"Search Children",onSearch:this.doSearch.bind(this),disabled:e}))}},{key:"renderTaxaLoaded",value:function(e){return s.a.createElement(s.a.Fragment,null,s.a.createElement(Oe,{taxa:e.taxa,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:e.total,maxItems:10}))}},{key:"renderTaxaReLoading",value:function(e){return s.a.createElement(ve.a,{tip:"Loading"},this.renderTaxaLoaded(e))}},{key:"renderTaxaError",value:function(e){return s.a.createElement(ge,{error:e.error})}},{key:"renderTaxa",value:function(){switch(this.props.db.status){case q.NONE:return this.renderTaxaNone();case q.LOADING:return this.renderTaxaLoading();case q.LOADED:return this.renderTaxaLoaded(this.props.db);case q.RELOADING:return this.renderTaxaReLoading(this.props.db);case q.ERROR:return this.renderTaxaError(this.props.db)}}},{key:"changePage",value:function(e,t){this.page=e,this.pageSize=t||10,this.props.fetchChildren(this.props.taxonRef,this.page,this.pageSize,this.searchTerm)}},{key:"renderPaginationNone",value:function(){return s.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoading",value:function(){return s.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationError",value:function(){return s.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoaded",value:function(e){return s.a.createElement(me.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,onChange:this.changePage.bind(this)})}},{key:"renderPaginationReLoading",value:function(e){return s.a.createElement(me.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,disabled:!0})}},{key:"renderPagination",value:function(){var e=this.props.db;switch(e.status){case q.NONE:return this.renderPaginationNone();case q.LOADING:return this.renderPaginationLoading();case q.ERROR:return this.renderPaginationError();case q.LOADED:return this.renderPaginationLoaded(e);case q.RELOADING:return this.renderPaginationReLoading(e)}}},{key:"renderChildren",value:function(){return s.a.createElement("div",null,this.renderTitle(),this.renderSearch(),this.renderPagination(),this.renderTaxa())}},{key:"render",value:function(){return this.renderChildren()}}]),t}(s.a.Component),Ee=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new fe({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){}},{key:"fetchChildren",value:function(e,t,n,r){return this.db.fetchChildren({taxonRef:e,page:t,pageSize:n,searchTerm:r})}},{key:"renderSuccess",value:function(e){return s.a.createElement(ye,{db:e,taxonRef:this.props.taxonRef,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,fetchChildren:this.fetchChildren.bind(this)})}},{key:"renderError",value:function(e){return s.a.createElement(ue.a,{type:"error",message:e.error.message})}},{key:"renderTest",value:function(){return"test"}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.ERROR:return this.renderError(e);default:return this.renderSuccess(e)}}}]),t}(s.a.Component);var ke=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(Ee);function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getLineage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return we({},e,{status:q.LOADING})})),n=new te({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getLineage(t);case 5:r=e.sent,this.set((function(e){return we({},e,{status:q.LOADED,lineage:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:q.ERROR,error:{code:"not-found",source:"LineageDB.getLineage",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),Te=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement(Oe,{taxa:this.props.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:this.props.lineage.length,maxItems:10})}}]),t}(s.a.Component),xe=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new Ne({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case q.NONE:this.db.getLineage(this.props.taxonRef)}}},{key:"componentWillUnmount",value:function(){}},{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement(ge,{error:e.error})}},{key:"renderLoaded",value:function(e){return s.a.createElement(Te,{lineage:e.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Re=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(xe),De=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"onClick",value:function(e){this.props.selectTaxonRef(e)}},{key:"clickTaxon",value:function(e){this.props.selectTaxonRef(e.ref)}},{key:"renderLineage",value:function(){return s.a.createElement(Re,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:this.props.selectedTaxon.ref,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderChildrenCount",value:function(e){return 0===e?s.a.createElement("div",{className:""},"No children"):1===e?s.a.createElement("div",null,"One child"):s.a.createElement("div",null,Intl.NumberFormat("en-US",{useGrouping:!0}).format(e)," ","children")}},{key:"renderChildren",value:function(){var e;return e=this.props.selectedTaxon?this.props.selectedTaxon.ref:null,s.a.createElement(ke,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderTargetTaxon",value:function(){var e=this.props.selectedTaxon&&this.props.selectedTaxon.ref.id===this.props.targetTaxon.ref.id&&this.props.selectedTaxon.ref.timestamp===this.props.targetTaxon.ref.timestamp;return s.a.createElement(le,{taxon:this.props.targetTaxon,isActive:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){return s.a.createElement("div",{className:"Col scrollable",style:{overflowY:"auto"}},s.a.createElement("div",{className:"Col-auto Nav-box"},s.a.createElement("div",{className:"Nav-box-title"},"Lineage"),this.renderLineage()),s.a.createElement("div",{className:"Col-auto Nav-box Lineage-target-taxon"},this.renderTargetTaxon()),s.a.createElement("div",{className:"Col-auto scrollable Nav-box"},this.renderChildren()))}}]),t}(s.a.Component),Ie=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e={};return"species"===this.props.taxon.rank&&(e={fontStyle:"italic"}),s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Rank"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)))}}]),t}(s.a.Component),Ce=(n(794),n(93)),Le=(n(163),n(53));var Ae=function(e){if(!(e instanceof Array))throw new Error("Invalid genetic codes file!");return e.map((function(e){var t=Object(k.a)(e,2),n=t[0],r=t[1];if("number"!==typeof n)throw new Error("Invalid genetic code id in file");if("string"!==typeof r)throw new Error("Invalid genetic code label in file");return[n,r]}))}(n(386)).reduce((function(e,t){var n=Object(k.a)(t,2),r=n[0],a=n[1];return e.set(r,a),e}),new Map),Se=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderAliases",value:function(){var e=function(e,t){var n=e.replace(/^["']/,""),r=t.replace(/^["']/,"");return n.localeCompare(r)};return s.a.createElement(Le.a,{dataSource:this.props.taxon.aliases,className:"KBaseAntdOverride-remove-table-border",size:"small",pagination:!1,scroll:{y:"25em"},rowKey:"name",bordered:!1},s.a.createElement(Le.a.Column,{title:"Name",dataIndex:"name",key:"name",defaultSortOrder:"ascend",sorter:function(t,n){return e(t.name,n.name)}}),s.a.createElement(Le.a.Column,{title:"Category",dataIndex:"category",key:"category",width:"20em",sorter:function(t,n){return e(t.category,n.category)}}))}},{key:"renderTaxonDetail",value:function(){var e={};return"species"===this.props.taxon.rank&&(e.fontStyle="italic"),s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row",key:"name"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),s.a.createElement("div",{className:"InfoTable-row",key:"rank"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Rank"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)),s.a.createElement("div",{className:"InfoTable-row",key:"ncbiid"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"NCBI ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=".concat(this.props.taxon.ncbiID),target:"_blank",rel:"noopener noreferrer"},this.props.taxon.ncbiID))),s.a.createElement("div",{className:"InfoTable-row",key:"genetic-code"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Genetic Code"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.geneticCode," -"," ",Ae.get(this.props.taxon.geneticCode)||"Unknown")),s.a.createElement("div",{className:"InfoTable-row",key:"aliases"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Aliases"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAliases())))}},{key:"render",value:function(){return s.a.createElement("div",null,this.renderTaxonDetail())}}]),t}(s.a.Component),Ge=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props.taxon;switch(e.ref.namespace){case D.NCBI:return s.a.createElement(Se,{taxon:e});default:return s.a.createElement(ue.a,{type:"error",message:"This taxon type is not supported"})}}}]),t}(s.a.Component);function Pe(e,t,n){if("string"===typeof t)t=t.split(".");else if(!(t instanceof Array))throw new TypeError("Invalid type for key: "+typeof t);for(var r=e,a=0;a<t.length;a+=1){if(void 0===r||"object"!==typeof r||null===r)return n;r=r[t[a]]}return void 0===r?n:r}var _e,Ue=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).name="NotFound",n}return Object(m.a)(t,e),t}(Object(G.a)(Error)),ze="https://en.wikipedia.org/w/api.php",Me=function(){function e(){Object(u.a)(this,e)}return Object(d.a)(e,[{key:"scrubTerm",value:function(e){var t=e.split(""),n=/[\w \s]/;return t.filter((function(e){return!!n.exec(e)})).join("")}},{key:"findTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Empty term passed");case 2:return n=this.scrubTerm(t),e.abrupt("return",this.getWikipediaInfo(n).then((function(e){var t=e.imageUrl,n=e.pageUrl,r=e.introText,a=e.title,o=e.pageId,i=e.matchingTerms,s=e.exactMatch;return{imageUrl:t,pageUrl:n,introText:r.replace(/====/g,"####").replace(/===/g,"###").replace(/==/g,"##").replace(/\n/g,"  \n"),title:a,pageId:o,matchingTerms:i,exactMatch:s}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWikipediaInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPage(t).then((function(e){var t=e.wikiResponse,r=e.matchingTerms,a=e.exactMatch;return Promise.all([n.getImage({size:500,pageId:t.parse.pageid}),n.getPageInfo({pageId:t.parse.pageid})]).then((function(e){var n=Object(k.a)(e,2),o=n[0],i=n[1];return{imageUrl:o,pageUrl:i.url,introText:i.introText,title:t.parse.title,pageId:t.parse.pageid,matchingTerms:r,exactMatch:a}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/),r=!0,e.abrupt("return",new Promise((function(e,a){!function n(o){0===o.length&&a(new Ue('No Wikipedia page found matching "'+t+'"'));var i=new URL(ze),s=i.searchParams;s.set("action","parse"),s.set("format","json"),s.set("prop","text|headhtml"),s.set("section","0"),s.set("redirects",""),s.set("page",o.join(" "));s.set("origin","*"),fetch(i.toString(),{method:"GET",headers:{accept:"application/json"}}).then((function(t){switch(t.status){case 200:try{return t.json().then((function(t){if(t.error){if("missingtitle"===t.error.code)return o.pop(),r=!1,n(o),null;console.error("wikipedia api error",t),a(new Error("Wikipedia api error: "+t.error.code))}else e({wikiResponse:t,matchingTerms:o,exactMatch:r})}))}catch(s){a(new Error("Error parsing wikipedia response: "+s.message))}break;default:var i="Unexpected response from wikipedia api: "+t.status;console.error(i,t),a(new Error(i))}})).catch((function(e){a(e)}))}(n)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPageInfo",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageId,r=new URL(ze),(a=r.searchParams).set("action","query"),a.set("pageids",n),a.set("prop","info|extracts"),a.set("explaintext","true"),a.set("inprop","url"),a.set("origin","*"),a.set("format","json"),e.abrupt("return",fetch(r.toString(),{method:"GET"}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return{url:Pe(e,["query","pages",String(n),"fullurl"],null),introText:Pe(e,["query","pages",String(n),"extract"],null)}}))}catch(r){throw console.error("error getting page info",r.message),r}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.size,r=t.pageId,a=new URL(ze),(o=a.searchParams).set("action","query"),o.set("format","json"),o.set("prop","pageimages"),o.set("pithumbsize",String(n)),o.set("pageids",String(r)),o.set("origin","*"),i={accept:"application/json"},e.abrupt("return",fetch(a.toString(),{method:"GET",headers:i}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return Pe(e,["query","pages",String(r),"thumbnail","source"],null)}))}catch(n){throw new Error("Error parsing wikipedia response: "+n.message)}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})).catch((function(e){var t="Error getting image from wikipedia: "+e.message;throw console.error(t,e),new Error("Error getting image from wikipedia: "+e.message)})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Be=n(387),We=n.n(Be),Fe=(n(800),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Loading-box"},s.a.createElement(ve.a,{size:"large"}),s.a.createElement("br",null),this.props.message)}}]),t}(s.a.Component));n(801);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(_e||(_e={}));var Ye,Ve=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).wikipediaClient=void 0,n.canceled=void 0,n.wikipediaClient=new Me,n.canceled=!1,n.state={state:_e.NONE},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentWillUnmount",value:function(){this.canceled=!0}},{key:"renderArticle",value:function(e){var t=We()(e.introText);return s.a.createElement("div",{style:{overflow:"auto"},dangerouslySetInnerHTML:{__html:t}})}},{key:"renderImage",value:function(e){return e.imageUrl?s.a.createElement("div",null,s.a.createElement("img",{src:e.imageUrl,style:{width:"100%"},alt:"".concat(this.props.term)})):s.a.createElement("div",{className:"Wikipedia-empty-image"},s.a.createElement("div",{className:"-content"},"Image not found"))}},{key:"renderMatch",value:function(e){if(e.exactMatch){var t=s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{type:"check",style:{color:"green"}}),' Exact match on "',e.matchingTerms.join(" "),'"');return s.a.createElement(ue.a,{type:"success",message:t})}var n=s.a.createElement(s.a.Fragment,null,s.a.createElement(J.a,{type:"warning",style:{color:"orange"}}),' Inexact match on: "',e.matchingTerms.join(" "),'"');return s.a.createElement(ue.a,{type:"warning",message:n})}},{key:"renderWikipediaLogoCredit",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{style:{borderBottom:"1px solid gray"}},"Link to the original Wikipedia entry"),s.a.createElement("div",{style:{fontSize:"80%"}},s.a.createElement("p",{style:{textAlign:"center"}},"credit:",s.a.createElement("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",title:"Creative Commons Attribution-ShareAlike 3.0",target:"_blank",rel:"noopener noreferrer"},"CC BY-SA 3.0"),s.a.createElement("a",{href:"https://en.wikipedia.org/w/index.php?curid=33285413",target:"_blank",rel:"noopener noreferrer"},"Link"))))}},{key:"renderWikipediaInfo",value:function(e){return s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col Col-grow-2 scrollable"},s.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"}},s.a.createElement("div",{style:{flex:"1 1 0px"}},this.renderMatch(e)),s.a.createElement("div",{style:{flex:"0 0 auto",alignSelf:"center",marginLeft:"10px"}},s.a.createElement("div",{style:{height:"32px",textAlign:"center"}},s.a.createElement(ce.a,{title:this.renderWikipediaLogoCredit()},s.a.createElement("a",{href:e.pageUrl,target:"_blank",rel:"noopener noreferrer"},s.a.createElement("img",{src:"images/wikipedia-logo.svg",style:{height:"100%"},alt:"Wikipedia Logo"})))),s.a.createElement("div",null))),s.a.createElement("div",{className:"scrollable",style:{flex:"2 1 0px",paddingRight:"4px",marginRight:"4px",overflowY:"auto"}},this.renderArticle(e))),s.a.createElement("div",{className:"Col Col-grow-1",style:{flex:"1 1 0px",marginLeft:"10px"}},this.renderImage(e)))}},{key:"updateInfo",value:function(){var e=this,t=new Me,n=this.props.term;this.setState({state:_e.LOADING}),t.findTerm(n).then((function(t){e.canceled||e.setState({state:_e.LOADED,wikipediaInfo:t})})).catch((function(t){if(!e.canceled)return e.setState({state:_e.ERROR,error:t.message})}))}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e,t){e.term!==this.props.term&&this.updateInfo()}},{key:"renderNone",value:function(){return s.a.createElement("div",null)}},{key:"renderLoading",value:function(){return s.a.createElement(Fe,{message:"Searching Wikipedia..."})}},{key:"renderLoaded",value:function(e){return this.renderWikipediaInfo(e.wikipediaInfo)}},{key:"renderError",value:function(e){return s.a.createElement(ue.a,{type:"error",message:e.error})}},{key:"render",value:function(){if(!this.canceled)switch(this.state.state){case _e.NONE:return this.renderNone();case _e.LOADING:return this.renderLoading();case _e.LOADED:return this.renderLoaded(this.state);case _e.ERROR:return this.renderError(this.state)}}}]),t}(s.a.Component),Ke=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderTaxonDescription",value:function(){return s.a.createElement(Ve,{term:this.props.taxon.name})}},{key:"notBiological",value:function(){switch(this.props.taxon.name){case"root":return s.a.createElement("div",null,s.a.createElement("p",null,"This taxon is the topmost node in the NCBI Taxonomy tree."));case"cellular organisms":return s.a.createElement("div",null,s.a.createElement("p",null,"This taxon represents all cellular organisms."));default:return s.a.createElement("div",null,s.a.createElement("p",null,"Unknown non-biological taxon."))}}},{key:"render",value:function(){return this.props.taxon.isBiological?s.a.createElement("div",{className:"Col scrollable"},this.renderTaxonDescription()):this.notBiological()}}]),t}(s.a.Component);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR",e[e.RELOADING=4]="RELOADING"}(Ye||(Ye={}));var Xe,He=function(){function e(t){Object(u.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(d.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),$e=n(96),qe=n.n($e);function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING"}(Xe||(Xe={}));var Ze=function(){function e(t){Object(u.a)(this,e),this.taskFun=void 0,this.hasResult=void 0,this.result=void 0,this.canceled=void 0,this.taskFun=t,this.result=null,this.hasResult=!1,this.canceled=!1}return Object(d.a)(e,[{key:"run",value:function(){var e=Object(j.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.taskFun();case 3:return this.result=e.sent,e.abrupt("return",this.result);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.canceled=!0}},{key:"get",value:function(){if(null===this.result)throw new Error("Attempt to fetch value when not set");return this.result}},{key:"isCanceled",value:function(){return this.canceled}}]),e}(),et=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.currentTask=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n.currentTask=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"fetchLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,this.currentTask&&this.currentTask.cancel(),o=function(){var e=Object(j.a)(E.a.mark((function e(){var t,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new te({token:c.token,url:c.serviceWizardURL}),o=(r-1)*a,i=a,e.next=5,t.getLinkedObjects(n,{offset:o,limit:i});case 5:return s=e.sent,console.log("linked",s),e.abrupt("return",s);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Ye.LOADING:case Ye.LOADED:case Ye.RELOADING:return Qe({},e,{linkedObjectsCollection:Qe({},e.linkedObjectsCollection,{status:Ye.LOADING})});case Ye.NONE:case Ye.ERROR:default:return Qe({},e,{linkedObjectsCollection:{status:Ye.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),i=new Ze(o),this.currentTask=i,e.prev=6,e.next=9,i.run();case 9:if(s=e.sent,!i.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return Qe({},e,{linkedObjectsCollection:{status:Ye.LOADED,data:Qe({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return Qe({},t,{linkedObjectsCollection:{status:Ye.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"queryLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c=this;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,t.sort,this.currentTask&&this.currentTask.cancel(),o=function(){var e=Object(j.a)(E.a.mark((function e(){var t,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new te({token:c.token,url:c.serviceWizardURL}),o=(r-1)*a,i=a,e.next=5,t.getLinkedObjects(n,{offset:o,limit:i});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Ye.LOADING:case Ye.LOADED:case Ye.RELOADING:return Qe({},e,{linkedObjectsCollection:Qe({},e.linkedObjectsCollection,{status:Ye.LOADING})});case Ye.NONE:case Ye.ERROR:default:return Qe({},e,{linkedObjectsCollection:{status:Ye.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),i=new Ze(o),this.currentTask=i,e.prev=6,e.next=9,i.run();case 9:if(s=e.sent,!i.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return Qe({},e,{linkedObjectsCollection:{status:Ye.LOADED,data:Qe({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return Qe({},t,{linkedObjectsCollection:{status:Ye.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(He),tt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"onChangePage",value:function(e,t){this.props.setPage(e,t||12)}},{key:"onChangeTable",value:function(e,t,n){var r;n.column&&n.column.dataIndex?r={sortColumn:n.column.dataIndex,sortDirection:function(e){switch(e){case"ascending":return Xe.ASCENDING;case"descending":return Xe.DESCENDING;default:throw new Error("Unknown sort direction: "+e)}}("descend"===n.order?"descending":"ascending")}:r=null;this.props.updateView(e.current||1,e.pageSize||12,r)}},{key:"componentDidMount",value:function(){this.props.setPage(1,12)}},{key:"componentDidUpdate",value:function(e){switch(e.linkedObjectsCollection.status){case Ye.NONE:case Ye.LOADING:case Ye.LOADED:case Ye.ERROR:case Ye.RELOADING:}}},{key:"renderLinkedObjects",value:function(e,t){return s.a.createElement(Le.a,{dataSource:e.linkedObjects,size:"small",className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",bordered:!1,rowKey:function(e){return[e.workspaceID,e.objectID,e.version].join("/")},pagination:{position:"top",defaultPageSize:12,total:e.totalCount},loading:t,onChange:this.onChangeTable.bind(this)},s.a.createElement(qe.a,{title:"Type",dataIndex:"type",width:"10%",render:function(e){var t=[[e.module,e.name].join("."),[e.majorVersion,e.minorVersion].join(".")].join("-");return s.a.createElement("a",{href:"/#spec/type/".concat(t),target:"_blank",rel:"noopener noreferrer"},e.name)}}),s.a.createElement(qe.a,{title:"Object",dataIndex:"objectName",width:"35%",sorter:!0,render:function(e,t){var n=["","#dataview",t.workspaceID,t.objectID,t.version].join("/"),r={fontStyle:"italic",marginRight:"3px"},a=s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement("span",{style:r},"Ref"),s.a.createElement("span",null,t.workspaceID,"/",t.objectID,"/",t.version)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Workspace ID"),s.a.createElement("span",null,t.workspaceID)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Object ID"),s.a.createElement("span",null,t.objectID)),s.a.createElement("div",null,s.a.createElement("span",{style:r},"Version"),s.a.createElement("span",null,t.version)));return s.a.createElement(ce.a,{title:a},s.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},e))}}),s.a.createElement(qe.a,{title:"Narrative",width:"35%",dataIndex:"workspaceID",render:function(e,t){switch(t.workspaceType){case Q.NARRATIVE:return s.a.createElement("a",{href:"/narrative/".concat(e),target:"_blank",rel:"noopener noreferrer"},t.title);case Q.REFDATA:case Q.UNKNOWN:return s.a.createElement("span",null,t.title)}}}),s.a.createElement(qe.a,{title:"Object Created",dataIndex:"createdAt",width:"10%",sorter:!0,render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}),s.a.createElement(qe.a,{title:"Linked At",dataIndex:"linkedAt",width:"10%",sorter:!0,defaultSortOrder:"descend",render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}))}},{key:"renderLoading",value:function(){return s.a.createElement(ve.a,null)}},{key:"renderError",value:function(e){return s.a.createElement(ue.a,{type:"error",message:e.message})}},{key:"render",value:function(){var e=this.props.linkedObjectsCollection;switch(e.status){case Ye.NONE:return this.renderLoading();case Ye.ERROR:return this.renderError(e.error);case Ye.LOADING:return this.renderLinkedObjects(e.data,!0);case Ye.LOADED:return this.renderLinkedObjects(e.data,!1);case Ye.RELOADING:return this.renderLinkedObjects(e.data,!0)}}}]),t}(s.a.Component),nt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.lastTaxonRef=void 0,n.db=new et({onUpdate:function(){n.forceUpdate()},initialData:{linkedObjectsCollection:{status:Ye.NONE}},token:e.token,config:e.config}),n.lastTaxonRef=e.taxonRef,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidUpdate",value:function(){this.lastTaxonRef!==this.props.taxonRef&&(this.lastTaxonRef=this.props.taxonRef,this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:1,pageSize:12}))}},{key:"fetchLinkedObjects",value:function(e,t){return this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t})}},{key:"queryLinkedObjects",value:function(e,t,n){return this.db.queryLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t,sort:n})}},{key:"render",value:function(){var e=this.db.get();return s.a.createElement(tt,{linkedObjectsCollection:e.linkedObjectsCollection,updateView:this.queryLinkedObjects.bind(this),setPage:this.fetchLinkedObjects.bind(this)})}}]),t}(s.a.Component);var rt=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(nt),at=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement(Ce.a,{defaultActiveKey:"detail",animated:!1,className:"FullHeight-tabs"},s.a.createElement(Ce.a.TabPane,{tab:"Detail",key:"detail",forceRender:!1},s.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},s.a.createElement(Ge,{taxon:this.props.taxon}))),s.a.createElement(Ce.a.TabPane,{tab:"Description",key:"description",forceRender:!1},s.a.createElement(Ke,{taxon:this.props.taxon})),s.a.createElement(Ce.a.TabPane,{tab:"Linked Data",key:"linkedData",forceRender:!1},s.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},s.a.createElement(rt,{taxonRef:this.props.taxon.ref}))))}}]),t}(s.a.Component),ot=(n(802),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderTaxonInfo",value:function(){return this.props.selectedTaxon?s.a.createElement(at,{taxon:this.props.selectedTaxon}):s.a.createElement("div",null,"No taxon selected")}},{key:"componentDidMount",value:function(){this.props.setTitle('Taxonomy Landing Page for "'+this.props.targetTaxon.name+'"')}},{key:"render",value:function(){return s.a.createElement("div",{className:"Col scrollable Taxonomy"},s.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},s.a.createElement(oe.a,null,s.a.createElement(ie.a,{span:12},s.a.createElement(Ie,{taxon:this.props.targetTaxon})),s.a.createElement(ie.a,{span:12},s.a.createElement(se,null)))),s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},s.a.createElement(De,{selectedTaxon:this.props.selectedTaxon,selectTaxonRef:this.props.selectTaxonRef,targetTaxon:this.props.targetTaxon,navigateToTaxonRef:this.props.navigateToTaxonREf})),s.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},this.renderTaxonInfo())))}}]),t}(s.a.Component)),it=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedTaxonRef=void 0,n.db=new ae({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n.currentlyNavigatedTaxonRef=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"selectTaxon",value:function(e){return this.db.getSelectedTaxon(e)}},{key:"navigateToTaxon",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(ge,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(ot,{targetTaxon:e.targetTaxon,selectedTaxon:e.selectedTaxon,selectTaxonRef:this.selectTaxon.bind(this),navigateToTaxonREf:this.navigateToTaxon.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTaxon(this.props.taxonRef)}},{key:"componentDidUpdate",value:function(e){e.taxonRef.id===this.props.taxonRef.id&&e.taxonRef.timestamp===this.props.taxonRef.timestamp||this.db.getTargetTaxon(this.props.taxonRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var st=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["taxonomy",_(t.namespace),t.id,String(t.timestamp)].join("/");e(W(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(it);var ct=Object(h.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(W(t))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(st),lt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getParents",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_parents",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTerms",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.ids,a=t.ts,o={ns:n,ids:r,ts:a},e.next=4,this.callFunc("get_terms",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_children",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRelatedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_children",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getHierarchicalAncestors",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,o={ns:n,id:r,ts:a,offset:0,limit:1e3},e.next=4,this.callFunc("get_hierarchical_ancestors",[o]);case 4:return i=e.sent,s=Object(k.a)(i,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(w.DynamicServiceClient);function ut(e){switch(e){case I.GO:return"go"}}function dt(e,t){switch(function(e){switch(e){case"go":return I.GO;default:throw new Error("Unknown ontology namespace: "+e)}}("go")){case I.GO:return{type:C.GO,ref:{collection:R.ONTOLOGY,namespace:I.GO,id:e.id,timestamp:t},namespace:e.namespace,comments:e.comments,definition:e.def.val,goID:e.id,isObsolete:!1,name:e.name,synonyms:{exact:e.synonyms.filter((function(e){return"hasExactSynonym"===e.pred})).map((function(e){return e.val})),narrow:e.synonyms.filter((function(e){return"hasNarrowSynonym"===e.pred})).map((function(e){return e.val})),broad:e.synonyms.filter((function(e){return"hasBroadSynonym"===e.pred})).map((function(e){return e.val})),related:e.synonyms.filter((function(e){return"hasRelatedSynonym"===e.pred})).map((function(e){return e.val}))}}}}function pt(e){switch(e){case"is_a":return L.IS_A;case"part_of":return L.PART_OF;case"has_part":return L.HAS_PART;case"regulates":return L.REGULATES;case"positively_regulates":return L.POSITIVELY_REGULATES;case"negatively_regulates":return L.NEGATIVELY_REGULATES;case"occurs_in":return L.OCCURS_IN;case"ends_during":return L.ENDS_DURING;case"happens_during":return L.HAPPENS_DURING;default:throw new Error("Unknown relation: "+e)}}function ft(e){switch(e){case L.IS_A:return"is_a";case L.PART_OF:return"part_of";case L.HAS_PART:return"has_part";case L.REGULATES:return"regulates";case L.POSITIVELY_REGULATES:return"positively_regulates";case L.NEGATIVELY_REGULATES:return"negatively_regulates";case L.OCCURS_IN:return"occurs_in";case L.ENDS_DURING:return"ends_during";case L.HAPPENS_DURING:return"happens_during"}}function mt(e,t){return{term:dt(e.term,t),relation:pt(e.edge.type)}}lt.module="OntologyAPI";var ht=function(){function e(t){var n=t.token,r=t.url;Object(u.a)(this,e),this.ontologyClient=void 0,this.token=void 0,this.url=void 0,this.token=n,this.url=r,this.ontologyClient=new lt({token:n,url:r})}return Object(d.a)(e,[{key:"getTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new lt({token:this.token,url:this.url}),e.next=4,r.getTerms({ns:ut(n.namespace),ids:[n.id],ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{term:dt(a.results[0],a.ts)});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getParents",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new lt({token:this.token,url:this.url}),e.next=4,r.getParents({ns:ut(n.namespace),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return mt(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new lt({token:this.token,url:this.url}),e.next=4,r.getChildren({ns:ut(n.namespace),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return mt(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAncestorGraph",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new lt({token:this.token,url:this.url}),e.next=4,r.getHierarchicalAncestors({ns:ut(n.namespace),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,o=[],a.results.forEach((function(e){var t=pt(e.edge.type);o.some((function(n){return n.from===e.edge.from&&n.to===e.edge.to&&n.relation===t}))||o.push({relation:t,from:e.edge.from,to:e.edge.to})})),i=o.reduce((function(e,t){var n=e.get(t.from);return n||(n=[]),n.push(t),e.set(t.from,n),e}),new Map),s=new Map,a.results.forEach((function(e){if(!s.has(e.term.id)){var t=dt(e.term,a.ts),n=!1;i.get(t.ref.id)||(console.log("is root"),n=!0),s.set(e.term.id,{id:t.ref.id,term:t,isRoot:n})}})),e.abrupt("return",{termsGraph:{terms:Array.from(s.values()),relations:o}});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function vt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ot=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getTargetTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return bt({},e,{status:q.LOADING})})),n=new ht({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getTerm({ref:t});case 5:r=e.sent,a=r.term,this.set((function(e){return bt({},e,{status:q.LOADED,targetTerm:a,selectedTerm:a})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return bt({},t,{status:q.ERROR,error:e.t0.message})}));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setSelectedTerm",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.get().status===q.LOADED){e.next=3;break}return e.abrupt("return");case 3:return n=new ht({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=6,n.getTerm({ref:t});case 6:r=e.sent,a=r.term,this.set((function(e){return bt({},e,{selectedTerm:a})}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),gt=(n(803),n(804),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderGOLink",value:function(e){var t="http://amigo.geneontology.org/amigo/term/".concat(e.goID),n=this.props.newWindow?"_blank":"_parent",r=s.a.createElement(s.a.Fragment,null,s.a.createElement("p",null,"Link to the Gene Ontology AmiGO page for this term."),s.a.createElement("p",null,"Opens in a separate window or tab."));return s.a.createElement(ce.a,{title:r},s.a.createElement("a",{href:t,target:n},e.ref.id," ",s.a.createElement(J.a,{type:"link"})))}},{key:"render",value:function(){var e=this.props.term;switch(e.type){case C.GO:return this.renderGOLink(e)}}}]),t}(s.a.Component));function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var kt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getLinkedObjects",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.set((function(e){return Et({},e,{status:q.LOADING})})),n=[{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005a"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005b"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005c"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005d"}],this.set((function(e){return Et({},e,{status:q.LOADED,linkedObjects:n})}))}catch(t){this.set((function(e){return{status:q.ERROR,error:{code:"not-found",source:"LinkedObjectsDB.getLinkedObjects",message:t.message}}}))}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),jt=(n(805),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderTable",value:function(){return s.a.createElement(Le.a,{dataSource:this.props.linkedObjects,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,scroll:{y:"100%"},rowKey:function(e){return[e.object.workspaceID,e.object.id,e.object.version,e.feature].join(":")},bordered:!1},s.a.createElement(Le.a.Column,{dataIndex:"scientificName",title:"Scientific Name",width:"40%"}),s.a.createElement(Le.a.Column,{dataIndex:"type.name",title:"Type",width:"30%"}),s.a.createElement(Le.a.Column,{dataIndex:"feature",title:"Feature",width:"30%"}))}},{key:"renderNone",value:function(){return s.a.createElement("p",{style:{fontStyle:"italic"}},"No objects use this term.")}},{key:"render",value:function(){return 0===this.props.linkedObjects.length?this.renderNone():this.renderTable()}}]),t}(s.a.Component)),wt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.db=new kt({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case q.NONE:this.db.getLinkedObjects(this.props.termRef)}}},{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement(ge,{error:e.error})}},{key:"renderLoaded",value:function(e){return s.a.createElement(jt,{linkedObjects:e.linkedObjects})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Nt=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(wt);function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Rt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getChildrenTerms",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return xt({},e,{status:q.LOADING})})),n=new ht({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getChildren({ref:t});case 5:r=e.sent,(a=r.terms).sort((function(e,t){return e.term.name.localeCompare(t.term.name)})),this.set((function(e){return xt({},e,{status:q.LOADED,terms:a})})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return xt({},t,{status:q.ERROR,error:e.t0.message})}));case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),Dt=(n(806),function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderRelation",value:function(e){return ft(e)}},{key:"renderItemsTable",value:function(){var e=this;return s.a.createElement(Le.a,{dataSource:this.props.terms,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,rowKey:function(e){return e.term.ref.id},scroll:{y:"100%"}},s.a.createElement(qe.a,{dataIndex:"term.name",title:"Name",width:"60%"}),s.a.createElement(qe.a,{dataIndex:"term.goID",title:"ID",width:"20%",render:function(e,t){var n=s.a.createElement("div",null,t.term.name,s.a.createElement("br",null),t.term.goID,s.a.createElement("hr",null),t.term.definition);return s.a.createElement(ce.a,{title:n,placement:"left"},s.a.createElement("a",{href:"/#review/ontology/go/".concat(e,"/").concat(t.term.ref.timestamp),target:"_parent"},e))}}),s.a.createElement(qe.a,{dataIndex:"relation",title:"Relation",width:"20%",render:function(t){return e.renderRelation(t)}}))}},{key:"renderNoItems",value:function(){return s.a.createElement(be.a,{description:"No Children",image:be.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsTable()}}]),t}(s.a.Component)),It=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new Rt({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(ge,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(Dt,{terms:e.terms})}},{key:"componentDidMount",value:function(){this.db.getChildrenTerms(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Ct=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",ut(t.namespace),t.id,String(t.timestamp)].join("/");e(W(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(It);function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(n,!0).forEach((function(t){Object(v.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var St=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"getAncestorGraph",value:function(){var e=Object(j.a)(E.a.mark((function e(t){var n,r,a,o,i,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return At({},e,{status:q.LOADING})})),n=new ht({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getTerm({ref:t});case 5:return r=e.sent,a=r.term,e.next=9,n.getAncestorGraph({ref:t});case 9:o=e.sent,i=o.termsGraph,s={id:a.ref.id,isRoot:!1,term:a},i.terms.push(s),this.set((function(e){return At({},e,{status:q.LOADED,graph:i,term:a})})),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return At({},t,{status:q.ERROR,error:{code:"error",source:"ancestor-graph-data-fetch",message:e.t0.message}})}));case 20:case"end":return e.stop()}}),e,this,[[2,16]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Z),Gt=n(205),Pt=(n(807),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).networkGraphNode=void 0,n.graphNode=void 0,n.network=void 0,n.graphNode=s.a.createRef(),n.networkGraphNode=s.a.createRef(),n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"mountGraph",value:function(){var e=this;if(null!==this.graphNode.current){var t=new Gt.a({});t.add(this.props.data.nodes.map((function(e){var t;return t=e.isTerm?"red":"black",e.isRoot&&(t="green"),{id:e.id,label:e.label,color:{border:t},shape:e.isRoot||e.isTerm?"ellipse":"box"}})));var n=new Gt.a({});n.add(this.props.data.edges.map((function(e){return{from:e.from,to:e.to,arrows:"to",label:e.label}})));var r={layout:{hierarchical:{enabled:!0,direction:"DU",sortMethod:"directed",nodeSpacing:300}},physics:!1,height:"400px",nodes:{color:{highlight:{border:"blue",background:"rgb(204, 255, 255, 1)"}},margin:{top:10,right:10,bottom:10,left:10}}};this.network=new Gt.b(this.graphNode.current,{nodes:t,edges:n},r),this.network.on("selectNode",(function(t){var n=Object(k.a)(t.nodes,1)[0];e.props.selectNodeID(n)})),this.props.selectedNodeID&&this.network.selectNodes([this.props.selectedNodeID])}}},{key:"componentDidMount",value:function(){var e=this;this.mountGraph(),window.addEventListener("resize",(function(){e.onResize()})),this.onResize()}},{key:"onResize",value:function(){var e;e=this.networkGraphNode.current?this.networkGraphNode.current.clientHeight+"px":"400px",this.network&&(this.network.setSize("100%",e),this.network.redraw())}},{key:"componentDidUpdate",value:function(){this.props.selectedNodeID&&this.network&&this.network.selectNodes([this.props.selectedNodeID])}},{key:"render",value:function(){return s.a.createElement("div",{ref:this.networkGraphNode,className:"NetworkGraph"},s.a.createElement("div",{ref:this.graphNode,className:"NetworkGraph-graphWrapper"}))}}]),t}(s.a.Component)),_t=(n(808),function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).state={selectedNodeID:null},n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"selectGraphNode",value:function(e){this.setState({selectedNodeID:e.term.ref.id})}},{key:"renderTable",value:function(){var e=this;return s.a.createElement(Le.a,{dataSource:this.props.graph.terms,size:"small",pagination:!1,scroll:{y:"100%"},className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",rowSelection:{type:"radio",fixed:!1,hideDefaultSelections:!0,selectedRowKeys:this.state.selectedNodeID?[this.state.selectedNodeID]:[]},rowKey:function(e){return e.id}},s.a.createElement(Le.a.Column,{dataIndex:"term",defaultSortOrder:"ascend",sorter:function(e,t){return e.term.name.localeCompare(t.term.name)},key:"term.id",title:"Name",width:"85%",render:function(t,n){return s.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){e.selectGraphNode(n)}},t.name)}}),s.a.createElement(Le.a.Column,{dataIndex:"term",sorter:function(e,t){return e.term.name.localeCompare(t.term.name)},title:"ID",width:"15%",render:function(e){var t=["/#review","ontology",M(e.ref.namespace),e.ref.id].join("/");return s.a.createElement("a",{href:t,target:"_parent"},e.ref.id)}}))}},{key:"selectNodeID",value:function(e){this.setState({selectedNodeID:e})}},{key:"render",value:function(){var e=this,t={nodes:this.props.graph.terms.map((function(t){var n=t.id===e.props.term.ref.id;return{id:t.id,label:t.term.name,isTerm:n,isRoot:t.isRoot,isSelected:t.term.ref.id===e.state.selectedNodeID}})),edges:this.props.graph.relations.map((function(e){return{from:e.from,to:e.to,label:ft(e.relation)}}))};return s.a.createElement("div",{className:"AncestorGraph"},s.a.createElement("div",{className:"AncestorGraph-graph"},s.a.createElement(Pt,{data:t,height:"400px",selectedNodeID:this.state.selectedNodeID,selectNodeID:this.selectNodeID.bind(this)})),s.a.createElement("div",{className:"AncestorGraph-table"},this.renderTable()))}}]),t}(s.a.Component)),Ut=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new St({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(ge,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(_t,{graph:e.graph,term:e.term})}},{key:"componentDidMount",value:function(){this.db.getAncestorGraph(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var zt=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",ut(t.namespace),t.id,String(t.timestamp)].join("/");e(W(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(Ut),Mt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderSynonyms",value:function(e){return 0===e.length?s.a.createElement("i",null,"-"):e.map((function(e,t){return s.a.createElement("div",{key:String(t)},e)}))}},{key:"renderComments",value:function(){return 0===this.props.term.comments.length?s.a.createElement("i",null,"-"):this.props.term.comments.map((function(e,t){return e.split("\n").map((function(e,n){return s.a.createElement("p",{key:String(t)+"-"+String(n)},e)}))}))}},{key:"renderDetail",value:function(){return s.a.createElement("div",{className:"InfoTable DetailTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement(gt,{term:this.props.term,newWindow:!0}))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Definition"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.definition)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"Comments"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderComments())),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"synonyms"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAllSynonyms())))}},{key:"renderAllSynonyms",value:function(){return s.a.createElement("div",{className:"InfoTable DetailTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"exact"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.exact))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"narrow"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.narrow))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"broad"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol"},"related"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))))}},{key:"renderGraph",value:function(){return s.a.createElement(zt,{termRef:this.props.term.ref})}},{key:"renderLinkedObjects",value:function(){return s.a.createElement(Nt,{termRef:this.props.term.ref})}},{key:"renderMetadata",value:function(){return s.a.createElement("div",null,"render metadata here...")}},{key:"renderChildren",value:function(){return s.a.createElement(Ct,{termRef:this.props.term.ref})}},{key:"render",value:function(){var e=[{tab:"graph",title:"Graph",component:this.renderGraph()},{tab:"detail",title:"Detail",component:this.renderDetail()},{tab:"synonyms",title:"Synonyms",component:this.renderAllSynonyms()},{tab:"children",title:"Children",component:this.renderChildren()},{tab:"linked",title:"Linked Data",component:this.renderLinkedObjects()}];return s.a.createElement(b.FlexTabs,{tabs:e})}}]),t}(s.a.Component),Bt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"Row"},s.a.createElement("div",{className:"Col-auto",style:{justifyContent:"center"}},s.a.createElement("img",{src:"images/go-logo.png",style:{height:"50px"},alt:"Gene Ontology Logo"})),s.a.createElement("div",{className:"Col"},s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),s.a.createElement("div",{className:"InfoTable-dataCol"},s.a.createElement("a",{href:"http://geneontology.org/",target:"_blank",rel:"noopener noreferrer"},"Gene Ontology (GO)"))),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),s.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(s.a.Component),Wt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"InfoTable"},s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"ID"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.goID)),s.a.createElement("div",{className:"InfoTable-row"},s.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),s.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)))}}]),t}(s.a.Component),Ft=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){this.props.setTitle('Ontology Landing Page for "'.concat(this.props.targetTerm.name,'" (').concat(this.props.targetTerm.goID,")"))}},{key:"renderLayout",value:function(){return s.a.createElement("div",{className:"Col scrollable Taxonomy"},s.a.createElement("div",{className:"Col-auto Ontology-summary-section"},s.a.createElement(oe.a,null,s.a.createElement(ie.a,{span:12},s.a.createElement(Wt,{term:this.props.targetTerm})),s.a.createElement(ie.a,{span:12},s.a.createElement(Bt,null)))),s.a.createElement("div",{className:"Row scrollable"},s.a.createElement("div",{className:"Col scrollable"},s.a.createElement(Mt,{term:this.props.selectedTerm}))))}},{key:"render",value:function(){return this.renderLayout()}}]),t}(s.a.Component),Yt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new Ot({onUpdate:function(){n.forceUpdate()},initialData:{status:q.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"selectTerm",value:function(e){return this.db.setSelectedTerm(e)}},{key:"navigateToTerm",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return s.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return s.a.createElement("div",{className:"Col"},s.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},s.a.createElement(ge,{error:e.error})))}},{key:"renderLoaded",value:function(e){return s.a.createElement(Ft,{targetTerm:e.targetTerm,selectedTerm:e.selectedTerm,selectTerm:this.selectTerm.bind(this),navigate:this.navigateToTerm.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTerm(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){e.termRef.id===this.props.termRef.id&&e.termRef.timestamp===this.props.termRef.timestamp||this.db.getTargetTerm(this.props.termRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case q.NONE:case q.LOADING:return this.renderLoading();case q.ERROR:return this.renderError(e);case q.LOADED:return this.renderLoaded(e)}}}]),t}(s.a.Component);var Vt=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",ut(t.namespace),t.id,String(t.timestamp)].join("/");e(W(n))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(Yt);var Kt=Object(h.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(W(t))},setTitle:function(t){e(Object(b.sendTitle)(t))}}}))(Vt),Xt=function(e){function t(){return Object(u.a)(this,t),Object(p.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(d.a)(t,[{key:"renderUnauthorized",value:function(){return s.a.createElement("div",null,"Sorry, not authorized. Please log in first.")}},{key:"renderRootState",value:function(){switch(this.props.rootState){case b.RootState.NONE:case b.RootState.HOSTED:case b.RootState.DEVELOP:return"";case b.RootState.ERROR:return"error"}}},{key:"renderNavigationNone",value:function(){return s.a.createElement("div",null,"none")}},{key:"renderNavigationSome",value:function(e){switch(e.type){case o.TAXONOMY:return s.a.createElement(ct,{taxonRef:e.ref});case o.ONTOLOGY:return console.log("navigation ref",e),s.a.createElement(Kt,{termRef:e.ref});default:console.error("Unhandled navigation",e)}}},{key:"renderNavigation",value:function(){switch(this.props.navigation.type){case o.NONE:return this.renderNavigationNone();default:return this.renderNavigationSome(this.props.navigation)}}},{key:"parseHash",value:function(e){var t=/^#(.*?)\/(.*)$/.exec(e);if(!t)throw new Error("Invalid path");var n=Object(k.a)(t,3);return{path:[n[1]],params:{relationEngineID:n[2]}}}},{key:"componentDidMount",value:function(){var e=this;if(this.props.rootState===b.RootState.DEVELOP){window.addEventListener("hashchange",(function(t){var n=new URL(t.newURL).hash;if(!n)throw new Error("no hash!");var r=e.parseHash(n).params.relationEngineID;e.props.navigate(r)}));var t=window.location.hash;if(t){var n=this.parseHash(t).params.relationEngineID;this.props.navigate(n)}else this.props.navigate("ontology/go/GO:0007610")}}},{key:"render",value:function(){return this.props.token?s.a.createElement("div",{className:"Col scrollable"},s.a.createElement("div",{className:"Row-auto"},this.renderRootState()),s.a.createElement("div",{className:"Row  scrollable"},this.renderNavigation())):this.renderUnauthorized()}}]),t}(s.a.Component);var Ht=Object(h.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.root.state,a=e.navigation,o=e.trigger;return{token:n?n.token:null,rootState:r,navigation:a,trigger:o}}),(function(e,t){return{navigate:function(t){e(W(t))}}}))(Xt),$t=Object(O.d)(X,$(),Object(O.c)(Object(O.a)(g.a))),qt=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(p.a)(this,Object(f.a)(t).call(this,e))).storeUnsubscribe=void 0,n.storeUnsubscribe=null,n}return Object(m.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e={view:null,params:{}};this.storeUnsubscribe=$t.subscribe((function(){var t=$t.getState();if(t){var n=t.app.runtime.navigation;if(t.auth.userAuthorization){var r=n.view,a=n.params;(r!==e.view||null===e.params||Object.keys(a).some((function(t){return a[t]!==e.params[t]})))&&(e.params=a,e.view=r,a.relationEngineID&&$t.dispatch(W(a.relationEngineID)))}}}))}},{key:"componentWillUnmount",value:function(){this.storeUnsubscribe&&this.storeUnsubscribe()}},{key:"render",value:function(){return s.a.createElement(h.Provider,{store:$t},s.a.createElement(b.AppBase,null,s.a.createElement(b.AuthGate,{required:!0},s.a.createElement("div",{className:"App Col scrollable"},s.a.createElement(Ht,null)))))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(qt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[391,1,2]]]);
//# sourceMappingURL=main.09b92fbb.chunk.js.map