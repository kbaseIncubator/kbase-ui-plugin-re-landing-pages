(window["webpackJsonpreact-app"]=window["webpackJsonpreact-app"]||[]).push([[0],{379:function(e){e.exports=JSON.parse('[[0,"Unspecified"],[1,"Standard"],[2,"Vertebrate Mitochondrial"],[3,"Yeast Mitochondrial"],[4,"Mold Mitochondrial; Protozoan Mitochondrial; Coelenterate Mitochondrial; Mycoplasma; Spiroplasma"],[5,"Invertebrate Mitochondrial"],[6,"Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear"],[9,"Echinoderm Mitochondrial; Flatworm Mitochondrial"],[10,"Euplotid Nuclear"],[11,"Bacterial, Archaeal and Plant Plastid"],[12,"Alternative Yeast Nuclear"],[13,"Ascidian Mitochondrial"],[14,"Alternative Flatworm Mitochondrial"],[15,"Blepharisma Macronuclear"],[16,"Chlorophycean Mitochondrial"],[21,"Trematode Mitochondrial"],[22,"Scenedesmus obliquus mitochondrial"],[23,"Thraustochytrium mitochondrial code"],[24,"Pterobranchia Mitochondrial"],[25,"Candidate Division SR1 and Gracilibacteria"],[26,"Pachysolen tannophilus Nuclear"],[27,"Karyorelict Nuclear"],[28,"Condylostoma Nuclear"],[29,"Mesodinium Nuclear"],[30,"Peritrich Nuclear"],[31,"Blastocrithidia Nuclear"],[32,"Balanophoraceae Plastid"],[33,"Cephalodiscidae Mitochondrial"]]')},384:function(e,t,n){e.exports=n(804)},389:function(e,t,n){},771:function(e,t,n){},774:function(e,t,n){},775:function(e,t,n){},777:function(e,t,n){},786:function(e,t,n){},787:function(e,t,n){},794:function(e,t,n){},795:function(e,t,n){},796:function(e,t,n){},797:function(e,t,n){},798:function(e,t,n){},799:function(e,t,n){},800:function(e,t,n){},801:function(e,t,n){},802:function(e,t,n){},803:function(e,t,n){},804:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(10),o=n.n(i),s=(n(389),n(13)),c=n(14),l=n(17),u=n(15),p=n(16),d=n(36),m=n(49),f=n(38),h=n(141),v=n(378),b=n(18),O=n.n(b),g=n(41),y=n(24),E=n(71),k=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getNodeInfo",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=/^(.*?)\/(.*)$/,r=/^([^/]+)\/([^/]+)(?:\/([^/]+))?$/,a=/^([^/]+)\/([^/]+)(?:\/([^/]+))?$/,e.abrupt("return",new Promise((function(e,i){var o=n.exec(t);if(o){var s=o,c=Object(g.a)(s,3),l=c[1],u=c[2];switch(l){case"taxonomy":!function(){if(o=r.exec(u)){4!==o.length&&i(new Error('Invalid relation engine id "'+t+'"'));var n,a=o,s=Object(g.a)(a,4),c=s[1],l=s[2],p=s[3];switch(n=p?parseInt(p,10):Date.now(),c){case"ncbi_taxonomy":return void e([{collection:"taxonomy",namespace:c,id:l,timestamp:n,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:i(new Error('Unrecognized taxonomy namespace "'+c+'"'))}}else i(new Error("Taxonomy ref is "))}();break;case"ontology":if(!(o=a.exec(u)))return void i(new Error("Taxonomy ref is "));var p,d=o,m=Object(g.a)(d,4),f=m[1],h=m[2],v=m[3];switch(p=v?parseInt(v):Date.now(),f){case"go":return void e([{collection:"ontology",namespace:f,id:h,timestamp:p,created:Date.now(),expired:new Date(2055,5,5).getTime()}]);default:return void i(new Error('Ontology namespace not found "'+f+'"'))}default:i(new Error("Collection ".concat(l," does not resolve to a type")))}}else i(new Error("Invalid relation engine ID "+t))})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),t}(E.DynamicServiceClient);k.module="relation_engine_api";var T,j,w,x,N,R,D,I,C,L=n(192);Object(L.a)(Error);function A(e){switch(e){case w.TAXONOMY:return"taxonomy";case w.ONTOLOGY:return"ontology"}}function S(e){switch(e){case x.NCBI:return"ncbi_taxonomy";case x.GTDB:return"gtdb"}}function P(e){switch(e){case"ncbi_taxonomy":return x.NCBI;case"gtdb":return x.GTDB;default:throw new Error('Unrecognized namespace "'+e+'"')}}function G(e){switch(e){case"go":return N.GO;default:throw new Error("Ontology namespace not supported: "+e)}}function _(e){switch(e){case N.GO:return"go"}}function U(e){return{type:C.NAVIGATE_SUCCESS,navigation:e}}function z(e){return function(){var t=Object(y.a)(O.a.mark((function t(n,r){var a,i,o,s,c,l,u;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n({type:C.NAVIGATE_START}),a=r(),i=a.auth.userAuthorization,o=a.app.config.services.ServiceWizard.url,i){t.next=4;break}return t.abrupt("return");case 4:return s=new k({url:o,token:i.token}),t.prev=5,t.next=8,s.getNodeInfo(e);case 8:c=t.sent,l=Object(g.a)(c,1),u=l[0],t.t0=u.collection,t.next="taxonomy"===t.t0?14:"ontology"===t.t0?16:18;break;case 14:return n(U({type:W.TAXONOMY,ref:{collection:w.TAXONOMY,namespace:P(u.namespace),id:u.id,timestamp:u.timestamp}})),t.abrupt("break",18);case 16:return n(U({type:W.ONTOLOGY,ref:{collection:w.ONTOLOGY,namespace:G(u.namespace),id:u.id,timestamp:u.timestamp}})),t.abrupt("break",18);case 18:t.next=24;break;case 20:t.prev=20,t.t1=t.catch(5),console.error("ERROR",t.t1),n((p=t.t1.message,{type:C.NAVIGATE_ERROR,message:p}));case 24:case"end":return t.stop()}var p}),t,null,[[5,20]])})));return function(e,n){return t.apply(this,arguments)}}()}function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function B(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{navigation:t.navigation,trigger:Date.now()})}!function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(T||(T={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(j||(j={})),function(e){e[e.TAXONOMY=0]="TAXONOMY",e[e.ONTOLOGY=1]="ONTOLOGY"}(w||(w={})),function(e){e[e.NCBI=0]="NCBI",e[e.GTDB=1]="GTDB"}(x||(x={})),function(e){e[e.GO=0]="GO"}(N||(N={})),function(e){e[e.GO=0]="GO"}(R||(R={})),function(e){e.IS_A="OntologyRelation$is_a",e.PART_OF="OntologyRelation$part_of"}(D||(D={})),function(e){e[e.EXACT=0]="EXACT",e[e.NARROW=1]="NARROW",e[e.BROAD=2]="BROAD",e[e.RELATED=3]="RELATED"}(I||(I={})),function(e){e.NAVIGATE="kbase-ui-plugin-landing-pages/navigate",e.NAVIGATE_START="kbase-ui-plugin-landing-pages/navigate/start",e.NAVIGATE_SUCCESS="kbase-ui-plugin-landing-pages/navigate/success",e.NAVIGATE_ERROR="kbase-ui-plugin-landing-pages/navigate/error"}(C||(C={}));var W,F,Y,V,X,q=function(e,t){var n=Object(f.baseReducer)(e,t);if(n)return n;if(!e)return e;switch(t.type){case C.NAVIGATE_SUCCESS:return B(e,t)}return e};function K(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function H(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(f.makeBaseStoreState)(),{navigation:{type:W.NONE},trigger:0,view:null})}!function(e){e[e.NONE=0]="NONE",e[e.TAXONOMY=1]="TAXONOMY",e[e.ONTOLOGY=2]="ONTOLOGY"}(W||(W={})),function(e){e[e.TAXON=0]="TAXON",e[e.ONTOLOGY_TERM=1]="ONTOLOGY_TERM"}(F||(F={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(Y||(Y={})),function(e){e[e.NONE=0]="NONE",e[e.LOADED=1]="LOADED",e[e.ERROR=2]="ERROR"}(V||(V={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(X||(X={}));n(771),n(81);var $,J=n(8);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.RELOADING=3]="RELOADING",e[e.ERROR=4]="ERROR"}($||($={}));var Q=function(){function e(t){Object(s.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(c.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),Z=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getLineage",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_lineage",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c,l,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i=t.offset,o=t.limit,s=t.searchTerm,e.next=3,this.callFunc("get_children",[{ns:n,id:r,ts:a,offset:i,limit:o,search_text:s}]);case 3:return c=e.sent,l=Object(g.a)(c,1),u=l[0],e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_taxon",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWorkspaceObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c,l,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxon_ns,r=t.taxon_id,a=t.ts,i=t.offset,o=t.limit,s={taxon_ns:n,taxon_id:r,ts:a,limit:o,offset:i},e.next=4,this.callFunc("get_associated_ws_objects",[s]);case 4:return c=e.sent,l=Object(g.a)(c,1),u=l[0],e.abrupt("return",u);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(E.DynamicServiceClient);Z.module="taxonomy_re_api";var ee=function(){function e(t){var n=t.token,r=t.url;Object(s.a)(this,e),this.taxonomyClient=void 0,this.taxonomyClient=new Z({token:n,url:r})}return Object(c.a)(e,[{key:"getLineage",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,r=t.id,a=t.timestamp,e.next=3,this.taxonomyClient.getLineage({ns:S(n),id:r,ts:a});case 3:return i=e.sent,o=i.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:w.TAXONOMY,namespace:x.NCBI,id:e.id,timestamp:i.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(O.a.mark((function e(t,n){var r,a,i,o,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.namespace,a=t.id,i=t.timestamp,e.next=3,this.taxonomyClient.getChildren({ns:S(r),id:a,ts:i,offset:n.offset,limit:n.limit,searchTerm:n.searchTerm});case 3:return o=e.sent,s=o.results.map((function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{ref:{collection:w.TAXONOMY,namespace:x.NCBI,id:e.id,timestamp:o.ts},name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:t}})),e.abrupt("return",[s,o.total_count]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.namespace,r=t.id,a=t.timestamp,e.next=3,this.taxonomyClient.getTaxon({ns:S(n),id:r,ts:a});case 3:return i=e.sent,o=i.results[0],s="root"!==o.scientific_name&&"cellular organisms"!==o.scientific_name,c={ref:{collection:w.TAXONOMY,namespace:x.NCBI,id:o.id,timestamp:i.ts},name:o.scientific_name,rank:o.rank,ncbiID:o.NCBI_taxon_id,geneticCode:parseInt(o.gencode),aliases:o.aliases.map((function(e){return{name:e.name,category:e.category}})),isBiological:s},e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t,n){var r,a,i;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={taxon_ns:S(t.namespace),taxon_id:t.id,ts:t.timestamp,offset:n.offset,limit:n.limit},e.next=3,this.taxonomyClient.getAssociatedWorkspaceObjects(r);case 3:return a=e.sent,i=a.results.map((function(e){return{linkedAt:e.edge.updated_at,objectID:e.ws_obj.object_id,workspaceID:e.ws_obj.workspace_id,version:e.ws_obj.version,objectName:e.ws_obj.name,createdAt:e.ws_obj.epoch,workspaceUpdatedAt:e.ws_obj.updated_at,type:{module:e.ws_obj.type.module_name,name:e.ws_obj.type.type_name,majorVersion:e.ws_obj.type.maj_ver,minorVersion:e.ws_obj.type.min_ver}}})),e.abrupt("return",{linkedObjects:i,totalCount:a.total_count});case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getTargetTaxon",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return ne({},e,{status:$.LOADING})})),n=new ee({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getTaxon(t);case 5:r=e.sent,this.set((function(e){return ne({},e,{status:$.LOADED,targetTaxon:r,selectedTaxon:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:$.ERROR,error:{code:"not-found",source:"TaxonDB.getTargetTaxon",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedTaxon",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new ee({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=4,n.getTaxon(t);case 4:r=e.sent,this.set((function(e){return ne({},e,{selectedTaxon:r})})),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:$.ERROR,error:{code:"not-found",source:"TaxonDB.getSelectedTaxon",message:e.t0.message}}}));case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),ae=(n(350),n(76)),ie=(n(352),n(52)),oe=(n(774),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Row"},a.a.createElement("div",{className:"Col-auto"},a.a.createElement("img",{src:"images/ncbi-logo.jpg",style:{height:"64px"},alt:"NCBI Logo"})),a.a.createElement("div",{className:"Col"},a.a.createElement("div",{className:"InfoTable"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),a.a.createElement("div",{className:"InfoTable-dataCol"},a.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/guide/taxonomy/",target:"_blank",rel:"noopener noreferrer"},"NCBI"))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),a.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(a.a.Component)),se=(n(775),n(182),n(40)),ce=(n(777),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"clickTaxon",value:function(){this.props.selectTaxonRef(this.props.taxon.ref)}},{key:"clickNavigateToTaxon",value:function(){var e=["review",A(this.props.taxon.ref.collection),S(this.props.taxon.ref.namespace),this.props.taxon.ref.id,String(this.props.taxon.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderOver",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),a.a.createElement("div",{className:"TaxonItem-inspector",onClick:this.clickTaxon.bind(this)},a.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"TaxonItem-name",onClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name),a.a.createElement("div",{className:"TaxonItem-inspector"},a.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"TaxonItem-name"},this.props.taxon.name))}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.taxon,t=["TaxonItem"];this.props.isActive&&t.push("TaxonItem-active");var n=a.a.createElement("div",null,a.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),a.a.createElement("div",null,e.rank));return a.a.createElement(se.a,{title:n,placement:"right"},a.a.createElement("div",{className:t.join(" "),key:this.props.taxon.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(a.a.Component)),le=(n(155),n(65));function ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ue(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ue(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var de=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"fetchChildren",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c,l,u,p,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,i=t.searchTerm,e.prev=1,this.set((function(e){return e.status===$.LOADED?pe({},e,{status:$.RELOADING}):pe({},e,{status:$.LOADING})})),o=new ee({token:this.token,url:this.serviceWizardURL}),s=(r-1)*a,c=a,e.next=8,o.getChildren(n,{offset:s,limit:c,searchTerm:i});case 8:l=e.sent,u=Object(g.a)(l,2),p=u[0],d=u[1],this.set((function(e){return pe({},e,{status:$.LOADED,taxa:p,total:d,page:r,pageSize:a})})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set((function(t){return{status:$.ERROR,error:{code:"not-found",source:"TaxonChildrenDB.fetchChildren",message:e.t0.message}}}));case 19:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),me=(n(354),n(77)),fe=(n(782),n(88)),he=(n(183),n(62)),ve=(n(156),n(60)),be=(n(786),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"selectTaxon",value:function(e){this.props.selectTaxonRef(e)}},{key:"navigateToTaxon",value:function(e){this.props.navigateToTaxonRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.taxa.map((function(t,n){var r=null!==e.props.selectedTaxonRef&&e.props.selectedTaxonRef.id===t.ref.id;return a.a.createElement(ce,{taxon:t,isActive:r,selectTaxonRef:e.selectTaxon.bind(e),key:String(n),navigateToTaxonRef:e.navigateToTaxon.bind(e)})}))}},{key:"renderNoItems",value:function(){return a.a.createElement(ve.a,{description:"No Children",image:ve.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.taxa.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(a.a.Component)),Oe=(n(787),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderMessage",value:function(){return a.a.createElement("span",null,a.a.createElement(J.a,{type:"exclamation-circle",style:{color:"red"}})," ",this.props.error.message)}},{key:"render",value:function(){return a.a.createElement(le.a,{type:"error",message:this.renderMessage()})}}]),t}(a.a.Component)),ge=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).searchTerm=void 0,n.page=void 0,n.pageSize=void 0,n.searchTerm="",n.page=1,n.pageSize=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchChildren(this.props.taxonRef,1,10,"")}},{key:"renderTaxaNone",value:function(){return a.a.createElement("div",null,"None")}},{key:"renderTaxaLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderTitleLoaded",value:function(e){if(0===e.total)return a.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"No Children");var t=Intl.NumberFormat("en-US",{useGrouping:!0}).format(e.total),n=(e.page-1)*e.pageSize+1,r=n+e.taxa.length-1;return a.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"Children (",n,"-",r," of ",t,")")}},{key:"renderTitleReLoading",value:function(e){return a.a.createElement(he.a,{size:"small"},this.renderTitleLoaded(e))}},{key:"renderTitle",value:function(){var e=this.props.db;switch(e.status){case $.NONE:case $.LOADING:return a.a.createElement("div",null,"Loading...");case $.ERROR:return a.a.createElement(Oe,{error:e.error});case $.LOADED:return this.renderTitleLoaded(e);case $.RELOADING:return this.renderTitleReLoading(e)}}},{key:"doSearch",value:function(e){this.searchTerm=e,this.props.fetchChildren(this.props.taxonRef,1,this.pageSize||10,e)}},{key:"renderSearch",value:function(){var e=this.props.db.status!==$.LOADED||this.props.db.total<=this.props.db.pageSize&&!this.searchTerm;return a.a.createElement("div",{style:{marginBottom:"4px"}},a.a.createElement(fe.a.Search,{placeholder:"Search Children",onSearch:this.doSearch.bind(this),disabled:e}))}},{key:"renderTaxaLoaded",value:function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(be,{taxa:e.taxa,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:e.total,maxItems:10}))}},{key:"renderTaxaReLoading",value:function(e){return a.a.createElement(he.a,{tip:"Loading"},this.renderTaxaLoaded(e))}},{key:"renderTaxaError",value:function(e){return a.a.createElement(Oe,{error:e.error})}},{key:"renderTaxa",value:function(){switch(this.props.db.status){case $.NONE:return this.renderTaxaNone();case $.LOADING:return this.renderTaxaLoading();case $.LOADED:return this.renderTaxaLoaded(this.props.db);case $.RELOADING:return this.renderTaxaReLoading(this.props.db);case $.ERROR:return this.renderTaxaError(this.props.db)}}},{key:"changePage",value:function(e,t){this.page=e,this.pageSize=t||10,this.props.fetchChildren(this.props.taxonRef,this.page,this.pageSize,this.searchTerm)}},{key:"renderPaginationNone",value:function(){return a.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoading",value:function(){return a.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationError",value:function(){return a.a.createElement(me.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoaded",value:function(e){return a.a.createElement(me.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,onChange:this.changePage.bind(this)})}},{key:"renderPaginationReLoading",value:function(e){return a.a.createElement(me.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,disabled:!0})}},{key:"renderPagination",value:function(){var e=this.props.db;switch(e.status){case $.NONE:return this.renderPaginationNone();case $.LOADING:return this.renderPaginationLoading();case $.ERROR:return this.renderPaginationError();case $.LOADED:return this.renderPaginationLoaded(e);case $.RELOADING:return this.renderPaginationReLoading(e)}}},{key:"renderChildren",value:function(){return a.a.createElement("div",null,this.renderTitle(),this.renderSearch(),this.renderPagination(),this.renderTaxa())}},{key:"render",value:function(){return this.renderChildren()}}]),t}(a.a.Component),ye=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new de({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"fetchChildren",value:function(e,t,n,r){return this.db.fetchChildren({taxonRef:e,page:t,pageSize:n,searchTerm:r})}},{key:"renderSuccess",value:function(e){return a.a.createElement(ge,{db:e,taxonRef:this.props.taxonRef,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,fetchChildren:this.fetchChildren.bind(this)})}},{key:"renderError",value:function(e){return a.a.createElement(le.a,{type:"error",message:e.error.message})}},{key:"renderTest",value:function(){return"test"}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.ERROR:return this.renderError(e);default:return this.renderSuccess(e)}}}]),t}(a.a.Component);var Ee=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(ye);function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var je=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getLineage",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set((function(e){return Te({},e,{status:$.LOADING})})),n=new ee({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getLineage(t);case 5:r=e.sent,this.set((function(e){return Te({},e,{status:$.LOADED,lineage:r})})),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set((function(t){return{status:$.ERROR,error:{code:"not-found",source:"LineageDB.getLineage",message:e.t0.message}}}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),we=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(be,{taxa:this.props.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef,totalItems:this.props.lineage.length,maxItems:10})}}]),t}(a.a.Component),xe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new je({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){switch(this.db.get().status){case $.NONE:this.db.getLineage(this.props.taxonRef)}}},{key:"componentWillUnmount",value:function(){}},{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement(Oe,{error:e.error})}},{key:"renderLoaded",value:function(e){return a.a.createElement(we,{lineage:e.lineage,selectedTaxonRef:this.props.selectedTaxonRef,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var Ne=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(xe),Re=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"onClick",value:function(e){this.props.selectTaxonRef(e)}},{key:"clickTaxon",value:function(e){this.props.selectTaxonRef(e.ref)}},{key:"renderLineage",value:function(){return a.a.createElement(Ne,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:this.props.selectedTaxon.ref,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderChildrenCount",value:function(e){return 0===e?a.a.createElement("div",{className:""},"No children"):1===e?a.a.createElement("div",null,"One child"):a.a.createElement("div",null,Intl.NumberFormat("en-US",{useGrouping:!0}).format(e)," ","children")}},{key:"renderChildren",value:function(){var e;return e=this.props.selectedTaxon?this.props.selectedTaxon.ref:null,a.a.createElement(Ee,{taxonRef:this.props.targetTaxon.ref,selectedTaxonRef:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"renderTargetTaxon",value:function(){var e=this.props.selectedTaxon&&this.props.selectedTaxon.ref.id===this.props.targetTaxon.ref.id&&this.props.selectedTaxon.ref.timestamp===this.props.targetTaxon.ref.timestamp;return a.a.createElement(ce,{taxon:this.props.targetTaxon,isActive:e,selectTaxonRef:this.props.selectTaxonRef,navigateToTaxonRef:this.props.navigateToTaxonRef})}},{key:"render",value:function(){return a.a.createElement("div",{className:"Col scrollable",style:{overflowY:"auto"}},a.a.createElement("div",{className:"Col-auto Nav-box"},a.a.createElement("div",{className:"Nav-box-title"},"Lineage"),this.renderLineage()),a.a.createElement("div",{className:"Col-auto Nav-box Lineage-target-taxon"},this.renderTargetTaxon()),a.a.createElement("div",{className:"Col-auto scrollable Nav-box"},this.renderChildren()))}}]),t}(a.a.Component),De=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={};return"species"===this.props.taxon.rank&&(e={fontStyle:"italic"}),a.a.createElement("div",{className:"InfoTable"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),a.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Rank"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)))}}]),t}(a.a.Component),Ie=(n(788),n(91)),Ce=(n(249),n(72));var Le=function(e){if(!(e instanceof Array))throw new Error("Invalid genetic codes file!");return e.map((function(e){var t=Object(g.a)(e,2),n=t[0],r=t[1];if("number"!==typeof n)throw new Error("Invalid genetic code id in file");if("string"!==typeof r)throw new Error("Invalid genetic code label in file");return[n,r]}))}(n(379)).reduce((function(e,t){var n=Object(g.a)(t,2),r=n[0],a=n[1];return e.set(r,a),e}),new Map),Ae=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderAliases",value:function(){var e=function(e,t){var n=e.replace(/^["']/,""),r=t.replace(/^["']/,"");return n.localeCompare(r)};return a.a.createElement(Ce.a,{dataSource:this.props.taxon.aliases,className:"KBaseAntdOverride-remove-table-border",size:"small",pagination:!1,scroll:{y:"25em"},rowKey:"name",bordered:!1},a.a.createElement(Ce.a.Column,{title:"Name",dataIndex:"name",key:"name",defaultSortOrder:"ascend",sorter:function(t,n){return e(t.name,n.name)}}),a.a.createElement(Ce.a.Column,{title:"Category",dataIndex:"category",key:"category",width:"20em",sorter:function(t,n){return e(t.category,n.category)}}))}},{key:"renderTaxonDetail",value:function(){var e={};return"species"===this.props.taxon.rank&&(e.fontStyle="italic"),a.a.createElement("div",{className:"InfoTable"},a.a.createElement("div",{className:"InfoTable-row",key:"name"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Name"),a.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),a.a.createElement("div",{className:"InfoTable-row",key:"rank"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Rank"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)),a.a.createElement("div",{className:"InfoTable-row",key:"ncbiid"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"NCBI ID"),a.a.createElement("div",{className:"InfoTable-dataCol"},a.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=".concat(this.props.taxon.ncbiID),target:"_blank",rel:"noopener noreferrer"},this.props.taxon.ncbiID))),a.a.createElement("div",{className:"InfoTable-row",key:"genetic-code"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Genetic Code"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.geneticCode," -"," ",Le.get(this.props.taxon.geneticCode)||"Unknown")),a.a.createElement("div",{className:"InfoTable-row",key:"aliases"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Aliases"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAliases())))}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderTaxonDetail())}}]),t}(a.a.Component),Se=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.taxon;switch(e.ref.namespace){case x.NCBI:return a.a.createElement(Ae,{taxon:e});default:return a.a.createElement(le.a,{type:"error",message:"This taxon type is not supported"})}}}]),t}(a.a.Component);function Pe(e,t,n){if("string"===typeof t)t=t.split(".");else if(!(t instanceof Array))throw new TypeError("Invalid type for key: "+typeof t);for(var r=e,a=0;a<t.length;a+=1){if(void 0===r||"object"!==typeof r||null===r)return n;r=r[t[a]]}return void 0===r?n:r}var Ge,_e=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).name="NotFound",n}return Object(p.a)(t,e),t}(Object(L.a)(Error)),Ue="https://en.wikipedia.org/w/api.php",ze=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"scrubTerm",value:function(e){var t=e.split(""),n=/[\w \s]/;return t.filter((function(e){return!!n.exec(e)})).join("")}},{key:"findTerm",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Empty term passed");case 2:return n=this.scrubTerm(t),e.abrupt("return",this.getWikipediaInfo(n).then((function(e){var t=e.imageUrl,n=e.pageUrl,r=e.introText,a=e.title,i=e.pageId,o=e.matchingTerms,s=e.exactMatch;return{imageUrl:t,pageUrl:n,introText:r.replace(/====/g,"####").replace(/===/g,"###").replace(/==/g,"##").replace(/\n/g,"  \n"),title:a,pageId:i,matchingTerms:o,exactMatch:s}})));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getWikipediaInfo",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPage(t).then((function(e){var t=e.wikiResponse,r=e.matchingTerms,a=e.exactMatch;return Promise.all([n.getImage({size:500,pageId:t.parse.pageid}),n.getPageInfo({pageId:t.parse.pageid})]).then((function(e){var n=Object(g.a)(e,2),i=n[0],o=n[1];return{imageUrl:i,pageUrl:o.url,introText:o.introText,title:t.parse.title,pageId:t.parse.pageid,matchingTerms:r,exactMatch:a}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/),r=!0,e.abrupt("return",new Promise((function(e,a){!function n(i){0===i.length&&a(new _e('No Wikipedia page found matching "'+t+'"'));var o=new URL(Ue),s=o.searchParams;s.set("action","parse"),s.set("format","json"),s.set("prop","text|headhtml"),s.set("section","0"),s.set("redirects",""),s.set("page",i.join(" "));s.set("origin","*"),fetch(o.toString(),{method:"GET",headers:{accept:"application/json"}}).then((function(t){switch(t.status){case 200:try{return t.json().then((function(t){if(t.error){if("missingtitle"===t.error.code)return i.pop(),r=!1,n(i),null;console.error("wikipedia api error",t),a(new Error("Wikipedia api error: "+t.error.code))}else e({wikiResponse:t,matchingTerms:i,exactMatch:r})}))}catch(s){a(new Error("Error parsing wikipedia response: "+s.message))}break;default:var o="Unexpected response from wikipedia api: "+t.status;console.error(o,t),a(new Error(o))}})).catch((function(e){a(e)}))}(n)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPageInfo",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageId,r=new URL(Ue),(a=r.searchParams).set("action","query"),a.set("pageids",n),a.set("prop","info|extracts"),a.set("explaintext","true"),a.set("inprop","url"),a.set("origin","*"),a.set("format","json"),e.abrupt("return",fetch(r.toString(),{method:"GET"}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return{url:Pe(e,["query","pages",String(n),"fullurl"],null),introText:Pe(e,["query","pages",String(n),"extract"],null)}}))}catch(r){throw console.error("error getting page info",r.message),r}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.size,r=t.pageId,a=new URL(Ue),(i=a.searchParams).set("action","query"),i.set("format","json"),i.set("prop","pageimages"),i.set("pithumbsize",String(n)),i.set("pageids",String(r)),i.set("origin","*"),o={accept:"application/json"},e.abrupt("return",fetch(a.toString(),{method:"GET",headers:o}).then((function(e){switch(e.status){case 200:try{return e.json().then((function(e){return Pe(e,["query","pages",String(r),"thumbnail","source"],null)}))}catch(n){throw new Error("Error parsing wikipedia response: "+n.message)}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}})).catch((function(e){var t="Error getting image from wikipedia: "+e.message;throw console.error(t,e),new Error("Error getting image from wikipedia: "+e.message)})));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Me=n(380),Be=n.n(Me),We=(n(794),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Loading-box"},a.a.createElement(he.a,{size:"large"}),a.a.createElement("br",null),this.props.message)}}]),t}(a.a.Component));n(795);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(Ge||(Ge={}));var Fe,Ye=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).wikipediaClient=void 0,n.canceled=void 0,n.wikipediaClient=new ze,n.canceled=!1,n.state={state:Ge.NONE},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){this.canceled=!0}},{key:"renderArticle",value:function(e){var t=Be()(e.introText);return a.a.createElement("div",{style:{overflow:"auto"},dangerouslySetInnerHTML:{__html:t}})}},{key:"renderImage",value:function(e){return e.imageUrl?a.a.createElement("div",null,a.a.createElement("img",{src:e.imageUrl,style:{width:"100%"},alt:"".concat(this.props.term)})):a.a.createElement("div",{className:"Wikipedia-empty-image"},a.a.createElement("div",{className:"-content"},"Image not found"))}},{key:"renderMatch",value:function(e){if(e.exactMatch){var t=a.a.createElement(a.a.Fragment,null,a.a.createElement(J.a,{type:"check",style:{color:"green"}}),' Exact match on "',e.matchingTerms.join(" "),'"');return a.a.createElement(le.a,{type:"success",message:t})}var n=a.a.createElement(a.a.Fragment,null,a.a.createElement(J.a,{type:"warning",style:{color:"orange"}}),' Inexact match on: "',e.matchingTerms.join(" "),'"');return a.a.createElement(le.a,{type:"warning",message:n})}},{key:"renderWikipediaLogoCredit",value:function(){return a.a.createElement("div",null,a.a.createElement("div",{style:{borderBottom:"1px solid gray"}},"Link to the original Wikipedia entry"),a.a.createElement("div",{style:{fontSize:"80%"}},a.a.createElement("p",{style:{textAlign:"center"}},"credit:",a.a.createElement("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",title:"Creative Commons Attribution-ShareAlike 3.0",target:"_blank",rel:"noopener noreferrer"},"CC BY-SA 3.0"),a.a.createElement("a",{href:"https://en.wikipedia.org/w/index.php?curid=33285413",target:"_blank",rel:"noopener noreferrer"},"Link"))))}},{key:"renderWikipediaInfo",value:function(e){return a.a.createElement("div",{className:"Row scrollable"},a.a.createElement("div",{className:"Col Col-grow-2 scrollable"},a.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"}},a.a.createElement("div",{style:{flex:"1 1 0px"}},this.renderMatch(e)),a.a.createElement("div",{style:{flex:"0 0 auto",alignSelf:"center",marginLeft:"10px"}},a.a.createElement("div",{style:{height:"32px",textAlign:"center"}},a.a.createElement(se.a,{title:this.renderWikipediaLogoCredit()},a.a.createElement("a",{href:e.pageUrl,target:"_blank",rel:"noopener noreferrer"},a.a.createElement("img",{src:"images/wikipedia-logo.svg",style:{height:"100%"},alt:"Wikipedia Logo"})))),a.a.createElement("div",null))),a.a.createElement("div",{className:"scrollable",style:{flex:"2 1 0px",paddingRight:"4px",marginRight:"4px",overflowY:"auto"}},this.renderArticle(e))),a.a.createElement("div",{className:"Col Col-grow-1",style:{flex:"1 1 0px",marginLeft:"10px"}},this.renderImage(e)))}},{key:"updateInfo",value:function(){var e=this,t=new ze,n=this.props.term;this.setState({state:Ge.LOADING}),t.findTerm(n).then((function(t){e.canceled||e.setState({state:Ge.LOADED,wikipediaInfo:t})})).catch((function(t){if(!e.canceled)return e.setState({state:Ge.ERROR,error:t.message})}))}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e,t){e.term!==this.props.term&&this.updateInfo()}},{key:"renderNone",value:function(){return a.a.createElement("div",null)}},{key:"renderLoading",value:function(){return a.a.createElement(We,{message:"Searching Wikipedia..."})}},{key:"renderLoaded",value:function(e){return this.renderWikipediaInfo(e.wikipediaInfo)}},{key:"renderError",value:function(e){return a.a.createElement(le.a,{type:"error",message:e.error})}},{key:"render",value:function(){if(!this.canceled)switch(this.state.state){case Ge.NONE:return this.renderNone();case Ge.LOADING:return this.renderLoading();case Ge.LOADED:return this.renderLoaded(this.state);case Ge.ERROR:return this.renderError(this.state)}}}]),t}(a.a.Component),Ve=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderTaxonDescription",value:function(){return a.a.createElement(Ye,{term:this.props.taxon.name})}},{key:"notBiological",value:function(){switch(this.props.taxon.name){case"root":return a.a.createElement("div",null,a.a.createElement("p",null,"This taxon is the topmost node in the NCBI Taxonomy tree."));case"cellular organisms":return a.a.createElement("div",null,a.a.createElement("p",null,"This taxon represents all cellular organisms."));default:return a.a.createElement("div",null,a.a.createElement("p",null,"Unknown non-biological taxon."))}}},{key:"render",value:function(){return this.props.taxon.isBiological?a.a.createElement("div",{className:"Col scrollable"},this.renderTaxonDescription()):this.notBiological()}}]),t}(a.a.Component);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR",e[e.RELOADING=4]="RELOADING"}(Fe||(Fe={}));var Xe,qe=function(){function e(t){Object(s.a)(this,e),this.db=void 0,this.stopped=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData},this.stopped=!1}return Object(c.a)(e,[{key:"forceComponentUpdate",value:function(){this.stopped||this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}},{key:"stop",value:function(){this.stopped=!0}}]),e}(),Ke=n(144),He=n.n(Ke);function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e[e.ASCENDING=0]="ASCENDING",e[e.DESCENDING=1]="DESCENDING"}(Xe||(Xe={}));var Qe=function(){function e(t){Object(s.a)(this,e),this.taskFun=void 0,this.hasResult=void 0,this.result=void 0,this.canceled=void 0,this.taskFun=t,this.result=null,this.hasResult=!1,this.canceled=!1}return Object(c.a)(e,[{key:"run",value:function(){var e=Object(y.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.taskFun();case 3:return this.result=e.sent,e.abrupt("return",this.result);case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"cancel",value:function(){this.canceled=!0}},{key:"get",value:function(){if(null===this.result)throw new Error("Attempt to fetch value when not set");return this.result}},{key:"isCanceled",value:function(){return this.canceled}}]),e}(),Ze=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.currentTask=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n.currentTask=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"fetchLinkedObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,this.currentTask&&this.currentTask.cancel(),i=function(){var e=Object(y.a)(O.a.mark((function e(){var t,i,o,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ee({token:c.token,url:c.serviceWizardURL}),i=(r-1)*a,o=a,e.next=5,t.getLinkedObjects(n,{offset:i,limit:o});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Fe.LOADING:case Fe.LOADED:case Fe.RELOADING:return Je({},e,{linkedObjectsCollection:Je({},e.linkedObjectsCollection,{status:Fe.LOADING})});case Fe.NONE:case Fe.ERROR:default:return Je({},e,{linkedObjectsCollection:{status:Fe.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),o=new Qe(i),this.currentTask=o,e.prev=6,e.next=9,o.run();case 9:if(s=e.sent,!o.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return Je({},e,{linkedObjectsCollection:{status:Fe.LOADED,data:Je({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return Je({},t,{linkedObjectsCollection:{status:Fe.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"queryLinkedObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c=this;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonRef,r=t.page,a=t.pageSize,t.sort,this.currentTask&&this.currentTask.cancel(),i=function(){var e=Object(y.a)(O.a.mark((function e(){var t,i,o,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new ee({token:c.token,url:c.serviceWizardURL}),i=(r-1)*a,o=a,e.next=5,t.getLinkedObjects(n,{offset:i,limit:o});case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),this.set((function(e){switch(e.linkedObjectsCollection.status){case Fe.LOADING:case Fe.LOADED:case Fe.RELOADING:return Je({},e,{linkedObjectsCollection:Je({},e.linkedObjectsCollection,{status:Fe.LOADING})});case Fe.NONE:case Fe.ERROR:default:return Je({},e,{linkedObjectsCollection:{status:Fe.LOADING,data:{linkedObjects:[],page:r,pageSize:a,totalCount:0}}})}})),o=new Qe(i),this.currentTask=o,e.prev=6,e.next=9,o.run();case 9:if(s=e.sent,!o.isCanceled()){e.next=12;break}return e.abrupt("return");case 12:this.set((function(e){return Je({},e,{linkedObjectsCollection:{status:Fe.LOADED,data:Je({},s,{page:r,pageSize:a})}})})),this.currentTask=null,e.next=20;break;case 16:e.prev=16,e.t0=e.catch(6),console.error("ERROR",e.t0),this.set((function(t){return Je({},t,{linkedObjectsCollection:{status:Fe.ERROR,error:{code:"not-found",message:e.t0.message,source:"LinkedDataDB.fetchLinkedObjects"}}})}));case 20:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(qe),et=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"onChangePage",value:function(e,t){this.props.setPage(e,t||12)}},{key:"onChangeTable",value:function(e,t,n){var r;n.column&&n.column.dataIndex?r={sortColumn:n.column.dataIndex,sortDirection:function(e){switch(e){case"ascending":return Xe.ASCENDING;case"descending":return Xe.DESCENDING;default:throw new Error("Unknown sort direction: "+e)}}("descend"===n.order?"descending":"ascending")}:r=null;this.props.updateView(e.current||1,e.pageSize||12,r)}},{key:"componentDidMount",value:function(){this.props.setPage(1,12)}},{key:"componentDidUpdate",value:function(e){switch(e.linkedObjectsCollection.status){case Fe.NONE:case Fe.LOADING:case Fe.LOADED:case Fe.ERROR:case Fe.RELOADING:}}},{key:"renderLinkedObjects",value:function(e,t){return a.a.createElement(Ce.a,{dataSource:e.linkedObjects,size:"small",className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",bordered:!1,rowKey:function(e){return[e.workspaceID,e.objectID,e.version].join("/")},pagination:{position:"top",defaultPageSize:12,total:e.totalCount},loading:t,onChange:this.onChangeTable.bind(this)},a.a.createElement(He.a,{title:"Type",dataIndex:"type",width:"10%",render:function(e){var t=[[e.module,e.name].join("."),[e.majorVersion,e.minorVersion].join(".")].join("-");return a.a.createElement("a",{href:"/#spec/type/".concat(t),target:"_blank",rel:"noopener noreferrer"},e.name)}}),a.a.createElement(He.a,{title:"Object",dataIndex:"objectName",width:"35%",sorter:!0,render:function(e,t){var n=["","#dataview",t.workspaceID,t.objectID,t.version].join("/"),r={fontStyle:"italic",marginRight:"3px"},i=a.a.createElement("div",null,a.a.createElement("div",null,a.a.createElement("span",{style:r},"Ref"),a.a.createElement("span",null,t.workspaceID,"/",t.objectID,"/",t.version)),a.a.createElement("div",null,a.a.createElement("span",{style:r},"Workspace ID"),a.a.createElement("span",null,t.workspaceID)),a.a.createElement("div",null,a.a.createElement("span",{style:r},"Object ID"),a.a.createElement("span",null,t.objectID)),a.a.createElement("div",null,a.a.createElement("span",{style:r},"Version"),a.a.createElement("span",null,t.version)));return a.a.createElement(se.a,{title:i},a.a.createElement("a",{href:n,target:"_blank",rel:"noopener noreferrer"},e))}}),a.a.createElement(He.a,{title:"Narrative",width:"35%",dataIndex:"workspaceID",render:function(e){return a.a.createElement("a",{href:"/narrative/".concat(e),target:"_blank",rel:"noopener noreferrer"},"Narrative or refdata ws title")}}),a.a.createElement(He.a,{title:"Object Created",dataIndex:"createdAt",width:"10%",sorter:!0,render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}),a.a.createElement(He.a,{title:"Linked At",dataIndex:"linkedAt",width:"10%",sorter:!0,defaultSortOrder:"descend",render:function(e){return Intl.DateTimeFormat("en-US").format(e)}}))}},{key:"renderLoading",value:function(){return a.a.createElement(he.a,null)}},{key:"renderError",value:function(e){return a.a.createElement(le.a,{type:"error",message:e.message})}},{key:"render",value:function(){var e=this.props.linkedObjectsCollection;switch(e.status){case Fe.NONE:return this.renderLoading();case Fe.ERROR:return this.renderError(e.error);case Fe.LOADING:return this.renderLinkedObjects(e.data,!0);case Fe.LOADED:return this.renderLinkedObjects(e.data,!1);case Fe.RELOADING:return this.renderLinkedObjects(e.data,!0)}}}]),t}(a.a.Component),tt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.lastTaxonRef=void 0,n.db=new Ze({onUpdate:function(){n.forceUpdate()},initialData:{linkedObjectsCollection:{status:Fe.NONE}},token:e.token,config:e.config}),n.lastTaxonRef=e.taxonRef,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidUpdate",value:function(){this.lastTaxonRef!==this.props.taxonRef&&(this.lastTaxonRef=this.props.taxonRef,this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:1,pageSize:12}))}},{key:"fetchLinkedObjects",value:function(e,t){return this.db.fetchLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t})}},{key:"queryLinkedObjects",value:function(e,t,n){return this.db.queryLinkedObjects({taxonRef:this.props.taxonRef,page:e,pageSize:t,sort:n})}},{key:"render",value:function(){var e=this.db.get();return a.a.createElement(et,{linkedObjectsCollection:e.linkedObjectsCollection,updateView:this.queryLinkedObjects.bind(this),setPage:this.fetchLinkedObjects.bind(this)})}}]),t}(a.a.Component);var nt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(tt),rt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement(Ie.a,{defaultActiveKey:"detail",animated:!1,className:"FullHeight-tabs"},a.a.createElement(Ie.a.TabPane,{tab:"Detail",key:"detail",forceRender:!1},a.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},a.a.createElement(Se,{taxon:this.props.taxon}))),a.a.createElement(Ie.a.TabPane,{tab:"Description",key:"description",forceRender:!1},a.a.createElement(Ve,{taxon:this.props.taxon})),a.a.createElement(Ie.a.TabPane,{tab:"Linked Data",key:"linkedData",forceRender:!1},a.a.createElement("div",{className:"Col",style:{overflowY:"auto"}},a.a.createElement(nt,{taxonRef:this.props.taxon.ref}))))}}]),t}(a.a.Component),at=(n(796),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderTaxonInfo",value:function(){return this.props.selectedTaxon?a.a.createElement(rt,{taxon:this.props.selectedTaxon}):a.a.createElement("div",null,"No taxon selected")}},{key:"componentDidMount",value:function(){this.props.setTitle('Taxonomy Landing Page for "'+this.props.targetTaxon.name+'"')}},{key:"render",value:function(){return a.a.createElement("div",{className:"Col scrollable Taxonomy"},a.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},a.a.createElement(ae.a,null,a.a.createElement(ie.a,{span:12},a.a.createElement(De,{taxon:this.props.targetTaxon})),a.a.createElement(ie.a,{span:12},a.a.createElement(oe,null)))),a.a.createElement("div",{className:"Row scrollable"},a.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},a.a.createElement(Re,{selectedTaxon:this.props.selectedTaxon,selectTaxonRef:this.props.selectTaxonRef,targetTaxon:this.props.targetTaxon,navigateToTaxonRef:this.props.navigateToTaxonREf})),a.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},this.renderTaxonInfo())))}}]),t}(a.a.Component)),it=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedTaxonRef=void 0,n.db=new re({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n.currentlyNavigatedTaxonRef=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"selectTaxon",value:function(e){return this.db.getSelectedTaxon(e)}},{key:"navigateToTaxon",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement("div",{className:"Col"},a.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},a.a.createElement(Oe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return a.a.createElement(at,{targetTaxon:e.targetTaxon,selectedTaxon:e.selectedTaxon,selectTaxonRef:this.selectTaxon.bind(this),navigateToTaxonREf:this.navigateToTaxon.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTaxon(this.props.taxonRef)}},{key:"componentDidUpdate",value:function(e){e.taxonRef.id===this.props.taxonRef.id&&e.taxonRef.timestamp===this.props.taxonRef.timestamp||this.db.getTargetTaxon(this.props.taxonRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var ot=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["taxonomy",S(t.namespace),t.id,String(t.timestamp)].join("/");e(z(n))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(it);var st=Object(d.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(z(t))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(ot),ct=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getParents",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_parents",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTerms",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.ids,a=t.ts,i={ns:n,ids:r,ts:a},e.next=4,this.callFunc("get_terms",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_children",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRelatedObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a,i,o,s,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ns,r=t.id,a=t.ts,i={ns:n,id:r,ts:a},e.next=4,this.callFunc("get_children",[i]);case 4:return o=e.sent,s=Object(g.a)(o,1),c=s[0],e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(E.DynamicServiceClient);function lt(e){switch(e){case N.GO:return"go"}}function ut(e,t){switch(function(e){switch(e){case"go":return N.GO;default:throw new Error("Unknown ontology namespace: "+e)}}("go")){case N.GO:return{type:R.GO,ref:{collection:w.ONTOLOGY,namespace:N.GO,id:e.id,timestamp:t},namespace:e.namespace,comments:e.comments,definition:e.def.val,goID:e.id,isObsolete:!1,name:e.name,synonyms:{exact:e.synonyms.filter((function(e){return"hasExactSynonym"===e.pred})).map((function(e){return e.val})),narrow:e.synonyms.filter((function(e){return"hasNarrowSynonym"===e.pred})).map((function(e){return e.val})),broad:e.synonyms.filter((function(e){return"hasBroadSynonym"===e.pred})).map((function(e){return e.val})),related:e.synonyms.filter((function(e){return"hasRelatedSynonym"===e.pred})).map((function(e){return e.val}))}}}}function pt(e,t){return ut(e.term,t)}ct.module="OntologyAPI";var dt=function(){function e(t){var n=t.token,r=t.url;Object(s.a)(this,e),this.ontologyClient=void 0,this.token=void 0,this.url=void 0,this.token=n,this.url=r,this.ontologyClient=new ct({token:n,url:r})}return Object(c.a)(e,[{key:"getTerm",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new ct({token:this.token,url:this.url}),e.next=4,r.getTerms({ns:lt(n.namespace),ids:[n.id],ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{term:ut(a.results[0],a.ts)});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getParents",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new ct({token:this.token,url:this.url}),e.next=4,r.getParents({ns:lt(n.namespace),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return pt(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.ref,r=new ct({token:this.token,url:this.url}),e.next=4,r.getChildren({ns:lt(n.namespace),id:n.id,ts:n.timestamp||Date.now()});case 4:return a=e.sent,e.abrupt("return",{terms:a.results.map((function(e){return pt(e,a.ts)}))});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ht=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getTargetTerm",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return ft({},e,{status:$.LOADING})})),n=new dt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getTerm({ref:t});case 5:r=e.sent,a=r.term,this.set((function(e){return ft({},e,{status:$.LOADED,targetTerm:a,selectedTerm:a})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return ft({},t,{status:$.ERROR,error:e.t0.message})}));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setSelectedTerm",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.get().status===$.LOADED){e.next=3;break}return e.abrupt("return");case 3:return n=new dt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=6,n.getTerm({ref:t});case 6:r=e.sent,a=r.term,this.set((function(e){return ft({},e,{selectedTerm:a})}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),vt=(n(797),n(798),n(799),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).state={hovering:!1},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"clickTerm",value:function(){this.props.selectTerm(this.props.term.ref)}},{key:"clickNavigateToTerm",value:function(){var e=["review","ontology",_(this.props.term.ref.namespace),this.props.term.ref.id,String(this.props.term.ref.timestamp)].join("/");window.parent?window.parent.location.hash=e:window.location.hash=e}},{key:"onMouseEnter",value:function(e){this.setState({hovering:!0})}},{key:"onMouseLeave",value:function(e){this.setState({hovering:!1})}},{key:"renderTerm",value:function(){return a.a.createElement("div",{className:"OntologyTerm-term",onClick:this.clickNavigateToTerm.bind(this)},a.a.createElement("div",{className:"OntologyTerm-name"},this.props.term.name))}},{key:"renderOver",value:function(){return a.a.createElement(a.a.Fragment,null,this.renderTerm(),a.a.createElement("div",{className:"OntologyTerm-inspector",onClick:this.clickTerm.bind(this)},a.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderActive",value:function(){return a.a.createElement(a.a.Fragment,null,this.renderTerm(),a.a.createElement("div",{className:"OntologyTerm-inspector"},a.a.createElement(J.a,{type:"arrow-right"})))}},{key:"renderNormal",value:function(){return this.renderTerm()}},{key:"renderItem",value:function(){return this.props.isActive?this.renderActive():this.state.hovering?this.renderOver():this.renderNormal()}},{key:"render",value:function(){var e=this.props.term,t=["OntologyTerm"];this.props.isActive&&t.push("OntologyTerm-active");var n=a.a.createElement("div",null,a.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),e.ref.id);return a.a.createElement(se.a,{title:n,placement:"right",key:this.props.term.ref.id},a.a.createElement("div",{className:t.join(" "),key:this.props.term.ref.id,onMouseEnter:this.onMouseEnter.bind(this),onMouseLeave:this.onMouseLeave.bind(this)},this.renderItem()))}}]),t}(a.a.Component));function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var gt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getChildrenTerms",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return Ot({},e,{status:$.LOADING})})),n=new dt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getChildren({ref:t});case 5:r=e.sent,(a=r.terms).sort((function(e,t){return e.name.localeCompare(t.name)})),this.set((function(e){return Ot({},e,{status:$.LOADED,terms:a})})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return Ot({},t,{status:$.ERROR,error:e.t0.message})}));case 15:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),yt=(n(800),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"navigateToTerm",value:function(e){this.props.navigateToTermRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.terms.map((function(t){var n=null!==e.props.selectedTermRef&&e.props.selectedTermRef.collection===t.ref.collection&&e.props.selectedTermRef.namespace===t.ref.namespace&&e.props.selectedTermRef.id===t.ref.id;return a.a.createElement(vt,{term:t,isActive:n,selectTerm:e.props.selectTerm.bind(e),key:t.ref.id,navigateToTermRef:e.navigateToTerm.bind(e)})}))}},{key:"renderNoItems",value:function(){return a.a.createElement(ve.a,{description:"No Children",image:ve.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(a.a.Component)),Et=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new gt({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"navigateToTerm",value:function(e){return this.props.navigateToTermRef(e)}},{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement("div",{className:"Col"},a.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},a.a.createElement(Oe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return a.a.createElement(yt,{terms:e.terms,selectedTermRef:this.props.selectedTermRef,selectTerm:this.props.selectTerm.bind(this),navigateToTermRef:this.props.navigateToTermRef.bind(this)})}},{key:"componentDidMount",value:function(){this.db.getChildrenTerms(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var kt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",lt(t.namespace),t.id,String(t.timestamp)].join("/");e(z(n))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(Et);function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var wt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getParentTerms",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.set((function(e){return jt({},e,{status:$.LOADING})})),n=new dt({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.prev=2,e.next=5,n.getParents({ref:t});case 5:r=e.sent,a=r.terms,this.set((function(e){return jt({},e,{status:$.LOADED,terms:a})})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),console.error("ERROR",e.t0),this.set((function(t){return jt({},t,{status:$.ERROR,error:e.t0.message})}));case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),xt=(n(801),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"navigateToTerm",value:function(e){this.props.navigateToTermRef(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.terms.map((function(t){var n=null!==e.props.selectedTermRef&&e.props.selectedTermRef.collection===t.ref.collection&&e.props.selectedTermRef.namespace===t.ref.namespace&&e.props.selectedTermRef.id===t.ref.id;return a.a.createElement(vt,{term:t,isActive:n,selectTerm:e.props.selectTerm.bind(e),key:t.ref.id,navigateToTermRef:e.navigateToTerm.bind(e)})}))}},{key:"renderNoItems",value:function(){return a.a.createElement(ve.a,{description:"No Children",image:ve.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.terms.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(a.a.Component)),Nt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new wt({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"navigateToTerm",value:function(e){return this.props.navigateToTermRef(e)}},{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement("div",{className:"Col"},a.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},a.a.createElement(Oe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return a.a.createElement(xt,{terms:e.terms,selectedTermRef:this.props.selectedTermRef,selectTerm:this.props.selectTerm.bind(this),navigateToTermRef:this.props.navigateToTermRef.bind(this)})}},{key:"componentDidMount",value:function(){this.db.getParentTerms(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var Rt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",lt(t.namespace),t.id,String(t.timestamp)].join("/");e(z(n))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(Nt),Dt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"navigateToTermRef",value:function(e){console.log("navigating to ",e)}},{key:"render",value:function(){var e=null!==this.props.selectedTerm&&this.props.selectedTerm.ref.collection===this.props.targetTerm.ref.collection&&this.props.selectedTerm.ref.namespace===this.props.targetTerm.ref.namespace&&this.props.selectedTerm.ref.id===this.props.targetTerm.ref.id;return a.a.createElement("div",{className:"Col scrollable OntologyNav"},a.a.createElement("div",{className:"Nav-box Col-auto"},a.a.createElement("div",{className:"Col Nav-box-title"},"Parents"),a.a.createElement("div",{className:"Col Nav-box-content"},a.a.createElement(Rt,{termRef:this.props.selectedTerm.ref,selectedTermRef:this.props.selectedTerm.ref,selectTerm:this.props.selectTerm.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)}))),a.a.createElement("div",{className:"Nav-box Col-auto"},a.a.createElement("div",{className:"Col-auto Nav-box-title"},"Selected Term"),a.a.createElement("div",{className:"Col Nav-box-content"},a.a.createElement(vt,{term:this.props.targetTerm,isActive:e,selectTerm:this.props.selectTerm.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)}))),a.a.createElement("div",{className:"Nav-box Col scrollable"},a.a.createElement("div",{className:"Col-auto Nav-box-title"},"Children"),a.a.createElement("div",{className:"Col Nav-box-content",style:{overflowY:"auto"}},a.a.createElement(kt,{termRef:this.props.selectedTerm.ref,selectedTermRef:this.props.selectedTerm.ref,selectTerm:this.props.selectTerm.bind(this),navigateToTermRef:this.navigateToTermRef.bind(this)}))))}}]),t}(a.a.Component),It=(n(802),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderGOLink",value:function(e){var t="http://amigo.geneontology.org/amigo/term/".concat(e.goID),n=this.props.newWindow?"_blank":"_parent";return a.a.createElement("a",{href:t,target:n},e.ref.id)}},{key:"render",value:function(){var e=this.props.term;switch(e.type){case R.GO:return this.renderGOLink(e)}}}]),t}(a.a.Component));function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(n,!0).forEach((function(t){Object(m.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var At=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"getLinkedObjects",value:function(){var e=Object(y.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.set((function(e){return Lt({},e,{status:$.LOADING})})),n=[{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"},{object:{workspaceID:43747,id:4,version:1},type:{module:"KBaseGenomes",name:"Genome"},scientificName:"Escherichia coli",feature:"CF61_RS00005"}],this.set((function(e){return Lt({},e,{status:$.LOADED,linkedObjects:n})}))}catch(t){this.set((function(e){return{status:$.ERROR,error:{code:"not-found",source:"LinkedObjectsDB.getLinkedObjects",message:t.message}}}))}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),t}(Q),St=(n(803),function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderTable",value:function(){return a.a.createElement(Ce.a,{dataSource:this.props.linkedObjects,className:"KBaseAntdOverride-remove-table-border ScrollingFlexTable",size:"small",pagination:!1,scroll:{y:"100%"},bordered:!1},a.a.createElement(Ce.a.Column,{dataIndex:"scientificName",title:"Scientific Name",width:"40%"}),a.a.createElement(Ce.a.Column,{dataIndex:"type.name",title:"Type",width:"30%"}),a.a.createElement(Ce.a.Column,{dataIndex:"feature",title:"Feature",width:"30%"}))}},{key:"renderNone",value:function(){return a.a.createElement("p",{style:{fontStyle:"italic"}},"No objects use this term.")}},{key:"render",value:function(){return 0===this.props.linkedObjects.length?this.renderNone():this.renderTable()}}]),t}(a.a.Component)),Pt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.db=new At({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement(Oe,{error:e.error})}},{key:"renderLoaded",value:function(e){return a.a.createElement(St,{linkedObjects:e.linkedObjects})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:return this.db.getLinkedObjects(this.props.termRef),this.renderLoading();case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var Gt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(){return{}}))(Pt),_t=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderSynonyms",value:function(e){return 0===e.length?a.a.createElement("i",null,"-"):e.map((function(e,t){return a.a.createElement("div",{key:String(t)},e)}))}},{key:"renderComments",value:function(){return 0===this.props.term.comments.length?a.a.createElement("i",null,"-"):this.props.term.comments.map((function(e,t){return a.a.createElement("p",{key:String(t)},e)}))}},{key:"renderDetail",value:function(){return a.a.createElement("div",{className:"InfoTable DetailTable"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"ID"),a.a.createElement("div",{className:"InfoTable-dataCol"},a.a.createElement(It,{term:this.props.term,newWindow:!0}))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"Name"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"Definition"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.definition)),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"Comments"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderComments())),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"Synonyms"),a.a.createElement("div",{className:"InfoTable-dataCol"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"exact"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.exact))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"narrow"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.narrow))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"broad"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol"},"related"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.renderSynonyms(this.props.term.synonyms.broad))))))}},{key:"renderGraph",value:function(){return a.a.createElement("div",null,"graph here...")}},{key:"renderLinkedObjects",value:function(){return a.a.createElement(Gt,{termRef:this.props.term.ref})}},{key:"renderMetadata",value:function(){return a.a.createElement("div",null,"render metadata here...")}},{key:"render",value:function(){var e=[{tab:"detail",title:"Detail",component:this.renderDetail()},{tab:"linked",title:"Linked Objects",component:this.renderLinkedObjects()}];return a.a.createElement(f.FlexTabs,{tabs:e})}}]),t}(a.a.Component),Ut=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Row"},a.a.createElement("div",{className:"Col-auto"},a.a.createElement("img",{src:"images/go-logo.png",style:{height:"64px"},alt:"Gene Ontology Logo"})),a.a.createElement("div",{className:"Col"},a.a.createElement("div",{className:"InfoTable"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),a.a.createElement("div",{className:"InfoTable-dataCol"},a.a.createElement("a",{href:"http://geneontology.org/",target:"_blank",rel:"noopener noreferrer"},"Gene Ontology (GO)"))),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),a.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(a.a.Component),zt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"InfoTable"},a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"ID"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.goID)),a.a.createElement("div",{className:"InfoTable-row"},a.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),a.a.createElement("div",{className:"InfoTable-dataCol"},this.props.term.name)))}}]),t}(a.a.Component),Mt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.props.setTitle("Ontology Landing Page ".concat(this.props.targetTerm.name))}},{key:"renderLayout",value:function(){return a.a.createElement("div",{className:"Col scrollable Taxonomy"},a.a.createElement("div",{className:"Col-auto Ontology-summary-section"},a.a.createElement(ae.a,null,a.a.createElement(ie.a,{span:12},a.a.createElement(zt,{term:this.props.targetTerm})),a.a.createElement(ie.a,{span:12},a.a.createElement(Ut,null)))),a.a.createElement("div",{className:"Row scrollable"},a.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},a.a.createElement(Dt,{targetTerm:this.props.targetTerm,selectedTerm:this.props.selectedTerm,selectTerm:this.props.selectTerm.bind(this)})),a.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},a.a.createElement(_t,{term:this.props.selectedTerm}))))}},{key:"render",value:function(){return this.renderLayout()}}]),t}(a.a.Component),Bt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).db=void 0,n.currentlyNavigatedOntologyRef=void 0,n.db=new ht({onUpdate:function(){n.forceUpdate()},initialData:{status:$.NONE},token:e.token,config:e.config}),n.currentlyNavigatedOntologyRef=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"selectTerm",value:function(e){return this.db.setSelectedTerm(e)}},{key:"navigateToTerm",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return a.a.createElement(J.a,{type:"loading"})}},{key:"renderError",value:function(e){return a.a.createElement("div",{className:"Col"},a.a.createElement("div",{style:{width:"50%",margin:"20px auto 0 auto"}},a.a.createElement(Oe,{error:e.error})))}},{key:"renderLoaded",value:function(e){return a.a.createElement(Mt,{targetTerm:e.targetTerm,selectedTerm:e.selectedTerm,selectTerm:this.selectTerm.bind(this),navigate:this.navigateToTerm.bind(this),setTitle:this.props.setTitle})}},{key:"componentDidMount",value:function(){this.db.getTargetTerm(this.props.termRef)}},{key:"componentDidUpdate",value:function(e){e.termRef.id===this.props.termRef.id&&e.termRef.timestamp===this.props.termRef.timestamp||this.db.getTargetTerm(this.props.termRef)}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case $.NONE:case $.LOADING:return this.renderLoading();case $.ERROR:return this.renderError(e);case $.LOADED:return this.renderLoaded(e)}}}]),t}(a.a.Component);var Wt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:r}}),(function(e,t){return{navigate:function(t){var n=["ontology",lt(t.namespace),t.id,String(t.timestamp)].join("/");e(z(n))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(Bt);var Ft=Object(d.connect)((function(e,t){return{}}),(function(e,t){return{navigate:function(t){e(z(t))},setTitle:function(t){e(Object(f.sendTitle)(t))}}}))(Wt),Yt=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"renderUnauthorized",value:function(){return a.a.createElement("div",null,"Sorry, not authorized. Please log in first.")}},{key:"renderRootState",value:function(){switch(this.props.rootState){case f.RootState.NONE:case f.RootState.HOSTED:case f.RootState.DEVELOP:return"";case f.RootState.ERROR:return"error"}}},{key:"renderNavigationNone",value:function(){return a.a.createElement("div",null,"none")}},{key:"renderNavigationSome",value:function(e){switch(e.type){case W.TAXONOMY:return a.a.createElement(st,{taxonRef:e.ref});case W.ONTOLOGY:return console.log("navigation ref",e),a.a.createElement(Ft,{termRef:e.ref});default:console.error("Unhandled navigation",e)}}},{key:"renderNavigation",value:function(){switch(this.props.navigation.type){case W.NONE:return this.renderNavigationNone();default:return this.renderNavigationSome(this.props.navigation)}}},{key:"parseHash",value:function(e){var t=/^#(.*?)\/(.*)$/.exec(e);if(!t)throw new Error("Invalid path");var n=Object(g.a)(t,3);return{path:[n[1]],params:{relationEngineID:n[2]}}}},{key:"componentDidMount",value:function(){var e=this;if(this.props.rootState===f.RootState.DEVELOP){window.addEventListener("hashchange",(function(t){var n=new URL(t.newURL).hash;if(!n)throw new Error("no hash!");var r=e.parseHash(n).params.relationEngineID;e.props.navigate(r)}));var t=window.location.hash;if(t){var n=this.parseHash(t).params.relationEngineID;this.props.navigate(n)}else this.props.navigate("taxonomy/ncbi_taxonomy/562")}}},{key:"render",value:function(){return this.props.token?a.a.createElement("div",{className:"Col scrollable"},a.a.createElement("div",{className:"Row-auto"},this.renderRootState()),a.a.createElement("div",{className:"Row  scrollable"},this.renderNavigation())):this.renderUnauthorized()}}]),t}(a.a.Component);var Vt=Object(d.connect)((function(e,t){var n=e.auth.userAuthorization,r=e.root.state,a=e.navigation,i=e.trigger;return{token:n?n.token:null,rootState:r,navigation:a,trigger:i}}),(function(e,t){return{navigate:function(t){e(z(t))}}}))(Yt),Xt=Object(h.d)(q,H(),Object(h.c)(Object(h.a)(v.a))),qt=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).storeUnsubscribe=void 0,n.storeUnsubscribe=null,n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e={view:null,params:{}};this.storeUnsubscribe=Xt.subscribe((function(){var t=Xt.getState();if(t){var n=t.app.runtime.navigation;if(t.auth.userAuthorization){var r=n.view,a=n.params;(r!==e.view||null===e.params||Object.keys(a).some((function(t){return a[t]!==e.params[t]})))&&(e.params=a,e.view=r,a.relationEngineID&&Xt.dispatch(z(a.relationEngineID)))}}}))}},{key:"componentWillUnmount",value:function(){this.storeUnsubscribe&&this.storeUnsubscribe()}},{key:"render",value:function(){return a.a.createElement(d.Provider,{store:Xt},a.a.createElement(f.AppBase,null,a.a.createElement(f.AuthGate,{required:!0},a.a.createElement("div",{className:"App Col scrollable"},a.a.createElement(Vt,null)))))}}]),t}(a.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(qt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[384,1,2]]]);
//# sourceMappingURL=main.2c1c058c.chunk.js.map