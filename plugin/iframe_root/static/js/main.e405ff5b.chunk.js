(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{369:function(e){e.exports=[[0,"Unspecified"],[1,"Standard"],[2,"Vertebrate Mitochondrial"],[3,"Yeast Mitochondrial"],[4,"Mold Mitochondrial; Protozoan Mitochondrial; Coelenterate Mitochondrial; Mycoplasma; Spiroplasma"],[5,"Invertebrate Mitochondrial"],[6,"Ciliate Nuclear; Dasycladacean Nuclear; Hexamita Nuclear"],[9,"Echinoderm Mitochondrial; Flatworm Mitochondrial"],[10,"Euplotid Nuclear"],[11,"Bacterial, Archaeal and Plant Plastid"],[12,"Alternative Yeast Nuclear"],[13,"Ascidian Mitochondrial"],[14,"Alternative Flatworm Mitochondrial"],[15,"Blepharisma Macronuclear"],[16,"Chlorophycean Mitochondrial"],[21,"Trematode Mitochondrial"],[22,"Scenedesmus obliquus mitochondrial"],[23,"Thraustochytrium mitochondrial code"],[24,"Pterobranchia Mitochondrial"],[25,"Candidate Division SR1 and Gracilibacteria"],[26,"Pachysolen tannophilus Nuclear"],[27,"Karyorelict Nuclear"],[28,"Condylostoma Nuclear"],[29,"Mesodinium Nuclear"],[30,"Peritrich Nuclear"],[31,"Blastocrithidia Nuclear"],[32,"Balanophoraceae Plastid"],[33,"Cephalodiscidae Mitochondrial"]]},375:function(e,t,n){e.exports=n(765)},380:function(e,t,n){},737:function(e,t,n){},740:function(e,t,n){},745:function(e,t,n){},746:function(e,t,n){},748:function(e,t,n){},755:function(e,t,n){},756:function(e,t,n){},763:function(e,t,n){},764:function(e,t,n){},765:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),o=n(9),c=n.n(o),s=(n(380),n(17)),l=n(18),u=n(21),p=n(19),d=n(20),h=n(46),f=n(70),m=n(71),g=n(139),v=n(368),b=n(24),O=n.n(b),y=n(56),E=n(36);function x(e){return function(){var t=Object(E.a)(O.a.mark(function t(n,r){var i,o,c,s;return O.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:switch(n({type:a.NAVIGATE_START}),i=e.split(":"),o=Object(y.a)(i,2),c=o[0],s=o[1],c){case"ncbi_taxon":n((r={type:j.TAXONOMY,relationEngineID:[c,s].join("/")},{type:a.NAVIGATE_SUCCESS,navigation:r}))}case 3:case"end":return t.stop()}var r},t)}));return function(e,n){return t.apply(this,arguments)}}()}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function T(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,{navigation:t.navigation,trigger:Date.now()})}!function(e){e.NAVIGATE="kbase-ui-plugin-landing-pages/navigate",e.NAVIGATE_START="kbase-ui-plugin-landing-pages/navigate/start",e.NAVIGATE_SUCCESS="kbase-ui-plugin-landing-pages/navigate/success",e.NAVIGATE_ERROR="kbase-ui-plugin-landing-pages/navigate/error"}(a||(a={}));var j,w,I,D=function(e,t){var n=Object(m.baseReducer)(e,t);if(n)return n;if(!e)return e;switch(t.type){case a.NAVIGATE_SUCCESS:return T(e,t)}return e};function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function L(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},Object(m.makeBaseStoreState)(),{navigation:{type:j.NONE},trigger:0})}!function(e){e[e.NONE=0]="NONE",e[e.TAXONOMY=1]="TAXONOMY",e[e.ONTOLOGY=2]="ONTOLOGY"}(j||(j={})),function(e){e[e.TAXON=0]="TAXON",e[e.ONTOLOGY_TERM=1]="ONTOLOGY_TERM"}(w||(w={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(I||(I={}));n(737),n(111);var C,R=n(50),S=n(91),A=(n(244),n(66)),P=(n(740),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"Loading-box"},i.a.createElement(A.a,{size:"large"}),i.a.createElement("br",null),this.props.message)}}]),t}(i.a.Component)),z=(n(152),n(8));!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.RELOADING=3]="RELOADING",e[e.ERROR=4]="ERROR"}(C||(C={}));var U,_,G=function(){function e(t){Object(s.a)(this,e),this.db=void 0,this.onUpdate=void 0,this.onUpdate=t.onUpdate,this.db={data:t.initialData}}return Object(l.a)(e,[{key:"forceComponentUpdate",value:function(){this.onUpdate()}},{key:"set",value:function(e){this.db.data=e(this.db.data),this.forceComponentUpdate()}},{key:"get",value:function(){return this.db.data}}]),e}();!function(e){e[e.NCBI=0]="NCBI",e[e.GTDB=1]="GTDB"}(U||(U={})),function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(_||(_={}));var M=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getLineage",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_lineage",[{id:t}]);case 2:return n=e.sent,a=Object(y.a)(n,1),r=a[0],e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r,i,o,c,s;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonID,a=t.offset,r=t.limit,i=t.searchTerm,e.next=3,this.callFunc("get_children",[{id:n,offset:a,limit:r,search_text:i}]);case 3:return o=e.sent,c=Object(y.a)(o,1),s=c[0],e.abrupt("return",s);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_taxon",[{id:t}]);case 2:return n=e.sent,a=Object(y.a)(n,1),r=a[0],e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAssociatedWorkspaceObjects",value:function(){var e=Object(E.a)(O.a.mark(function e(t,n,a){var r,i,o;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.callFunc("get_associated_ws_objects",[{taxon_id:t,limit:a,offset:n}]);case 2:return r=e.sent,i=Object(y.a)(r,1),o=i[0],e.abrupt("return",o);case 6:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()}]),t}(m.DynamicServiceClient);M.module="taxonomy_re_api";var B=function(){function e(t){var n=t.token,a=t.url;Object(s.a)(this,e),this.taxonomyClient=void 0,this.taxonomyClient=new M({token:n,url:a})}return Object(l.a)(e,[{key:"getLineage",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.taxonomyClient.getLineage(t);case 2:return n=e.sent,a=n.results.map(function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{type:U.NCBI,id:e._id,name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map(function(e){return{name:e.name,category:e.category}}),isBiological:t}}),e.abrupt("return",a);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getChildren",value:function(){var e=Object(E.a)(O.a.mark(function e(t,n){var a,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.taxonomyClient.getChildren({taxonID:t,offset:n.offset,limit:n.limit,searchTerm:n.searchTerm});case 2:return a=e.sent,r=a.results.map(function(e){var t;return t="root"!==e.scientific_name&&"cellular organisms"!==e.scientific_name,{type:U.NCBI,id:e._id,name:e.scientific_name,rank:e.rank,ncbiID:e.NCBI_taxon_id,geneticCode:parseInt(e.gencode),aliases:e.aliases.map(function(e){return{name:e.name,category:e.category}}),isBiological:t}}),e.abrupt("return",[r,a.total_count]);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getTaxon",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r,i;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.taxonomyClient.getTaxon(t);case 2:if((n=e.sent).count){e.next=5;break}throw new Error("Taxon not found");case 5:return a=n.results[0],r="root"!==a.scientific_name&&"cellular organisms"!==a.scientific_name,i={type:U.NCBI,id:a._id,name:a.scientific_name,rank:a.rank,ncbiID:a.NCBI_taxon_id,geneticCode:parseInt(a.gencode),aliases:a.aliases.map(function(e){return{name:e.name,category:e.category}}),isBiological:r},e.abrupt("return",i);case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getLinkedObjects",value:function(){var e=Object(E.a)(O.a.mark(function e(t,n){var a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.taxonomyClient.getAssociatedWorkspaceObjects(t,n.offset,n.limit);case 2:return a=e.sent,console.log("LINKED DATA",a,n),e.abrupt("return",[{linkedAt:0,objectID:0,workspaceID:0,version:0}]);case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var V=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getTargetTaxon",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set(function(e){return F({},e,{status:C.LOADING})}),n=new B({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getTaxon(t);case 5:a=e.sent,this.set(function(e){return F({},e,{status:C.LOADED,targetTaxon:a,selectedTaxon:a})}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set(function(t){return{status:C.ERROR,message:e.t0.message}});case 13:case"end":return e.stop()}},e,this,[[0,9]])}));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedTaxon",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new B({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=4,n.getTaxon(t);case 4:a=e.sent,this.set(function(e){return F({},e,{selectedTaxon:a})}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set(function(t){return{status:C.ERROR,message:e.t0.message}});case 12:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(G),Y=(n(742),n(86)),H=(n(744),n(57)),X=(n(745),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"Row"},i.a.createElement("div",{className:"Col-auto"},i.a.createElement("img",{src:"images/ncbi-logo.jpg",style:{height:"64px"},alt:"NCBI Logo"})),i.a.createElement("div",{className:"Col"},i.a.createElement("div",{className:"InfoTable"},i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Source"),i.a.createElement("div",{className:"InfoTable-dataCol"},i.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/guide/taxonomy/",target:"_blank"},"NCBI"))),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Version"),i.a.createElement("div",{className:"InfoTable-dataCol"},"SOME VERSION")))))}}]),t}(i.a.Component)),q=(n(746),n(341),n(42)),K=(n(748),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"clickTaxon",value:function(){this.props.selectTaxonID(this.props.taxon.id)}},{key:"clickNavigateToTaxon",value:function(){var e=this.props.taxon.id.replace("/",":"),t="review/".concat(e);window.parent?window.parent.location.hash=t:window.location.hash=t}},{key:"render",value:function(){var e=this.props.taxon,t=["TaxonItem"];this.props.isActive&&t.push("TaxonItem-active");var n=i.a.createElement("div",null,i.a.createElement("div",{style:{borderBottom:"1px solid silver"}},e.name),i.a.createElement("div",null,e.rank));return i.a.createElement(q.a,{title:n,placement:"right"},i.a.createElement("div",{className:t.join(" "),key:this.props.taxon.id,onClick:this.clickTaxon.bind(this),onDoubleClick:this.clickNavigateToTaxon.bind(this)},this.props.taxon.name))}}]),t}(i.a.Component));function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Q=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchChildren",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r,i,o,c,s,l,u,p,d;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonID,a=t.page,r=t.pageSize,i=t.searchTerm,e.prev=1,this.set(function(e){return e.status===C.LOADED?$({},e,{status:C.RELOADING}):$({},e,{status:C.LOADING})}),o=new B({token:this.token,url:this.serviceWizardURL}),c=(a-1)*r,s=r,e.next=8,o.getChildren(n,{offset:c,limit:s,searchTerm:i});case 8:l=e.sent,u=Object(y.a)(l,2),p=u[0],d=u[1],this.set(function(e){return $({},e,{status:C.LOADED,taxa:p,total:d,page:a,pageSize:r})}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set(function(t){return{status:C.ERROR,message:e.t0.message}});case 19:case"end":return e.stop()}},e,this,[[1,15]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(G),Z=(n(343),n(72)),ee=(n(752),n(83)),te=(n(245),n(78)),ne=(n(755),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"selectTaxon",value:function(e){this.props.selectTaxonID(e)}},{key:"navigateToTaxon",value:function(e){this.props.navigateToTaxonID(e)}},{key:"renderItemsPlain",value:function(){var e=this;return this.props.taxa.map(function(t){var n=e.props.selectedTaxonID===t.id;return i.a.createElement(K,{taxon:t,isActive:n,selectTaxonID:e.selectTaxon.bind(e),key:t.id,navigateToTaxonID:e.navigateToTaxon.bind(e)})})}},{key:"renderNoItems",value:function(){return i.a.createElement(te.a,{description:"No Children",image:te.a.PRESENTED_IMAGE_SIMPLE})}},{key:"render",value:function(){return 0===this.props.taxa.length?this.renderNoItems():this.renderItemsPlain()}}]),t}(i.a.Component)),ae=(n(756),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).searchTerm=void 0,n.page=void 0,n.pageSize=void 0,n.searchTerm="",n.page=1,n.pageSize=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchChildren(this.props.taxonID,1,10,"")}},{key:"renderTaxaNone",value:function(){return i.a.createElement("div",null,"None")}},{key:"renderTaxaLoading",value:function(){return i.a.createElement(z.a,{type:"loading"})}},{key:"renderTitleLoaded",value:function(e){if(0===e.total)return i.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"No Children");var t=Intl.NumberFormat("en-US",{useGrouping:!0}).format(e.total),n=(e.page-1)*e.pageSize+1,a=n+e.taxa.length-1;return i.a.createElement("div",{className:"Col-auto TaxonChildren-box-title"},"Children (",n,"-",a," of ",t,")")}},{key:"renderTitleReLoading",value:function(e){return i.a.createElement(A.a,{size:"small"},this.renderTitleLoaded(e))}},{key:"renderTitle",value:function(){var e=this.props.db;switch(e.status){case C.NONE:case C.LOADING:return i.a.createElement("div",null,"Loading...");case C.ERROR:return i.a.createElement("div",null,"ERROR: ",e.message);case C.LOADED:return this.renderTitleLoaded(e);case C.RELOADING:return this.renderTitleReLoading(e)}}},{key:"doSearch",value:function(e){this.searchTerm=e,this.props.fetchChildren(this.props.taxonID,1,this.pageSize||10,e)}},{key:"renderSearch",value:function(){var e=this.props.db.status!==C.LOADED||this.props.db.total<=this.props.db.pageSize&&!this.searchTerm;return i.a.createElement("div",{style:{marginBottom:"4px"}},i.a.createElement(ee.a.Search,{placeholder:"Search Children",onSearch:this.doSearch.bind(this),disabled:e}))}},{key:"renderTaxaLoaded",value:function(e){return i.a.createElement(i.a.Fragment,null,i.a.createElement(ne,{taxa:e.taxa,selectedTaxonID:this.props.selectedTaxonID,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID,totalItems:e.total,maxItems:10}))}},{key:"renderTaxaReLoading",value:function(e){return i.a.createElement(A.a,{tip:"Loading"},this.renderTaxaLoaded(e))}},{key:"renderTaxaError",value:function(e){return i.a.createElement(R.a,{type:"error",message:e.message})}},{key:"renderTaxa",value:function(){switch(this.props.db.status){case C.NONE:return this.renderTaxaNone();case C.LOADING:return this.renderTaxaLoading();case C.LOADED:return this.renderTaxaLoaded(this.props.db);case C.RELOADING:return this.renderTaxaReLoading(this.props.db);case C.ERROR:return this.renderTaxaError(this.props.db)}}},{key:"changePage",value:function(e,t){this.page=e,this.pageSize=t||10,this.props.fetchChildren(this.props.taxonID,this.page,this.pageSize,this.searchTerm)}},{key:"renderPaginationNone",value:function(){return i.a.createElement(Z.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoading",value:function(){return i.a.createElement(Z.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationError",value:function(){return i.a.createElement(Z.a,{size:"small",showLessItems:!0,hideOnSinglePage:!1})}},{key:"renderPaginationLoaded",value:function(e){return i.a.createElement(Z.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,onChange:this.changePage.bind(this)})}},{key:"renderPaginationReLoading",value:function(e){return i.a.createElement(Z.a,{size:"small",defaultPageSize:e.pageSize,showLessItems:!0,current:e.page,hideOnSinglePage:!1,total:e.total,disabled:!0})}},{key:"renderPagination",value:function(){var e=this.props.db;switch(e.status){case C.NONE:return this.renderPaginationNone();case C.LOADING:return this.renderPaginationLoading();case C.ERROR:return this.renderPaginationError();case C.LOADED:return this.renderPaginationLoaded(e);case C.RELOADING:return this.renderPaginationReLoading(e)}}},{key:"renderChildren",value:function(){return i.a.createElement("div",null,this.renderTitle(),this.renderSearch(),this.renderPagination(),this.renderTaxa())}},{key:"render",value:function(){return this.renderChildren()}}]),t}(i.a.Component)),re=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).db=void 0,n.db=new Q({onUpdate:function(){n.forceUpdate()},initialData:{status:C.NONE},token:e.token,config:e.config}),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchChildren",value:function(e,t,n,a){return this.db.fetchChildren({taxonID:e,page:t,pageSize:n,searchTerm:a})}},{key:"render",value:function(){return i.a.createElement(ae,{db:this.db.get(),taxonID:this.props.taxonID,selectedTaxonID:this.props.selectedTaxonID,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID,fetchChildren:this.fetchChildren.bind(this)})}}]),t}(i.a.Component);var ie=Object(h.connect)(function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}},function(){return{}})(re);function oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?oe(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):oe(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var se=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).props=void 0,n.props=e,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"getLineage",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.set(function(e){return ce({},e,{status:C.LOADING})}),n=new B({token:this.props.token,url:this.props.config.services.ServiceWizard.url}),e.next=5,n.getLineage(t);case 5:a=e.sent,this.set(function(e){return ce({},e,{status:C.LOADED,lineage:a})}),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("ERROR",e.t0),this.set(function(t){return{status:C.ERROR,message:e.t0.message}});case 13:case"end":return e.stop()}},e,this,[[0,9]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(G),le=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(ne,{taxa:this.props.lineage,selectedTaxonID:this.props.selectedTaxonID,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID,totalItems:this.props.lineage.length,maxItems:10})}}]),t}(i.a.Component),ue=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).db=void 0,n.db=new se({onUpdate:function(){n.forceUpdate()},initialData:{status:C.NONE},token:e.token,config:e.config}),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderLoading",value:function(){return i.a.createElement(z.a,{type:"loading"})}},{key:"renderError",value:function(e){return i.a.createElement(R.a,{type:"error",message:e.message})}},{key:"renderLoaded",value:function(e){return i.a.createElement(le,{lineage:e.lineage,selectedTaxonID:this.props.selectedTaxonID,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case C.NONE:return this.db.getLineage(this.props.taxonID),this.renderLoading();case C.LOADING:return this.renderLoading();case C.ERROR:return this.renderError(e);case C.LOADED:return this.renderLoaded(e)}}}]),t}(i.a.Component);var pe=Object(h.connect)(function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}},function(){return{}})(ue),de=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"onClick",value:function(e){this.props.selectTaxonID(e)}},{key:"menuSelected",value:function(e){this.props.selectTaxonID(e.key)}},{key:"clickTaxon",value:function(e){this.props.selectTaxonID(e.id)}},{key:"renderLineage",value:function(){return i.a.createElement(pe,{taxonID:this.props.targetTaxon.id,selectedTaxonID:this.props.selectedTaxon.id,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID})}},{key:"renderChildrenCount",value:function(e){return 0===e?i.a.createElement("div",{className:""},"No children"):1===e?i.a.createElement("div",null,"One child"):i.a.createElement("div",null,Intl.NumberFormat("en-US",{useGrouping:!0}).format(e)," ","children")}},{key:"renderChildren",value:function(){var e;return e=this.props.selectedTaxon?this.props.selectedTaxon.id:null,i.a.createElement(ie,{taxonID:this.props.targetTaxon.id,selectedTaxonID:e,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID})}},{key:"renderTargetTaxon",value:function(){var e=this.props.selectedTaxon&&this.props.selectedTaxon.id===this.props.targetTaxon.id||!1;return i.a.createElement(K,{taxon:this.props.targetTaxon,isActive:e,selectTaxonID:this.props.selectTaxonID,navigateToTaxonID:this.props.navigateToTaxonID})}},{key:"render",value:function(){return i.a.createElement("div",{className:"Col scrollable"},i.a.createElement("div",{className:"Col-auto Lineage-box"},i.a.createElement("div",{className:"Lineage-box-title"},"Lineage"),this.renderLineage()),i.a.createElement("div",{className:"Col-auto Lineage-box Lineage-target-taxon"},this.renderTargetTaxon()),i.a.createElement("div",{className:"Col-auto scrollable Lineage-box"},this.renderChildren()))}}]),t}(i.a.Component),he=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e={};return"species"===this.props.taxon.rank&&(e={fontStyle:"italic"}),i.a.createElement("div",{className:"InfoTable"},i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Name"),i.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),i.a.createElement("div",{className:"InfoTable-row"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"5em"}},"Rank"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)))}}]),t}(i.a.Component),fe=(n(757),n(87)),me=(n(766),n(137));var ge=function(e){if(!(e instanceof Array))throw new Error("Invalid genetic codes file!");return e.map(function(e){var t=Object(y.a)(e,2),n=t[0],a=t[1];if("number"!==typeof n)throw new Error("Invalid genetic code id in file");if("string"!==typeof a)throw new Error("Invalid genetic code label in file");return[n,a]})}(n(369)).reduce(function(e,t){var n=Object(y.a)(t,2),a=n[0],r=n[1];return e.set(a,r),e},new Map),ve=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderAliases",value:function(){var e=function(e,t){var n=e.replace(/^["']/,""),a=t.replace(/^["']/,"");return n.localeCompare(a)};return i.a.createElement(me.a,{dataSource:this.props.taxon.aliases,className:"KBaseAntdOverride-remove-table-border",size:"small",pagination:!1,scroll:{y:"25em"},rowKey:"name",bordered:!1},i.a.createElement(me.a.Column,{title:"Name",dataIndex:"name",key:"name",defaultSortOrder:"ascend",sorter:function(t,n){return e(t.name,n.name)}}),i.a.createElement(me.a.Column,{title:"Category",dataIndex:"category",key:"category",width:"20em",sorter:function(t,n){return e(t.category,n.category)}}))}},{key:"renderTaxonDetail",value:function(){var e={};return"species"===this.props.taxon.rank&&(e.fontStyle="italic"),i.a.createElement("div",{className:"InfoTable"},i.a.createElement("div",{className:"InfoTable-row",key:"name"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Name"),i.a.createElement("div",{className:"InfoTable-dataCol",style:e},this.props.taxon.name)),i.a.createElement("div",{className:"InfoTable-row",key:"rank"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Rank"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.rank)),i.a.createElement("div",{className:"InfoTable-row",key:"ncbiid"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"NCBI ID"),i.a.createElement("div",{className:"InfoTable-dataCol"},i.a.createElement("a",{href:"https://www.ncbi.nlm.nih.gov/Taxonomy/Browser/wwwtax.cgi?mode=info&id=".concat(this.props.taxon.ncbiID),target:"_blank",rel:"noopener noreferrer"},this.props.taxon.ncbiID))),i.a.createElement("div",{className:"InfoTable-row",key:"genetic-code"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Genetic Code"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.props.taxon.geneticCode," -"," ",ge.get(this.props.taxon.geneticCode)||"Unknown")),i.a.createElement("div",{className:"InfoTable-row",key:"aliases"},i.a.createElement("div",{className:"InfoTable-labelCol",style:{width:"8em"}},"Aliases"),i.a.createElement("div",{className:"InfoTable-dataCol"},this.renderAliases())))}},{key:"render",value:function(){return i.a.createElement("div",null,this.renderTaxonDetail())}}]),t}(i.a.Component),be=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){switch(this.props.taxon.type){case U.NCBI:return i.a.createElement(ve,{taxon:this.props.taxon});default:return i.a.createElement(R.a,{type:"error",message:"This taxon type is not suppported"})}}}]),t}(i.a.Component),Oe=n(372);function ye(e,t,n){if("string"===typeof t)t=t.split(".");else if(!(t instanceof Array))throw new TypeError("Invalid type for key: "+typeof t);for(var a=e,r=0;r<t.length;r+=1){if(void 0===a||"object"!==typeof a||null===a)return n;a=a[t[r]]}return void 0===a?n:a}var Ee,xe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).name="NotFound",n}return Object(d.a)(t,e),t}(Object(Oe.a)(Error)),ke="https://en.wikipedia.org/w/api.php",Te=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,[{key:"scrubTerm",value:function(e){var t=e.split(""),n=/[\w \s]/;return t.filter(function(e){return!!n.exec(e)}).join("")}},{key:"findTerm",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("Empty term passed");case 2:return n=this.scrubTerm(t),e.abrupt("return",this.getWikipediaInfo(n).then(function(e){var t=e.imageUrl,n=e.pageUrl,a=e.introText,r=e.title,i=e.pageId,o=e.matchingTerms,c=e.exactMatch;return{imageUrl:t,pageUrl:n,introText:a.replace(/====/g,"####").replace(/===/g,"###").replace(/==/g,"##").replace(/\n/g,"  \n"),title:r,pageId:i,matchingTerms:o,exactMatch:c}}));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getWikipediaInfo",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n=this;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getPage(t).then(function(e){var t=e.wikiResponse,a=e.matchingTerms,r=e.exactMatch;return Promise.all([n.getImage({size:500,pageId:t.parse.pageid}),n.getPageInfo({pageId:t.parse.pageid})]).then(function(e){var n=Object(y.a)(e,2),i=n[0],o=n[1];return{imageUrl:i,pageUrl:o.url,introText:o.introText,title:t.parse.title,pageId:t.parse.pageid,matchingTerms:a,exactMatch:r}})}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.split(/\s+/),a=!0,e.abrupt("return",new Promise(function(e,r){!function n(i){0===i.length&&r(new xe('No Wikipedia page found matching "'+t+'"'));var o=new URL(ke),c=o.searchParams;c.set("action","parse"),c.set("format","json"),c.set("prop","text|headhtml"),c.set("section","0"),c.set("redirects",""),c.set("page",i.join(" "));c.set("origin","*"),fetch(o.toString(),{method:"GET",headers:{accept:"application/json"}}).then(function(t){switch(t.status){case 200:try{return t.json().then(function(t){if(t.error){if("missingtitle"===t.error.code)return i.pop(),a=!1,n(i),null;console.error("wikipedia api error",t),r(new Error("Wikipedia api error: "+t.error.code))}else e({wikiResponse:t,matchingTerms:i,exactMatch:a})})}catch(c){r(new Error("Error parsing wikipedia response: "+c.message))}break;default:var o="Unexpected response from wikipedia api: "+t.status;console.error(o,t),r(new Error(o))}}).catch(function(e){r(e)})}(n)}));case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getPageInfo",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageId,a=new URL(ke),(r=a.searchParams).set("action","query"),r.set("pageids",n),r.set("prop","info|extracts"),r.set("explaintext","true"),r.set("inprop","url"),r.set("origin","*"),r.set("format","json"),e.abrupt("return",fetch(a.toString(),{method:"GET"}).then(function(e){switch(e.status){case 200:try{return e.json().then(function(e){return{url:ye(e,["query","pages",String(n),"fullurl"],null),introText:ye(e,["query","pages",String(n),"extract"],null)}})}catch(a){throw console.error("error getting page info",a.message),a}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},{key:"getImage",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r,i,o;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.size,a=t.pageId,r=new URL(ke),(i=r.searchParams).set("action","query"),i.set("format","json"),i.set("prop","pageimages"),i.set("pithumbsize",String(n)),i.set("pageids",String(a)),i.set("origin","*"),o={accept:"application/json"},e.abrupt("return",fetch(r.toString(),{method:"GET",headers:o}).then(function(e){switch(e.status){case 200:try{return e.json().then(function(e){return ye(e,["query","pages",String(a),"thumbnail","source"],null)})}catch(n){throw new Error("Error parsing wikipedia response: "+n.message)}default:var t="Unexpected response from wikipedia api: "+e.status;throw console.error(t,e),new Error(t)}}).catch(function(e){var t="Error getting image from wikipedia: "+e.message;throw console.error(t,e),new Error("Error getting image from wikipedia: "+e.message)}));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()}]),e}(),je=n(370),we=n.n(je);n(763);!function(e){e[e.NONE=0]="NONE",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(Ee||(Ee={}));var Ie=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).wikipediaClient=void 0,n.canceled=void 0,n.wikipediaClient=new Te,n.canceled=!1,n.state={state:Ee.NONE},n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){this.canceled=!0}},{key:"renderArticle",value:function(e){var t=we()(e.introText);return i.a.createElement("div",{style:{overflow:"auto"},dangerouslySetInnerHTML:{__html:t}})}},{key:"renderImage",value:function(e){return e.imageUrl?i.a.createElement("div",null,i.a.createElement("img",{src:e.imageUrl,style:{width:"100%"},alt:"".concat(this.props.term)})):i.a.createElement("div",{className:"Wikipedia-empty-image"},i.a.createElement("div",{className:"-content"},"Image not found"))}},{key:"renderMatch",value:function(e){if(e.exactMatch){var t=i.a.createElement(i.a.Fragment,null,i.a.createElement(z.a,{type:"check",style:{color:"green"}}),' Exact match on "',e.matchingTerms.join(" "),'"');return i.a.createElement(R.a,{type:"success",message:t})}var n=i.a.createElement(i.a.Fragment,null,i.a.createElement(z.a,{type:"warning",style:{color:"orange"}}),' Inexact match on: "',e.matchingTerms.join(" "),'"');return i.a.createElement(R.a,{type:"warning",message:n})}},{key:"renderWikipediaLogoCredit",value:function(){return i.a.createElement("div",null,i.a.createElement("div",{style:{borderBottom:"1px solid gray"}},"Link to the original Wikipedia entry"),i.a.createElement("div",{style:{fontSize:"80%"}},i.a.createElement("p",{style:{textAlign:"center"}},"credit:",i.a.createElement("a",{href:"https://creativecommons.org/licenses/by-sa/3.0/",title:"Creative Commons Attribution-ShareAlike 3.0",target:"_blank",rel:"noopener noreferrer"},"CC BY-SA 3.0"),i.a.createElement("a",{href:"https://en.wikipedia.org/w/index.php?curid=33285413",target:"_blank",rel:"noopener noreferrer"},"Link"))))}},{key:"renderWikipediaInfo",value:function(e){return i.a.createElement("div",{className:"Row scrollable"},i.a.createElement("div",{className:"Col Col-grow-2 scrollable"},i.a.createElement("div",{style:{display:"flex",flexDirection:"row",marginBottom:"10px"}},i.a.createElement("div",{style:{flex:"1 1 0px"}},this.renderMatch(e)),i.a.createElement("div",{style:{flex:"0 0 auto",alignSelf:"center",marginLeft:"10px"}},i.a.createElement("div",{style:{height:"32px",textAlign:"center"}},i.a.createElement(q.a,{title:this.renderWikipediaLogoCredit()},i.a.createElement("a",{href:e.pageUrl,target:"_blank",rel:"noopener noreferrer"},i.a.createElement("img",{src:"images/wikipedia-logo.svg",style:{height:"100%"},alt:"Wikipedia Logo"})))),i.a.createElement("div",null))),i.a.createElement("div",{className:"scrollable",style:{flex:"2 1 0px",paddingRight:"4px",marginRight:"4px",overflowY:"auto"}},this.renderArticle(e))),i.a.createElement("div",{className:"Col Col-grow-1",style:{flex:"1 1 0px",marginLeft:"10px"}},this.renderImage(e)))}},{key:"updateInfo",value:function(){var e=this,t=new Te,n=this.props.term;this.setState({state:Ee.LOADING}),t.findTerm(n).then(function(t){e.canceled||e.setState({state:Ee.LOADED,wikipediaInfo:t})}).catch(function(t){if(!e.canceled)return e.setState({state:Ee.ERROR,error:t.message})})}},{key:"componentDidMount",value:function(){this.updateInfo()}},{key:"componentDidUpdate",value:function(e,t){e.term!==this.props.term&&this.updateInfo()}},{key:"renderNone",value:function(){return i.a.createElement("div",null)}},{key:"renderLoading",value:function(){return i.a.createElement(P,{message:"Searching Wikipedia..."})}},{key:"renderLoaded",value:function(e){return this.renderWikipediaInfo(e.wikipediaInfo)}},{key:"renderError",value:function(e){return i.a.createElement(R.a,{type:"error",message:e.error})}},{key:"render",value:function(){if(!this.canceled)switch(this.state.state){case Ee.NONE:return this.renderNone();case Ee.LOADING:return this.renderLoading();case Ee.LOADED:return this.renderLoaded(this.state);case Ee.ERROR:return this.renderError(this.state)}}}]),t}(i.a.Component),De=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderTaxonDescription",value:function(){return i.a.createElement(Ie,{term:this.props.taxon.name})}},{key:"notBiological",value:function(){switch(this.props.taxon.name){case"root":return i.a.createElement("div",null,i.a.createElement("p",null,"This taxon is the topmost node in the NCBI Taxonomy tree."));case"cellular organisms":return i.a.createElement("div",null,i.a.createElement("p",null,"This taxon represents all cellular organisms."));default:return i.a.createElement("div",null,i.a.createElement("p",null,"Unknown non-biological taxon."))}}},{key:"render",value:function(){return this.props.taxon.isBiological?i.a.createElement("div",{className:"Col scrollable"},this.renderTaxonDescription()):this.notBiological()}}]),t}(i.a.Component);function Ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ne(n,!0).forEach(function(t){Object(f.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ne(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Ce=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).token=void 0,n.serviceWizardURL=void 0,n.token=e.token,n.serviceWizardURL=e.config.services.ServiceWizard.url,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchLinkedObjects",value:function(){var e=Object(E.a)(O.a.mark(function e(t){var n,a,r,i,o,c,s;return O.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.taxonID,a=t.page,r=t.pageSize,e.prev=1,this.set(function(e){return Le({},e,{status:C.LOADING})}),i=new B({token:this.token,url:this.serviceWizardURL}),o=(a-1)*r,c=r,e.next=8,i.getLinkedObjects(n,{offset:o,limit:c});case 8:s=e.sent,this.set(function(e){return Le({},e,{status:C.LOADED,linkedObjects:s,page:a,pageSize:r})}),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),console.error("ERROR",e.t0),this.set(function(t){return{status:C.ERROR,message:e.t0.message}});case 16:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}()}]),t}(G),Re=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,"Coming soon...")}}]),t}(i.a.Component),Se=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).db=void 0,n.db=new Ce({onUpdate:function(){n.forceUpdate()},initialData:{status:C.NONE},token:e.token,config:e.config}),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"fetchLinkedData",value:function(e,t,n){return this.db.fetchLinkedObjects({taxonID:e,page:t,pageSize:n})}},{key:"renderNone",value:function(){return i.a.createElement(z.a,{type:"loading"})}},{key:"renderLoading",value:function(){return i.a.createElement(z.a,{type:"loading"})}},{key:"renderError",value:function(e){return i.a.createElement(R.a,{type:"error",message:e.message})}},{key:"renderLoaded",value:function(e){return i.a.createElement(Re,{linkedObjects:e.linkedObjects})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case C.NONE:return this.db.fetchLinkedObjects({taxonID:this.props.taxonID,page:1,pageSize:1e3}),this.renderNone();case C.LOADING:return this.renderLoading();case C.ERROR:return this.renderError(e);case C.LOADED:return this.renderLoaded(e)}}}]),t}(i.a.Component);var Ae=Object(h.connect)(function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}},function(){return{}})(Se),Pe=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return i.a.createElement(fe.a,{defaultActiveKey:"detail",animated:!1,className:"FullHeight-tabs"},i.a.createElement(fe.a.TabPane,{tab:"Detail",key:"detail",forceRender:!1},i.a.createElement(be,{taxon:this.props.taxon})),i.a.createElement(fe.a.TabPane,{tab:"Description",key:"description",forceRender:!1},i.a.createElement(De,{taxon:this.props.taxon})),i.a.createElement(fe.a.TabPane,{tab:"Linked Data",key:"linkedData",forceRender:!1},i.a.createElement(Ae,{taxonID:this.props.taxon.id})))}}]),t}(i.a.Component),ze=(n(764),function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderTaxonInfo",value:function(){return this.props.selectedTaxon?i.a.createElement(Pe,{taxon:this.props.selectedTaxon}):i.a.createElement("div",null,"No taxon selected")}},{key:"componentDidMount",value:function(){this.props.setTitle('Taxonomy Landing Page for "'+this.props.targetTaxon.name+'"')}},{key:"render",value:function(){return i.a.createElement("div",{className:"Col scrollable Taxonomy"},i.a.createElement("div",{className:"Col-auto Taxonomy-summary-section"},i.a.createElement(Y.a,null,i.a.createElement(H.a,{span:12},i.a.createElement(he,{taxon:this.props.targetTaxon})),i.a.createElement(H.a,{span:12},i.a.createElement(X,null)))),i.a.createElement("div",{className:"Row scrollable"},i.a.createElement("div",{className:"Col scrollable",style:{flex:"0 0 20em"}},i.a.createElement(de,{selectedTaxon:this.props.selectedTaxon,selectTaxonID:this.props.selectTaxonID,targetTaxon:this.props.targetTaxon,navigateToTaxonID:this.props.navigateToTaxonID})),i.a.createElement("div",{className:"Col scrollable",style:{marginLeft:"10px"}},this.renderTaxonInfo())))}}]),t}(i.a.Component)),Ue=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).db=void 0,n.db=new V({onUpdate:function(){n.forceUpdate()},initialData:{status:C.NONE},token:e.token,config:e.config}),n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"selectTaxon",value:function(e){return this.db.getSelectedTaxon(e)}},{key:"navigateToTaxon",value:function(e){return this.props.navigate(e)}},{key:"renderLoading",value:function(){return i.a.createElement(z.a,{type:"loading"})}},{key:"renderError",value:function(e){return i.a.createElement(R.a,{type:"error",message:e.message})}},{key:"renderLoaded",value:function(e){return i.a.createElement(ze,{targetTaxon:e.targetTaxon,selectedTaxon:e.selectedTaxon,selectTaxonID:this.selectTaxon.bind(this),navigateToTaxonID:this.navigateToTaxon.bind(this),setTitle:this.props.setTitle})}},{key:"render",value:function(){var e=this.db.get();switch(e.status){case C.NONE:return this.db.getTargetTaxon(this.props.taxonID),this.renderLoading();case C.LOADING:return this.renderLoading();case C.ERROR:return this.renderError(e);case C.LOADED:return this.props.taxonID!==e.targetTaxon.id?(this.db.getTargetTaxon(this.props.taxonID),this.renderLoaded(e)):this.renderLoaded(e)}}}]),t}(i.a.Component);var _e=Object(h.connect)(function(e,t){var n=e.auth.userAuthorization,a=e.app.config;if(!n)throw new Error("Invalid state - no user authorization");return{token:n.token,config:a}},function(e,t){return{navigate:function(t){e(x(t))},setTitle:function(t){e(Object(m.sendTitle)(t))}}})(Ue);var Ge=Object(h.connect)(function(e,t){return{}},function(e,t){return{navigate:function(t){e(x(t))},setTitle:function(t){e(Object(m.sendTitle)(t))}}})(_e),Me=function(e){function t(){return Object(s.a)(this,t),Object(u.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"renderUnauthorized",value:function(){return i.a.createElement("div",null,"Sorry, not authorized. Please log in first.")}},{key:"renderRootState",value:function(){switch(this.props.rootState){case S.RootState.NONE:case S.RootState.HOSTED:return"";case S.RootState.DEVELOP:return"develop";case S.RootState.ERROR:return"error"}}},{key:"renderNavigationNone",value:function(){return i.a.createElement("div",null,"none")}},{key:"renderNavigationLoading",value:function(e){return i.a.createElement(P,{message:"Loading view..."})}},{key:"renderNavigationLoaded",value:function(e){switch(e.relationEngineNodeType){case w.TAXON:return i.a.createElement(Ge,{taxonID:e.relationEngineID})}}},{key:"renderNavigationError",value:function(e){return i.a.createElement(R.a,{type:"error",message:"View Error: ".concat(e.message)})}},{key:"renderNavigationSome",value:function(e){switch(e.type){case j.TAXONOMY:return i.a.createElement(Ge,{taxonID:e.relationEngineID})}}},{key:"renderNavigation",value:function(){switch(this.props.navigation.type){case j.NONE:return this.renderNavigationNone();default:return this.renderNavigationSome(this.props.navigation)}}},{key:"parseHash",value:function(e){var t=/^#(.*?)\/(.*)$/.exec(e);if(!t)throw new Error("Invalid path");var n=Object(y.a)(t,3);return{path:[n[1]],params:{relationEngineID:n[2]}}}},{key:"componentDidMount",value:function(){var e=this;if(this.props.rootState===S.RootState.DEVELOP){window.addEventListener("hashchange",function(t){var n=new URL(t.newURL).hash;if(!n)throw new Error("no hash!");var a=e.parseHash(n).params.relationEngineID;e.props.navigate(a)});var t=window.location.hash;if(t){var n=this.parseHash(t).params.relationEngineID;this.props.navigate(n)}else this.props.navigate("ncbi_taxon:562")}}},{key:"render",value:function(){return this.props.token?i.a.createElement("div",{className:"Col scrollable"},i.a.createElement("div",{className:"Row-auto"},this.renderRootState()),i.a.createElement("div",{className:"Row  scrollable"},this.renderNavigation())):this.renderUnauthorized()}}]),t}(i.a.Component);var Be=Object(h.connect)(function(e,t){var n=e.auth.userAuthorization,a=e.root.state,r=e.navigation,i=e.trigger;return{token:n?n.token:null,rootState:a,navigation:r,trigger:i}},function(e,t){return{navigate:function(t){e(x(t))}}})(Me),We=Object(g.d)(D,L(),Object(g.c)(Object(g.a)(v.a))),Fe=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).storeSubscription=void 0,n.storeSubscription=null,n}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e={view:null,params:{}};this.storeSubscription=We.subscribe(function(){var t=We.getState();if(t){var n=t.app.runtime.navigation,a=n.view,r=n.params;(a!==e.view||null===e.params||Object.keys(r).some(function(t){return r[t]!==e.params[t]}))&&(e.params=r,e.view=a,r.relationEngineID&&We.dispatch(x(r.relationEngineID)))}})}},{key:"render",value:function(){return i.a.createElement(h.Provider,{store:We},i.a.createElement(m.AppBase,null,i.a.createElement("div",{className:"App Col scrollable"},i.a.createElement(Be,null))))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(Fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[375,1,2]]]);
//# sourceMappingURL=main.e405ff5b.chunk.js.map